<!DOCTYPE html><html lang="[&quot;en&quot;,&quot;zh-CN&quot;,&quot;default&quot;]"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="Npc"><meta name="copyright" content="Npc"><meta name="generator" content="Hexo 7.1.1"><meta name="theme" content="hexo-theme-yun"><title>re4bÈòÖËØªÁ¨îËÆ∞ | Npc | Blog</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/star-markdown-css@0.4.1/dist/yun/yun-markdown.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@latest/themes/prism-coy.css"><script src="https://fastly.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".markdown-body img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link rel="icon" type="image/svg+xml" href="/yun.svg"><link rel="mask-icon" href="/yun.svg" color="#0078E7"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="preconnect" href="https://fastly.jsdelivr.net/npm/" crossorigin><script id="yun-config">
    window.Yun = {}
    window.CONFIG = {"hostname":"npc0vo.github.io","root":"/","title":"NpcÂ∞èÁ´ô","version":"1.10.11","mode":"auto","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}.","hits":"${hits} results found","hits_time":"${hits} results found in ${time} ms"},"anonymous_image":"https://cdn.yunyoujun.cn/img/avatar/none.jpg","say":{"api":"https://el-bot-api.vercel.app/api/words/young"},"local_search":{"path":"/search.xml"},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"fireworks":{"colors":null},"waline":{"config":{"enable":true,"serverURL":"https://waline-onelastchicks-projects.vercel.app/","comment":false,"el":"#waline","lang":["en","zh-CN","default"]},"cdn":"https://fastly.jsdelivr.net/npm/@waline/client@v2/dist/waline.js","dark":"html.dark"},"vendors":{"host":"https://fastly.jsdelivr.net/npm/","darken":"https://fastly.jsdelivr.net/npm/darken@1.5.0"}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/hexo-theme-yun.js" type="module"></script><link rel="preconnect" href="https://www.google-analytics.com" crossorigin><script async src="https://www.googletagmanager.com/gtag/js?id=G-1LL0D86CY9"></script><script>if (CONFIG.hostname === location.hostname) {
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-1LL0D86CY9');
}</script><script data-ad-client="ca-pub-2245427233262012" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(function(){
  var bp = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  if (curProtocol === 'https') {
    bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else {
    bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(bp, s);
})();</script><!-- Google Tag Manager --><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-M9KWR9L');</script><!-- End Google Tag Manager --><meta name="description" content="Part.1 ÂâçË®Ä ÈòÖËØªËøôÁßç‰π¶Á±çÔºåÂ¶ÇÊûúÊàë‰∏çÂÅöÁ¨îËÆ∞ÔºåÊàëÂèØËÉΩÂ∞±‰ºöËµ∞È©¨ËßÇËä±ÁöÑÁ≤óÁï•Áúã‰∏ÄÈÅçÔºåÁªìÊûú‰ªÄ‰πàÈÉΩÊ≤°Â≠¶‰ºöÔºåÁúºÁùõ‰ºö‰∫ÜÔºåËÑëÂ≠ê‰∏ç‰ºöÔºåÊâÄ‰ª•ÊàëÂáÜÂ§áËæπÂÅöÁ¨îËÆ∞ËæπÂ≠¶Ôºå‰∫âÂèñÊääÂü∫Á°ÄÊâìÊâéÂÆû ÂØπ‰∫éÈÄÜÂêëÂ∑•Á®ãÊùÉÂ®ÅÊåáÂçóÂÖ≥ÈîÆÈÉ®ÂàÜÁöÑÊëòÂΩï,Êï¥ÁêÜ‰ª•Âèä‰∏™‰∫∫ÁöÑÁêÜËß£ ÈÄÜÂêëÂ∑•Á®ãÊùÉÂ®ÅÊåáÂçóÊòØÂÖ•Èó®ÈÄÜÂêëÂøÖËØªÁöÑ‰∏ÄÊú¨‰π¶Á±ç Áî±‰∫éÊàëÊòØÂàùÂ≠¶ËÄÖÔºåÊâÄ‰ª•ÊàëÁõÆÂâçÂè™Â≠¶‰π†re4b x86Ê±áÁºñÈÉ®ÂàÜÔºà‰∏çËÉΩË¥™Â§öÔºâÔºåÂØπ‰∫éARM‰ª•ÂèäMIPSÊû∂ÊûÑÂæÖ‰ª•ÂêéËøõÈò∂ÂêéÂÜçËøõË°åÂ≠¶‰π†  Part.2 Êåá">
<meta property="og:type" content="article">
<meta property="og:title" content="re4bÈòÖËØªÁ¨îËÆ∞">
<meta property="og:url" content="http://npc0vo.github.io/2024/05/23/re4b%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/index.html">
<meta property="og:site_name" content="Npc | Blog">
<meta property="og:description" content="Part.1 ÂâçË®Ä ÈòÖËØªËøôÁßç‰π¶Á±çÔºåÂ¶ÇÊûúÊàë‰∏çÂÅöÁ¨îËÆ∞ÔºåÊàëÂèØËÉΩÂ∞±‰ºöËµ∞È©¨ËßÇËä±ÁöÑÁ≤óÁï•Áúã‰∏ÄÈÅçÔºåÁªìÊûú‰ªÄ‰πàÈÉΩÊ≤°Â≠¶‰ºöÔºåÁúºÁùõ‰ºö‰∫ÜÔºåËÑëÂ≠ê‰∏ç‰ºöÔºåÊâÄ‰ª•ÊàëÂáÜÂ§áËæπÂÅöÁ¨îËÆ∞ËæπÂ≠¶Ôºå‰∫âÂèñÊääÂü∫Á°ÄÊâìÊâéÂÆû ÂØπ‰∫éÈÄÜÂêëÂ∑•Á®ãÊùÉÂ®ÅÊåáÂçóÂÖ≥ÈîÆÈÉ®ÂàÜÁöÑÊëòÂΩï,Êï¥ÁêÜ‰ª•Âèä‰∏™‰∫∫ÁöÑÁêÜËß£ ÈÄÜÂêëÂ∑•Á®ãÊùÉÂ®ÅÊåáÂçóÊòØÂÖ•Èó®ÈÄÜÂêëÂøÖËØªÁöÑ‰∏ÄÊú¨‰π¶Á±ç Áî±‰∫éÊàëÊòØÂàùÂ≠¶ËÄÖÔºåÊâÄ‰ª•ÊàëÁõÆÂâçÂè™Â≠¶‰π†re4b x86Ê±áÁºñÈÉ®ÂàÜÔºà‰∏çËÉΩË¥™Â§öÔºâÔºåÂØπ‰∫éARM‰ª•ÂèäMIPSÊû∂ÊûÑÂæÖ‰ª•ÂêéËøõÈò∂ÂêéÂÜçËøõË°åÂ≠¶‰π†  Part.2 Êåá">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2024-05-23T08:25:47.000Z">
<meta property="article:modified_time" content="2024-06-06T05:34:42.166Z">
<meta property="article:author" content="Npc">
<meta property="article:tag" content="Â≠¶‰π†Á¨îËÆ∞">
<meta name="twitter:card" content="summary"><script>(function() {
  if (CONFIG.mode !== 'auto') return
  const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
  const setting = localStorage.getItem('darken-mode') || 'auto'
  if (setting === 'dark' || (prefersDark && setting !== 'light'))
    document.documentElement.classList.toggle('dark', true)
})()</script></head><body><script src="https://code.iconify.design/2/2.1.1/iconify.min.js"></script><script>// Define global variable
IconifyProviders = {
  // Empty prefix: overwrite default API provider configuration
  '': {
    // Use custom API first, use Iconify public API as backup
    resources: [
        'https://api.iconify.design',
    ],
    // Wait for 1 second before switching API hosts
    rotate: 1000,
  },
};</script><script defer src="https://fastly.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js" type="module"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js" type="module"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="Table of Contents"><span class="icon iconify" data-icon="ri:list-ordered"></span></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="Overview"><span class="icon iconify" data-icon="ri:passport-line"></span></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="Npc"><img width="96" loading="lazy" src="/images/avatar.jpg" alt="Npc"><span class="site-author-status">üò≠</span></a><div class="site-author-name"><a href="/about/">Npc</a></div><span class="site-name">Npc | Blog</span><sub class="site-subtitle">ÊÉ≥s</sub><div class="site-description"></div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="Home"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:home-4-line"></span></span></a><div class="site-state-item"><a href="/archives/" title="Archives"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:archive-line"></span></span><span class="site-state-item-count">24</span></a></div><div class="site-state-item"><a href="/categories/" title="Categories"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:folder-2-line"></span></span><span class="site-state-item-count">8</span></a></div><div class="site-state-item"><a href="/tags/" title="Tags"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="site-state-item-count">11</span></a></div><a class="site-state-item hty-icon-button" href="/about/#comment" title="ÁïôË®ÄÊùø"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:clipboard-line"></span></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/npc0vo" title="GitHub" target="_blank" style="color:#6e5494"><span class="icon iconify" data-icon="ri:github-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="mailto:me@1930278836@qq.com" title="E-Mail" target="_blank" style="color:#8E71C1"><span class="icon iconify" data-icon="ri:mail-line"></span></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="ÊàëÁöÑÂ∞è‰ºô‰º¥‰ª¨" style="color:dodgerblue"><span class="icon iconify" data-icon="ri:genderless-line"></span></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><span class="icon iconify" data-icon="ri:contrast-2-line"></span></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#part1-%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text"> Part.1 ÂâçË®Ä</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#part2-%E6%8C%87%E4%BB%A4%E8%AE%B2%E8%A7%A3"><span class="toc-number">2.</span> <span class="toc-text"> Part.2 Êåá‰ª§ËÆ≤Ëß£</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#chapter1-cpu"><span class="toc-number">2.1.</span> <span class="toc-text"> Chapter1 CPU</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#chap2-%E6%9C%80%E7%AE%80%E5%87%BD%E6%95%B0"><span class="toc-number">2.2.</span> <span class="toc-text"> Chap2 ÊúÄÁÆÄÂáΩÊï∞</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#chap3-helloworld"><span class="toc-number">2.3.</span> <span class="toc-text"> Chap3 Hello,World!</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#msvs"><span class="toc-number">2.3.1.</span> <span class="toc-text"> msvs</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#gcc"><span class="toc-number">2.3.2.</span> <span class="toc-text"> gcc</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#msvs-x86-64"><span class="toc-number">2.3.3.</span> <span class="toc-text"> msvs x86-64</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#gcc-x86-64"><span class="toc-number">2.3.4.</span> <span class="toc-text"> gcc x86-64</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#problems"><span class="toc-number">2.3.5.</span> <span class="toc-text"> Problems</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#chap4-%E5%87%BD%E6%95%B0%E5%BA%8F%E8%A8%80%E5%92%8C%E5%87%BD%E6%95%B0%E5%B0%BE%E5%A3%B0"><span class="toc-number">2.4.</span> <span class="toc-text"> Chap4 ÂáΩÊï∞Â∫èË®ÄÂíåÂáΩÊï∞Â∞æÂ£∞</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#chap5-%E6%A0%88"><span class="toc-number">2.5.</span> <span class="toc-text"> Chap5 Ê†à</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%88%E7%9A%84%E7%94%A8%E9%80%94"><span class="toc-number">2.5.1.</span> <span class="toc-text"> Ê†àÁöÑÁî®ÈÄî</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%88%E7%9A%84%E5%99%AA%E9%9F%B3"><span class="toc-number">2.5.2.</span> <span class="toc-text"> Ê†àÁöÑÂô™Èü≥</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#problems-2"><span class="toc-number">2.5.3.</span> <span class="toc-text"> Problems</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#51"><span class="toc-number">2.5.3.1.</span> <span class="toc-text"> 5.1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#52"><span class="toc-number">2.5.3.2.</span> <span class="toc-text"> 5.2</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#chap6-printf%E5%87%BD%E6%95%B0%E4%B8%8E%E5%8F%82%E6%95%B0%E4%BC%A0%E9%80%92"><span class="toc-number">2.6.</span> <span class="toc-text"> Chap6 printf()ÂáΩÊï∞‰∏éÂèÇÊï∞‰º†ÈÄí</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#x86"><span class="toc-number">2.6.1.</span> <span class="toc-text"> x86</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#chap7-scanf"><span class="toc-number">2.7.</span> <span class="toc-text"> Chap7 scanf()</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#x86-2"><span class="toc-number">2.7.1.</span> <span class="toc-text"> x86</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F"><span class="toc-number">2.7.2.</span> <span class="toc-text"> ÂÖ®Â±ÄÂèòÈáè</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#problem"><span class="toc-number">2.7.3.</span> <span class="toc-text"> Problem</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#chap8-%E5%8F%82%E6%95%B0%E8%8E%B7%E5%8F%96"><span class="toc-number">2.8.</span> <span class="toc-text"> Chap8 ÂèÇÊï∞Ëé∑Âèñ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#chap9-%E8%BF%94%E5%9B%9E%E5%80%BC"><span class="toc-number">2.9.</span> <span class="toc-text"> Chap9 ËøîÂõûÂÄº</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#void%E7%B1%BB%E5%9E%8B%E7%9A%84%E8%BF%94%E5%9B%9E%E5%80%BC"><span class="toc-number">2.9.1.</span> <span class="toc-text"> voidÁ±ªÂûãÁöÑËøîÂõûÂÄº</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%94%E5%9B%9E%E5%80%BC%E4%B8%BA%E7%BB%93%E6%9E%84%E4%BD%93%E5%9E%8B%E6%95%B0%E6%8D%AE"><span class="toc-number">2.9.1.1.</span> <span class="toc-text"> ËøîÂõûÂÄº‰∏∫ÁªìÊûÑ‰ΩìÂûãÊï∞ÊçÆ</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#chap10-%E6%8C%87%E9%92%88"><span class="toc-number">2.10.</span> <span class="toc-text"> Chap10 ÊåáÈíà</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#chap12-%E6%9D%A1%E4%BB%B6%E8%BD%AC%E7%A7%BB"><span class="toc-number">2.11.</span> <span class="toc-text"> Chap12 Êù°‰ª∂ËΩ¨Áßª</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E5%80%BC%E6%AF%94%E8%BE%83"><span class="toc-number">2.11.1.</span> <span class="toc-text"> Êï∞ÂÄºÊØîËæÉ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E7%BB%9D%E5%AF%B9%E5%80%BC"><span class="toc-number">2.11.2.</span> <span class="toc-text"> ËÆ°ÁÆóÁªùÂØπÂÄº</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">2.11.3.</span> <span class="toc-text"> Êù°‰ª∂ËøêÁÆóÁ¨¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AF%94%E8%BE%83%E5%A4%A7%E5%B0%8F"><span class="toc-number">2.11.4.</span> <span class="toc-text"> ÊØîËæÉÂ§ßÂ∞è</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#chap13-switch"><span class="toc-number">2.12.</span> <span class="toc-text"> Chap13 Switch</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#case%E8%BE%83%E5%B0%91%E7%9A%84%E6%83%85%E5%BD%A2"><span class="toc-number">2.12.1.</span> <span class="toc-text"> caseËæÉÂ∞ëÁöÑÊÉÖÂΩ¢</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#case%E8%BE%83%E5%A4%9A%E7%9A%84%E6%83%85%E5%BD%A2"><span class="toc-number">2.12.2.</span> <span class="toc-text"> caseËæÉÂ§öÁöÑÊÉÖÂΩ¢</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#case%E4%BB%8E%E5%8F%A5%E5%A4%9A%E5%AF%B9%E4%B8%80"><span class="toc-number">2.12.3.</span> <span class="toc-text"> case‰ªéÂè•Â§öÂØπ‰∏Ä</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#fall-through"><span class="toc-number">2.12.4.</span> <span class="toc-text"> fall-through</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#chap14-%E5%BE%AA%E7%8E%AF"><span class="toc-number">2.13.</span> <span class="toc-text"> Chap14 Âæ™ÁéØ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#for"><span class="toc-number">2.13.1.</span> <span class="toc-text"> for</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%85%E5%AD%98%E5%9D%97%E5%A4%8D%E5%88%B6"><span class="toc-number">2.13.2.</span> <span class="toc-text"> ÂÜÖÂ≠òÂùóÂ§çÂà∂</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">2.13.3.</span> <span class="toc-text"> ÊÄªÁªì</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#problem-2"><span class="toc-number">2.13.4.</span> <span class="toc-text"> Problem</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#chap15-c%E8%AF%AD%E8%A8%80%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E5%87%BD%E6%95%B0"><span class="toc-number">2.14.</span> <span class="toc-text"> Chap15 CËØ≠Ë®ÄÂ≠óÁ¨¶‰∏≤ÁöÑÂáΩÊï∞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#strlen"><span class="toc-number">2.14.1.</span> <span class="toc-text"> strlen()</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#chap16-%E6%95%B0%E5%AD%A6%E8%AE%A1%E7%AE%97%E6%8C%87%E4%BB%A4%E7%9A%84%E6%9B%BF%E6%8D%A2"><span class="toc-number">2.15.</span> <span class="toc-text"> Chap16 Êï∞Â≠¶ËÆ°ÁÆóÊåá‰ª§ÁöÑÊõøÊç¢</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B9%98%E6%B3%95"><span class="toc-number">2.15.1.</span> <span class="toc-text"> ‰πòÊ≥ï</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9B%BF%E6%8D%A2%E4%B8%BA%E5%8A%A0%E6%B3%95%E8%BF%90%E7%AE%97"><span class="toc-number">2.15.1.1.</span> <span class="toc-text"> ÊõøÊç¢‰∏∫Âä†Ê≥ïËøêÁÆó</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9B%BF%E6%8D%A2%E4%B8%BA%E7%A7%BB%E4%BD%8D%E8%BF%90%E7%AE%97"><span class="toc-number">2.15.1.2.</span> <span class="toc-text"> ÊõøÊç¢‰∏∫Áßª‰ΩçËøêÁÆó</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9B%BF%E6%8D%A2%E4%B8%BA%E7%A7%BB%E4%BD%8D%E5%8A%A0%E5%87%8F%E6%B3%95%E7%9A%84%E6%B7%B7%E5%90%88%E8%BF%90%E7%AE%97"><span class="toc-number">2.15.1.3.</span> <span class="toc-text"> ÊõøÊç¢‰∏∫Áßª‰Ωç,Âä†ÂáèÊ≥ïÁöÑÊ∑∑ÂêàËøêÁÆó</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%99%A4%E6%B3%95%E8%BF%90%E7%AE%97"><span class="toc-number">2.15.2.</span> <span class="toc-text"> Èô§Ê≥ïËøêÁÆó</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9B%BF%E6%8D%A2%E4%B8%BA%E4%BD%8D%E7%A7%BB%E8%BF%90%E7%AE%97"><span class="toc-number">2.15.2.1.</span> <span class="toc-text"> ÊõøÊç¢‰∏∫‰ΩçÁßªËøêÁÆó</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#problem-3"><span class="toc-number">2.15.3.</span> <span class="toc-text"> Problem</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#chap17-fpu"><span class="toc-number">2.16.</span> <span class="toc-text"> Chap17 FPU</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%A9%E7%94%A8%E5%8F%82%E6%95%B0%E4%BC%A0%E9%80%92%E6%B5%AE%E7%82%B9%E5%9E%8B"><span class="toc-number">2.16.0.1.</span> <span class="toc-text"> Âà©Áî®ÂèÇÊï∞‰º†ÈÄíÊµÆÁÇπÂûã</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%AF%94%E8%BE%83%E8%AF%B4%E6%98%8E"><span class="toc-number">2.16.0.2.</span> <span class="toc-text"> ÊØîËæÉËØ¥Êòé</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#chap18-%E6%95%B0%E7%BB%84"><span class="toc-number">2.17.</span> <span class="toc-text"> Chap18 Êï∞ÁªÑ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA"><span class="toc-number">2.17.1.</span> <span class="toc-text"> ÁºìÂÜ≤Âå∫Ê∫¢Âá∫</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B6%E4%BB%96"><span class="toc-number">2.17.2.</span> <span class="toc-text"> ÂÖ∂‰ªñ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%8C%87%E9%92%88"><span class="toc-number">2.17.3.</span> <span class="toc-text"> Â≠óÁ¨¶‰∏≤ÊåáÈíà</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A%E7%BB%B4%E6%95%B0%E7%BB%84"><span class="toc-number">2.17.4.</span> <span class="toc-text"> Â§öÁª¥Êï∞ÁªÑ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E7%BB%B4%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%95%B0%E7%BB%84%E7%9A%84%E5%B0%81%E8%A3%85%E6%A0%BC%E5%BC%8F"><span class="toc-number">2.17.5.</span> <span class="toc-text"> ‰∫åÁª¥Â≠óÁ¨¶‰∏≤Êï∞ÁªÑÁöÑÂ∞ÅË£ÖÊ†ºÂºè</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#problem-4"><span class="toc-number">2.17.6.</span> <span class="toc-text"> Problem</span></a></li></ol></li></ol></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article" style="--smc-primary:#0078E7;"><link itemprop="mainEntityOfPage" href="http://npc0vo.github.io/2024/05/23/re4b%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="Npc"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="Npc | Blog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">re4bÈòÖËØªÁ¨îËÆ∞</h1><div class="post-meta"><div class="post-time" style="display:block"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-line"></span></span> <time title="Created: 2024-05-23 16:25:47" itemprop="dateCreated datePublished" datetime="2024-05-23T16:25:47+08:00">2024-05-23</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-2-line"></span></span> <time title="Modified: 2024-06-06 13:34:42" itemprop="dateModified" datetime="2024-06-06T13:34:42+08:00">2024-06-06</time></div><span class="post-count"><span class="post-symbolcount"><span class="post-meta-item-icon" title="Word count in article"><span class="icon iconify" data-icon="ri:file-word-line"></span></span> <span title="Word count in article">25.9k</span><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="Reading time"><span class="icon iconify" data-icon="ri:timer-line"></span></span> <span title="Reading time">114m</span></span></span><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><span class="icon iconify" data-icon="ri:folder-line"></span></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/Reverse/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">Reverse</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag-item" href="/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">Â≠¶‰π†Á¨îËÆ∞</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body"><h1 id="part1-ÂâçË®Ä"><a class="markdownIt-Anchor" href="#part1-ÂâçË®Ä"></a> Part.1 ÂâçË®Ä</h1>
<p>ÈòÖËØªËøôÁßç‰π¶Á±çÔºåÂ¶ÇÊûúÊàë‰∏çÂÅöÁ¨îËÆ∞ÔºåÊàëÂèØËÉΩÂ∞±‰ºöËµ∞È©¨ËßÇËä±ÁöÑÁ≤óÁï•Áúã‰∏ÄÈÅçÔºåÁªìÊûú‰ªÄ‰πàÈÉΩÊ≤°Â≠¶‰ºöÔºåÁúºÁùõ‰ºö‰∫ÜÔºåËÑëÂ≠ê‰∏ç‰ºöÔºåÊâÄ‰ª•ÊàëÂáÜÂ§áËæπÂÅöÁ¨îËÆ∞ËæπÂ≠¶Ôºå‰∫âÂèñÊääÂü∫Á°ÄÊâìÊâéÂÆû</p>
<p>ÂØπ‰∫éÈÄÜÂêëÂ∑•Á®ãÊùÉÂ®ÅÊåáÂçóÂÖ≥ÈîÆÈÉ®ÂàÜÁöÑÊëòÂΩï,Êï¥ÁêÜ‰ª•Âèä‰∏™‰∫∫ÁöÑÁêÜËß£</p>
<p>ÈÄÜÂêëÂ∑•Á®ãÊùÉÂ®ÅÊåáÂçóÊòØÂÖ•Èó®ÈÄÜÂêëÂøÖËØªÁöÑ‰∏ÄÊú¨‰π¶Á±ç</p>
<p>Áî±‰∫éÊàëÊòØÂàùÂ≠¶ËÄÖÔºåÊâÄ‰ª•ÊàëÁõÆÂâçÂè™Â≠¶‰π†re4b x86Ê±áÁºñÈÉ®ÂàÜÔºà‰∏çËÉΩË¥™Â§öÔºâÔºåÂØπ‰∫éARM‰ª•ÂèäMIPSÊû∂ÊûÑÂæÖ‰ª•ÂêéËøõÈò∂ÂêéÂÜçËøõË°åÂ≠¶‰π†</p>
<h1 id="part2-Êåá‰ª§ËÆ≤Ëß£"><a class="markdownIt-Anchor" href="#part2-Êåá‰ª§ËÆ≤Ëß£"></a> Part.2 Êåá‰ª§ËÆ≤Ëß£</h1>
<h2 id="chapter1-cpu"><a class="markdownIt-Anchor" href="#chapter1-cpu"></a> Chapter1 CPU</h2>
<p>**Êåá‰ª§Á†ÅÔºö**CPUÂèóÁêÜÁöÑÂ∫ïÂ±ÇÂëΩ‰ª§„ÄÇÂÖ∏ÂûãÁöÑÂ∫ïÂ±ÇÂëΩ‰ª§ÊúâÔºöÂ∞ÜÊï∞ÊçÆÂú®ÂØÑÂ≠òÂô®Èó¥ËΩ¨Áßª„ÄÅÊìç‰ΩúÂÜÖÂ≠ò„ÄÅËÆ°ÁÆóËøêÁÆóÁ≠âÊåá‰ª§„ÄÇÊØèÁ±ªCPUÈÉΩÊúâËá™Â∑±ÁöÑÊåá‰ª§ÈõÜÊû∂ÊûÑÔºàInstruction Set ArchitectureÔºåISAÔºâ„ÄÇ</p>
<p>**Êú∫Âô®Á†ÅÔºö**ÂèëÈÄÅÁªôCPUÁöÑÁ®ãÂ∫è‰ª£Á†Å„ÄÇ‰∏ÄÊù°Êåá‰ª§ÈÄöÂ∏∏Ë¢´Â∞ÅË£Ö‰∏∫Ëã•Âπ≤Â≠óËäÇ„ÄÇ</p>
<p>**Ê±áÁºñËØ≠Ë®ÄÔºö**‰∏∫‰∫ÜËÆ©Á®ãÂ∫èÂëòÂ∞ëÈïøÁôΩÂ§¥ÂèëËÄåÂàõÈÄ†Âá∫Êù•ÁöÑ„ÄÅÊòìËØªÊòìËÆ∞ÁöÑ‰ª£Á†ÅÔºåÂÆÉÊúâÂæàÂ§öÁ±ª‰ººÂÆèÁöÑÊâ©Â±ïÂäüËÉΩ„ÄÇ</p>
<p>**CPUÂØÑÂ≠òÂô®Ôºö**ÊØèÁßçCPUÈÉΩÊúâÂÖ∂Âõ∫ÂÆöÁöÑÈÄöÁî®ÂØÑÂ≠òÂô®ÔºàGPRÔºâ„ÄÇx86 CPUÈáå‰∏ÄËà¨Êúâ8‰∏™GPRÔºåx64ÈáåÂæÄÂæÄÊúâ16‰∏™GPRÔºåËÄåARMÈáåÂàôÈÄöÂ∏∏Êúâ16‰∏™GPR„ÄÇÊÇ®ÂèØ‰ª•ËÆ§‰∏∫CPUÂØÑÂ≠òÂô®ÊòØ‰∏ÄÁßçÂ≠òÂÇ®ÂçïÂÖÉÔºåÂÆÉËÉΩÂ§üÊó†Â∑ÆÂà´Âú∞Â≠òÂÇ®ÊâÄÊúâÁ±ªÂûãÁöÑ‰∏¥Êó∂ÂèòÈáè„ÄÇÂÅáÂ¶ÇÊÇ®‰ΩøÁî®‰∏ÄÁßçÈ´òÁ∫ßÁöÑÁºñÁ®ãËØ≠Ë®ÄÔºå‰∏î‰ªÖ‰ºö‰ΩøÁî®Âà∞8‰∏™32‰ΩçÂèòÈáèÔºåÈÇ£‰πàÂÖâCPUËá™Â∏¶ÁöÑÂØÑÂ≠òÂô®Â∞±ËÉΩÂÆåÊàê‰∏çÂ∞ë‰ªªÂä°‰∫ÜÔºÅ</p>
<p><strong>Êåá‰ª§ÈõÜÊû∂ÊûÑ</strong></p>
<p>ÊúÄÂ∏∏ËßÅÁöÑ‰∏âÁßç</p>
<ul>
<li>
<p>ARMÊåá‰ª§ÈõÜÂàÜ‰∏∫3Á±ªÔºöARMÊ®°ÂºèÊåá‰ª§ÈõÜ„ÄÅThumbÊ®°ÂºèÊåá‰ª§ÈõÜÔºàÂåÖÊã¨Thumb-2ÔºâÂíåARM64ÁöÑÊåá‰ª§ÈõÜ„ÄÇÈúÄË¶ÅÂº∫Ë∞ÉÁöÑÊòØÔºö‰∏çÂêåÁöÑÊåá‰ª§ÈõÜÂàÜÂà´</p>
<p>Â±û‰∫é‰∏çÂêåÁöÑÊåá‰ª§ÈõÜÊû∂ÊûÑÔºõ‰∏Ä‰∏™Êåá‰ª§ÈõÜÁªùÈùûÂè¶‰∏Ä‰∏™Êåá‰ª§ÈõÜÁöÑÂèòÁßç„ÄÇ</p>
</li>
<li>
<p>x86Êåá‰ª§ÈõÜ ÂêÑopcodeÔºàÊ±áÁºñÊåá‰ª§ÂØπÂ∫îÁöÑÊú∫Âô®Á†ÅÔºâÁöÑÈïøÂ∫¶‰∏çÂ∞ΩÁõ∏Âêå</p>
</li>
<li>
<p>MIPSÊåá‰ª§ÈõÜ Â§öÊï∞ÈÉΩ‰ΩøÁî®‰∫ÜÂõ∫ÂÆöÈïøÂ∫¶ÁöÑ32‰Ωçopcode</p>
</li>
</ul>
<p><strong>Ê±áÁºñËØ≠Ë®Ä</strong>Â≠òÂú®‰∏§Áßç‰∏ªÊµÅËØ≠‰ΩìÔºåÂç≥<strong>IntelËØ≠‰Ωì</strong>Âíå<strong>AT&amp;TËØ≠‰Ωì</strong></p>
<h2 id="chap2-ÊúÄÁÆÄÂáΩÊï∞"><a class="markdownIt-Anchor" href="#chap2-ÊúÄÁÆÄÂáΩÊï∞"></a> Chap2 ÊúÄÁÆÄÂáΩÊï∞</h2>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token number">123</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">f:
	mov eax,123
	ret<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>Ëøô‰∏™ÂáΩÊï∞‰ªÖÁî±‰∏§Êù°Êåá‰ª§ÊûÑÊàêÔºöÁ¨¨‰∏ÄÊù°Êåá‰ª§ÊääÊï∞ÂÄº123Â≠òÊîæÂú®EAXÂØÑÂ≠òÂô®ÈáåÔºõÊ†πÊçÆÂáΩÊï∞Ë∞ÉÁî®Á∫¶ÂÆö,ÂêéÈù¢‰∏ÄÊù°Êåá‰ª§‰ºöÊääEAXÁöÑÂÄºÂΩì‰ΩúËøîÂõûÂÄº‰º†ÈÄíÁªôË∞ÉÁî®ËÄÖÂáΩÊï∞ÔºåËÄåË∞ÉÁî®ËÄÖÂáΩÊï∞ÔºàcallerÔºâ‰ºö‰ªéEAXÂØÑÂ≠òÂô®ÈáåÂèñÂÄºÔºåÊääÂÆÉÂΩì‰ΩúËøîÂõûÁªìÊûú„ÄÇ</p>
<h2 id="chap3-helloworld"><a class="markdownIt-Anchor" href="#chap3-helloworld"></a> Chap3 Hello,World!</h2>
<h3 id="msvs"><a class="markdownIt-Anchor" href="#msvs"></a> msvs</h3>
<pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"hello,world!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Áî®MSVS<code>cl 1.cpp /Fa1.asm</code>ÁîüÊàê<code>1.asm</code></p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">CONST   SEGMENT
$SG3830 DB       &#39;hello, world&#39;, 0AH, 00H
CONST   ENDS
PUBLIC  _main
EXTRN   _printf:PROC
; Function compile flags: &#x2F;Odtp
_TEXT   SEGMENT
_main   PROC
        push    ebp
        mov     ebp, esp
        push    OFFSET $SG3830
        call    _printf
        add     esp, 4
        xor     eax, eax
        pop     ebp
        ret     0
_main   ENDP
_TEXT   ENDS<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ÁîüÊàê<code>1.asm</code>ÂêéÔºåÁºñËØëÂô®‰ºöÁîüÊàê<code>1.obj</code>ÁÑ∂ÂêéÂÜçÈìæÊé•‰∏∫<code>1.exe</code></p>
<p>ÂØπËøôÊÆµÊ±áÁºñÁöÑËß£ËØª</p>
<ul>
<li>
<p>Êñá‰ª∂ÂàÜ‰∏∫‰∏§‰∏™‰ª£Á†ÅÊÆµÔºåÂç≥CONSTÂíå_TEXTÊÆµÔºåÂÆÉ‰ª¨ÂàÜÂà´‰ª£Ë°®Êï∞ÊçÆÊÆµÂíå‰ª£Á†ÅÊÆµ„ÄÇ</p>
</li>
<li>
<p>Â≠óÁ¨¶‰∏≤Â∏∏Èáè‚ÄúhelloÔºåworld‚ÄùÂàÜÈÖç‰∫Ü‰∏Ä‰∏™ÊåáÈíàÔºàconst char[]ÔºâÔºåÂè™ÊòØÂú®‰ª£Á†Å‰∏≠Ëøô‰∏™ÊåáÈíàÁöÑÂêçÁß∞Âπ∂‰∏çÊòéÊòæ</p>
</li>
<li>
<p>ÁºñËØëÂô®ËøõË°å‰∫ÜËá™Â∑±ÁöÑÂ§ÑÁêÜÔºåÂπ∂Âú®ÂÜÖÈÉ®ÊääÂ≠óÁ¨¶‰∏≤Â∏∏ÈáèÂëΩÂêç‰∏∫$SG3830,<code>0AH</code>ÊòØÊç¢Ë°åÁ¨¶</p>
<p>ÂèØ‰ª•ÂèëÁé∞Âú®Â≠óÁ¨¶‰∏≤Â∏∏ÈáèÂ∞æÈÉ®Ê∑ªÂä†‰∫Ü<code>00H</code>Ëøô‰∏™ÊòØÂ≠óÁ¨¶‰∏≤Â∏∏ÈáèÁöÑÁªìÊùüÊ†áÂøó,ÁºñËØëÂô®Ê∑ªÂä†ÁöÑ</p>
</li>
<li>
<p>Âú®‰ª£Á†ÅÊÆµ<code>_TEXT</code>Âè™Êúâ‰∏Ä‰∏™ÂáΩÊï∞ÔºåÂç≥<code>main()</code>,ÂÖ∂‰∏≠<code>PROC</code>ÊòØ<code>Procdure</code>ÁöÑÁº©ÂÜôÔºåË°®Á§∫Á®ãÂ∫èÁöÑÂºÄÂßã,‰∏é<code>ENDP</code>ÈÖçÂØπ‰ΩøÁî®</p>
</li>
<li>
<p>‰∏ªÂáΩÊï∞ÁöÑÂáΩÊï∞‰ΩìÊúâÊ†áÂøóÊÄßÁöÑÂáΩÊï∞Â∫èË®ÄÔºàfunction prologueÔºâ</p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">push ebp        ; ‰øùÂ≠òË∞ÉÁî®ËÄÖÁöÑÊ†àÂ∏ßÊåáÈíà
mov ebp, esp    ; Âª∫Á´ãÂΩìÂâçÂáΩÊï∞ÁöÑÊ†àÂ∏ßÊåáÈíà
sub esp, N      ; ‰∏∫Â±ÄÈÉ®ÂèòÈáèÂàÜÈÖçÁ©∫Èó¥ÔºàN ÊòØÈúÄË¶ÅÂàÜÈÖçÁöÑÂ≠óËäÇÊï∞Ôºâ<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>‰ª•ÂèäÂáΩÊï∞Â∞æÂ£∞Ôºàfunction epilogueÔºâ</p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">mov esp, ebp    ; ÊÅ¢Â§çÊ†àÊåáÈíà
pop ebp         ; ÊÅ¢Â§çË∞ÉÁî®ËÄÖÁöÑÊ†àÂ∏ßÊåáÈíà
ret             ; ËøîÂõûÂà∞Ë∞ÉÁî®ËÄÖ<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>ÂÆûÈôÖ‰∏äÊâÄÊúâÁöÑÂáΩÊï∞ÈÉΩÊúâËøôÊ†∑ÁöÑÂ∫èË®ÄÂíåÂ∞æÂ£∞„ÄÇ</p>
</li>
<li>
<p>Âú®ÂáΩÊï∞Â∫èË®Ä‰πãÂêéÔºåÁúãÂà∞Ë∞ÉÁî®<code>printf()</code>ÁöÑÊåá‰ª§<code>CALL _printf</code></p>
<p>ÈÄöËøá<code>PUSH</code>Êåá‰ª§ÔºåÁ®ãÂ∫èÊääÂ≠óÁ¨¶‰∏≤ÁöÑÊåáÈíàÊé®ÈÄÅÂÖ•Ê†à„ÄÇËøôÊ†∑Ôºå<code>printf()</code>ÂáΩÊï∞Â∞±ÂèØ‰ª•Ë∞ÉÁî®Ê†àÈáåÁöÑÊåáÈíàÔºåÂç≥Â≠óÁ¨¶‰∏≤<code>‚Äúhello, world!‚Äù</code>ÁöÑÂú∞ÂùÄ„ÄÇ</p>
</li>
<li>
<p>Âú®<code>printf()</code>ÂáΩÊï∞ÁªìÊùü‰ª•ÂêéÔºåÁ®ãÂ∫èÁöÑÊéßÂà∂ÊµÅ‰ºöËøîÂõûÂà∞<code>main()</code>ÂáΩÊï∞‰πã‰∏≠„ÄÇÊ≠§Êó∂ÔºåÂ≠óÁ¨¶‰∏≤Âú∞ÂùÄÔºàÂç≥ÊåáÈíàÔºâ‰ªçÊÆãÁïôÂú®Êï∞ÊçÆÊ†à‰πã‰∏≠„ÄÇËøô‰∏™Êó∂ÂÄôÂ∞±ÈúÄË¶ÅË∞ÉÊï¥Ê†àÊåáÈíàÔºàESPÂØÑÂ≠òÂô®ÈáåÁöÑÂÄºÔºâÊù•ÈáäÊîæËøô‰∏™ÊåáÈíà„ÄÇ</p>
</li>
<li>
<p>‰∏ã‰∏ÄÊù°ËØ≠Âè•ÊòØ<code>‚Äúadd ESPÔºå4‚Äù</code>ÔºåÊääESPÂØÑÂ≠òÂô®ÔºàÊ†àÊåáÈíà/Stack PointerÔºâÈáåÁöÑÊï∞ÂÄºÂä†4„ÄÇ(Âú®32‰ΩçÁ≥ªÁªü‰∏≠ÔºåÊåáÈíàÁöÑÂ§ßÂ∞èÂç†4Â≠óËäÇÔºåÂêåÁêÜÂú®64‰Ωç‰∏≠ÔºåÂ∞±Ë¶Å+8)</p>
<p>ËøôÊù°Êåá‰ª§ÂèØ‰ª•ÁêÜËß£‰∏∫‚ÄúPOPÊüêÂØÑÂ≠òÂô®‚Äù„ÄÇÂè™ÊòØÊú¨‰æãÁöÑÊåá‰ª§Áõ¥Êé•ËàçÂºÉ‰∫ÜÊ†àÈáåÁöÑÊï∞ÊçÆËÄåPOPÊåá‰ª§ËøòË¶ÅÊääÂØÑÂ≠òÂô®ÈáåÁöÑÂÄºÂ≠òÂÇ®Âà∞Êó¢ÂÆöÂØÑÂ≠òÂô®</p>
<p>Êüê‰∫õÁºñËØëÂô®ÔºàÂ¶ÇIntel C<ins>ÁºñËæëÂô®Ôºâ‰∏ç‰ºö‰ΩøÁî®ADDÊåá‰ª§Êù•ÈáäÊîæÊï∞ÊçÆÊ†àÔºå<strong>ÂÆÉ‰ª¨ÂèØËÉΩ‰ºöÁî®POP ECXÊåá‰ª§</strong>„ÄÇ‰æãÂ¶ÇÔºåOracle RDBMSÔºàÁî±Intel C</ins>ÁºñËØëÂô®ÁºñËØëÔºâÂ∞±‰ºöÁî®POP ECXÊåá‰ª§ÔºåËÄå‰∏ç‰ºöÁî®ADDÊåá‰ª§„ÄÇËôΩÁÑ∂POP ECXÂëΩ‰ª§Á°ÆÂÆû‰ºö‰øÆÊîπECXÂØÑÂ≠òÂô®ÁöÑÂÄºÔºå‰ΩÜÊòØÂÆÉ‰πüÂêåÊ†∑ÈáäÊîæ‰∫ÜÊ†àÁ©∫Èó¥„ÄÇ</p>
<p>Intel C++ÁºñËØëÂô®‰ΩøÁî®POP ECXÊåá‰ª§ÁöÑÂè¶Â§ñ‰∏Ä‰∏™ÁêÜÁî±Â∞±ÊòØÔºå<strong>POP ECXÂØπÂ∫îÁöÑOPCODEÔºà1Â≠óËäÇÔºâÊØîADD ESPÁöÑOPCODEÔºà3Â≠óËäÇÔºâË¶ÅÁü≠„ÄÇ</strong></p>
</li>
<li>
<p>Âú®‰∏äËø∞Á®ãÂ∫è‰∏≠printf()ÂáΩÊï∞ÁªìÊùü‰πãÂêéÔºåmain()ÂáΩÊï∞‰ºöËøîÂõû0ÔºàÂáΩÊï∞Ê≠£Â∏∏ÈÄÄÂá∫ÁöÑËøîÂõûÁ†ÅÔºâ„ÄÇÂç≥main()ÂáΩÊï∞ÁöÑËøêÁÆóÁªìÊûúÊòØ0„ÄÇËøô‰∏™ËøîÂõûÂÄºÊòØÁî±<strong>Êåá‰ª§<code>‚ÄúXOR EAX, EAX‚Äù</code>ËÆ°ÁÆóÂá∫Êù•ÁöÑ</strong>„ÄÇÁºñËØëÂô®ÈÄöÂ∏∏ÈááÁî®ÂºÇÊàñËøêÁÆóÊåá‰ª§ÔºåËÄå‰∏ç‰ºö‰ΩøÁî®‚ÄúMOV EAXÔºå0‚ÄùÊåá‰ª§„ÄÇ‰∏ªË¶ÅÊòØÂõ†‰∏∫<strong>ÂºÇÊàñËøêÁÆóÁöÑopcodeËæÉÁü≠</strong>Ôºà2Â≠óËäÇ:5Â≠óËäÇÔºâ</p>
</li>
<li>
<p>Ê±áÁºñÂàóË°®‰∏≠ÊúÄÂêéÁöÑÊìç‰ΩúÊåá‰ª§ÊòØRETÔºåÂ∞ÜÊéßÂà∂ÊùÉ‰∫§ÁªôË∞ÉÁî®Á®ãÂ∫è„ÄÇÈÄöÂ∏∏ÂÆÉËµ∑Âà∞ÁöÑ‰ΩúÁî®Â∞±ÊòØÂ∞ÜÊéßÂà∂ÊùÉ‰∫§ÁªôÊìç‰ΩúÁ≥ªÁªüÔºåËøôÈÉ®ÂàÜÂäüËÉΩÁî±C/C++ÁöÑ<code>CRT</code>ÂÆûÁé∞„ÄÇÔºàC RUNTIME LIBRARY)</p>
</li>
</ul>
<h3 id="gcc"><a class="markdownIt-Anchor" href="#gcc"></a> gcc</h3>
<p>Âà©Áî®<code>gcc</code>ÁºñËØëÂô®ÁºñËØë<code>gcc 1.c -o 1</code>ÈááÁî®<code>-S -masm=intel</code>ÁîüÊàêintelËØ≠Ê≥ïÁöÑÊ±áÁºñÂàóË°®Êñá‰ª∂</p>
<p>ÁîüÊàêÂêéÁî®IDAÊâìÂºÄ</p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">Main         proc near
var_10       &#x3D; dword ptr -10h

             push    ebp
             mov     ebp, esp
             and     esp, 0FFFFFFF0h
             sub     esp, 10h
             mov     eax, offset aHelloWorld ; &quot;hello, world\n&quot;
             mov     [esp+10h+var_10], eax
             call    _printf
             mov     eax, 0
             leave
             retn
main         endp<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Ê±áÁºñËß£ËØª</p>
<ul>
<li>‰∏éMSVCÁîüÊàêÁöÑÁªìÊûúÂü∫Êú¨Áõ∏Âêå„ÄÇÂÆÉÈ¶ñÂÖàÊää‚Äúhello, world‚ÄùÂ≠óÁ¨¶‰∏≤Âú®Êï∞ÊçÆÊÆµÁöÑÂú∞ÂùÄÔºàÊåáÈíàÔºâÂ≠òÂÇ®Âà∞EAXÂØÑÂ≠òÂô®ÈáåÔºåÁÑ∂ÂêéÂÜçÊääÂÆÉÂ≠òÂÇ®Âú®Êï∞ÊçÆÊ†àÈáå„ÄÇ</li>
<li>ÂºÄÂ§¥ÁöÑ<code>and esp,0FFFFFFF0h</code>Âêë16Â≠óËäÇËæπÁïåÂØπÈΩêÔºàÊàê‰∏∫16ÁöÑÊï¥Êï∞ÂÄçÔºâÔºåÂ±û‰∫éÂàùÂßãÂåñÁöÑÊåá‰ª§„ÄÇÂ¶ÇÊûúÂú∞ÂùÄ‰ΩçÊ≤°ÊúâÂØπÈΩêÔºåÈÇ£‰πàCPUÂèØËÉΩÈúÄË¶ÅËÆøÈóÆ‰∏§Ê¨°ÂÜÖÂ≠òÊâçËÉΩËé∑ÂæóÊ†àÂÜÖÊï∞ÊçÆ„ÄÇËôΩÁÑ∂Âú®8Â≠óËäÇËæπÁïåÂ§ÑÂØπÈΩêÂ∞±ÂèØ‰ª•Êª°Ë∂≥32‰Ωçx86 CPUÂíå64‰Ωçx64 CPUÁöÑË¶ÅÊ±ÇÔºå‰ΩÜÊòØ‰∏ªÊµÅÁºñËØëÂô®ÁöÑÁºñËØëËßÑÂàôËßÑÂÆö‚ÄúÁ®ãÂ∫èËÆøÈóÆÁöÑÂú∞ÂùÄÂøÖÈ°ªÂêë16Â≠óËäÇÂØπÈΩêÔºàË¢´16Êï¥Èô§Ôºâ,ÁõÆÁöÑÊòØ‰∏∫‰∫ÜÊèêÈ´òÊïàÁéá</li>
<li><code>‚ÄúSUB ESPÔºå10h‚Äù</code>Â∞ÜÂú®Ê†à‰∏≠ÂàÜÈÖç0x10 bytesÔºåÂç≥16Â≠óËäÇ„ÄÇÊàë‰ª¨Âú®ÂêéÊñáÁúãÂà∞ÔºåÁ®ãÂ∫èÂè™‰ºöÁî®Âà∞4Â≠óËäÇÁ©∫Èó¥„ÄÇ‰ΩÜÊòØÂõ†‰∏∫ÁºñËØëÂô®ÂØπÊ†àÂú∞ÂùÄÔºàESPÔºâËøõË°å‰∫Ü16Â≠óËäÇÂØπÈΩêÔºåÊâÄ‰ª•ÊØèÊ¨°ÈÉΩ‰ºöÂàÜÈÖç16Â≠óËäÇÁöÑÁ©∫Èó¥„ÄÇ</li>
<li>ËÄåÂêéÔºåÁ®ãÂ∫èÂ∞ÜÂ≠óÁ¨¶‰∏≤Âú∞ÂùÄÔºàÊåáÈíàÁöÑÂÄºÔºâÁõ¥Êé•ÂÜôÂÖ•Âà∞Êï∞ÊçÆÊ†à„ÄÇÊ≠§Â§ÑÔºåGCC‰ΩøÁî®ÁöÑÊòØMOVÊåá‰ª§ÔºõËÄåMSVCÁîüÊàêÁöÑÊòØPUSHÊåá‰ª§„ÄÇÂÖ∂‰∏≠var_10ÊòØÂ±ÄÈÉ®ÂèòÈáèÔºåÁî®Êù•ÂêëÂêéÈù¢ÁöÑprintf()ÂáΩÊï∞‰º†ÈÄíÂèÇÊï∞„ÄÇ</li>
<li>GCCÂíåMSVC‰∏çÂêåÔºåÈô§Èùû‰∫∫Â∑•ÊåáÂÆö‰ºòÂåñÈÄâÈ°πÔºåÂê¶ÂàôÂÆÉ‰ºöÁîüÊàê‰∏éÊ∫ê‰ª£Á†ÅÁõ¥Êé•ÂØπÂ∫îÁöÑ‚ÄúMOV EAX, 0‚ÄùÊåá‰ª§„ÄÇ‰ΩÜÊòØÔºåÊàë‰ª¨Â∑≤ÁªèÁü•ÈÅìMOVÊåá‰ª§ÁöÑopcodeËÇØÂÆöË¶ÅÊØîXORÊåá‰ª§ÁöÑopcodeÈïø„ÄÇ</li>
<li>LEAVEÊåá‰ª§ÔºåÁÆÄÂåñÂáΩÊï∞Â∞æÂ£∞ÔºåÁ≠âÊïà‰∫é<code>‚ÄúMOV ESP, EBP‚Äù</code>Âíå‚Äú<code>POP EBP‚Äù</code>‰∏§Êù°Êåá‰ª§„ÄÇÂèØËßÅÔºåËøô‰∏™Êåá‰ª§Ë∞ÉÊï¥‰∫ÜÊï∞ÊçÆÊ†àÊåáÈíàESPÔºåÂπ∂Â∞ÜEBPÁöÑÊï∞ÂÄºÊÅ¢Â§çÂà∞Ë∞ÉÁî®Ëøô‰∏™ÂáΩÊï∞‰πãÂâçÁöÑÂàùÂßãÁä∂ÊÄÅ„ÄÇ</li>
</ul>
<h3 id="msvs-x86-64"><a class="markdownIt-Anchor" href="#msvs-x86-64"></a> msvs x86-64</h3>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">$SG2989  DB      &#39;hello, world&#39;, 0AH 00H

main     PROC
         sub     rsp, 40
         lea     rcx, OFFSET FLAT:$SG2989
         call    printf
         xor     eax, eax
         add     rsp, 40
         ret     0
main     ENDP<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Âú®x86-64Ê°ÜÊû∂ÁöÑCPUÈáåÔºåÊâÄÊúâÁöÑÁâ©ÁêÜÂØÑÂ≠òÂô®ÈÉΩË¢´Êâ©Â±ï‰∏∫64‰ΩçÂØÑÂ≠òÂô®„ÄÇÂØÑÂ≠òÂô®Âèò‰∏∫rÂ≠óÂºÄÂ§¥</p>
<p>‰∏∫‰∫ÜÂ∞ΩÂèØËÉΩÂÖÖÂàÜÂú∞Âà©Áî®ÂØÑÂ≠òÂô®„ÄÅÂáèÂ∞ëËÆøÈóÆÂÜÖÂ≠òÊï∞ÊçÆÁöÑÊ¨°Êï∞ÔºåÁºñËØëÂô®‰ºöÂÖÖÂàÜÂà©Áî®ÂØÑÂ≠òÂô®‰º†ÈÄíÂáΩÊï∞ÂèÇÊï∞ÔºàËØ∑ÂèÇËßÅ64.3ËäÇÁöÑfastcallÁ∫¶ÂÆöÔºâ„ÄÇ‰πüÂ∞±ÊòØËØ¥ÔºåÁºñËØëÂô®‰ºö‰ºòÂÖà‰ΩøÁî®ÂØÑÂ≠òÂô®‰º†ÈÄíÈÉ®ÂàÜÂèÇÊï∞ÔºåÂÜçÂà©Áî®ÂÜÖÂ≠òÔºàÊï∞ÊçÆÊ†àÔºâ‰º†ÈÄíÂÖ∂‰ΩôÁöÑÂèÇÊï∞„ÄÇ<code>Win64ÁöÑÁ®ãÂ∫è</code>Ëøò‰ºö‰ΩøÁî®<code>RCX„ÄÅRDX„ÄÅR8„ÄÅR9</code>Ëøô4‰∏™ÂØÑÂ≠òÂô®Êù•Â≠òÊîæÂáΩÊï∞ÂèÇÊï∞„ÄÇÊàë‰ª¨Á®çÂêéÂ∞±‰ºöÁúãÂà∞ËøôÁßçÊÉÖÂÜµÔºöprintf()‰ΩøÁî®RCXÂØÑÂ≠òÂô®‰º†ÈÄíÂèÇÊï∞ÔºåËÄåÊ≤°ÊúâÂÉè32‰ΩçÁ®ãÂ∫èÈÇ£Ê†∑‰ΩøÁî®Ê†à‰º†ÈÄíÊï∞ÊçÆ„ÄÇ</p>
<p>main()ÂáΩÊï∞ÁöÑËøîÂõûÂÄºÊòØÊï¥Êï∞Á±ªÂûãÁöÑÈõ∂Ôºå‰ΩÜÊòØÂá∫‰∫éÂÖºÂÆπÊÄßÂíåÂèØÁßªÊ§çÊÄßÁöÑËÄÉËôëÔºåCËØ≠Ë®ÄÁöÑÁºñËØëÂô®‰ªçÂ∞Ü‰ΩøÁî®<code>32‰ΩçÁöÑÈõ∂</code>„ÄÇÊç¢ËÄåË®Ä‰πãÔºåÂç≥‰ΩøÊòØ64‰ΩçÁöÑÂ∫îÁî®Á®ãÂ∫èÔºåÂú®Á®ãÂ∫èÁªìÊùüÊó∂EAXÁöÑÂÄºÊòØÈõ∂ÔºåËÄåR<code>AXÁöÑÂÄº‰∏ç‰∏ÄÂÆö‰ºöÊòØÈõ∂„ÄÇ</code></p>
<p>Êï∞ÊçÆÊ†àÁöÑÂØπÂ∫îÁ©∫Èó¥Èáå‰ªçÁïôÊúâ40Â≠óËäÇÁöÑÊï∞ÊçÆ„ÄÇËøôÈÉ®ÂàÜÊï∞ÊçÆÁ©∫Èó¥Êúâ‰∏™‰∏ìÁî®ÁöÑÂêçËØçÔºåÂç≥<code>Èò¥ÂΩ±Á©∫Èó¥</code>Ôºàshadow spaceÔºâ</p>
<h3 id="gcc-x86-64"><a class="markdownIt-Anchor" href="#gcc-x86-64"></a> gcc x86-64</h3>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">.string &quot;hello, world\n&quot;
main:
         sub      rsp, 8
         mov      edi, OFFSET FLAT:.LC0 ; &quot;hello, world&quot;
         xor      eax, eax  ; number of vector registers passed
         call     printf
         xor      eax, eax
         add      rsp, 8
         ret<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>Linux„ÄÅBSDÂíåMac OS XÁ≥ªÁªü‰∏≠ÁöÑÂ∫îÁî®Á®ãÂ∫è</strong>Ôºå‰ºö‰ºòÂÖà‰ΩøÁî®<code>RDI„ÄÅRSI„ÄÅRDX„ÄÅRCX„ÄÅR8„ÄÅR9Ëøô6‰∏™ÂØÑÂ≠òÂô®‰º†ÈÄíÂáΩÊï∞ÊâÄÈúÄÁöÑÂ§¥6‰∏™ÂèÇÊï∞</code>ÔºåÁÑ∂Âêé‰ΩøÁî®Êï∞ÊçÆÊ†à‰º†ÈÄíÂÖ∂‰ΩôÁöÑÂèÇÊï∞„ÄÇ</p>
<p>‰ΩøÁî®‰∫Ü<code>EDI</code>ÂØÑÂ≠òÂô®Êù•‰º†ÈÄíÂ≠óÁ¨¶‰∏≤ÊåáÈíàÔºå‰∏∫‰ªÄ‰πà‰∏çÁî®<code>RDI</code></p>
<p>ÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºå64‰ΩçÊ±áÁºñÊåá‰ª§MOVÂú®ÂÜôÂÖ•R-ÂØÑÂ≠òÂô®ÁöÑ‰Ωé32‰ΩçÂú∞ÂùÄ‰ΩçÁöÑÊó∂ÂÄôÔºåÂç≥ÂØπE-ÂØÑÂ≠òÂô®ËøõË°åÂÜôÊìç‰ΩúÁöÑÊó∂ÂÄôÔºå‰ºöÂêåÊó∂Ê∏ÖÈô§R-ÂØÑÂ≠òÂô®‰∏≠ÁöÑÈ´ò32‰ΩçÂú∞ÂùÄ‰Ωç„ÄÇÊâÄ‰ª•, ‚ÄúMOV EAX, 011223344h‚ÄùËÉΩÂ§üÂØπRAXÂØÑÂ≠òÂô®ËøõË°åÊ≠£Á°ÆÁöÑËµãÂÄºÊìç‰ΩúÔºåÂõ†‰∏∫ËØ•Êåá‰ª§‰ºöÊ∏ÖÈô§ÔºàÁΩÆÈõ∂ÔºâÈ´òÂú∞ÂùÄ‰ΩçÁöÑÂÜÖÂÆπ„ÄÇ</p>
<p>‰ΩøÁî®<code>EDI</code>ÊòØÂõ†‰∏∫ÂèØ‰ª•‰Ωø<code>opcode</code>Áî±7‰∏™Â≠óËäÇÂáèÂ∞ëÂà∞5‰∏™Â≠óËäÇ,gcc‰ºòÂåñ</p>
<p><code>gcc</code>ÁöÑ‰ºòÂåñÊúâÂæàÂ§öÁâπÊÄßÔºå‰æãÂ¶Ç:ÂÆÉÂèØËÉΩ‰ºöÊääÂ≠óÁ¨¶‰∏≤ÊãÜÂá∫Êù•ÂçïÁã¨‰ΩøÁî®„ÄÇ‰ª•ËäÇÁúÅÂÜÖÂ≠ò</p>
<h3 id="problems"><a class="markdownIt-Anchor" href="#problems"></a> Problems</h3>
<p>1.Á≠î:Ë∞ÉÁî®‰∫Ü<code>MessagBeep</code>Ëøô‰∏™ÂáΩÊï∞ÔºåÂèÇÊï∞‰∏∫0xFFFFFFFF</p>
<h2 id="chap4-ÂáΩÊï∞Â∫èË®ÄÂíåÂáΩÊï∞Â∞æÂ£∞"><a class="markdownIt-Anchor" href="#chap4-ÂáΩÊï∞Â∫èË®ÄÂíåÂáΩÊï∞Â∞æÂ£∞"></a> Chap4 ÂáΩÊï∞Â∫èË®ÄÂíåÂáΩÊï∞Â∞æÂ£∞</h2>
<p>Áï•</p>
<h2 id="chap5-Ê†à"><a class="markdownIt-Anchor" href="#chap5-Ê†à"></a> Chap5 Ê†à</h2>
<ul>
<li>
<p>Ê†àÂ∞±ÊòØCPUÂØÑÂ≠òÂô®ÈáåÁöÑÊüê‰∏™ÊåáÈíàÊâÄÊåáÂêëÁöÑ‰∏ÄÁâáÂÜÖÂ≠òÂå∫Âüü„ÄÇËøôÈáåÊâÄËØ¥ÁöÑ‚ÄúÊüê‰∏™ÊåáÈíà‚ÄùÈÄöÂ∏∏‰Ωç‰∫éx86/x64Âπ≥Âè∞ÁöÑESPÂØÑÂ≠òÂô®/RSPÂØÑÂ≠òÂô®Ôºå‰ª•ÂèäARMÂπ≥Âè∞ÁöÑSPÂØÑÂ≠òÂô®„ÄÇ</p>
</li>
<li>
<p>Êìç‰ΩúÊ†àÁöÑÊúÄÂ∏∏ËßÅÁöÑÊåá‰ª§ÊòØPUSHÂíåPOPÔºå<code>PUSH</code>Êåá‰ª§‰ºöÂØπESP/RSP/SPÂØÑÂ≠òÂô®ÁöÑÂÄºËøõË°åÂáèÊ≥ïËøêÁÆóÔºå‰Ωø‰πãÂáèÂéª4Ôºà32‰ΩçÔºâÊàñ8Ôºà64‰ΩçÔºâÔºåÁÑ∂ÂêéÂ∞ÜÊìç‰ΩúÊï∞ÂÜôÂà∞‰∏äËø∞ÂØÑÂ≠òÂô®ÈáåÁöÑÊåáÈíàÊâÄÊåáÂêëÁöÑÂÜÖÂ≠ò‰∏≠„ÄÇ<code>POP</code>Êåá‰ª§ÊòØPUSHÊåá‰ª§ÁöÑÈÄÜÊìç‰ΩúÔºöÂÆÉÂÖà‰ªéÊ†àÊåáÈíàÔºàStack PointerÔºå‰∏äÈù¢‰∏â‰∏™ÂØÑÂ≠òÂô®‰πã‰∏ÄÔºâÊåáÂêëÁöÑÂÜÖÂ≠ò‰∏≠ËØªÂèñÊï∞ÊçÆÔºåÁî®‰ª•Â§áÁî®ÔºàÈÄöÂ∏∏ÊòØÂÜôÂà∞ÂÖ∂‰ªñÂØÑÂ≠òÂô®ÈáåÔºâÔºåÁÑ∂ÂêéÂÜçÂ∞ÜÊ†àÊåáÈíàÁöÑÊï∞ÂÄºÂä†‰∏ä4Êàñ8„ÄÇ</p>
</li>
<li>
<p>Ê†àÊòØÈÄÜÂ¢ûÈïøÁöÑÔºåÂç≥‰ªéÈ´òÂú∞ÂùÄÂêë‰ΩéÂú∞ÂùÄÂ¢ûÈïø</p>
</li>
</ul>
<hr />
<h3 id="Ê†àÁöÑÁî®ÈÄî"><a class="markdownIt-Anchor" href="#Ê†àÁöÑÁî®ÈÄî"></a> Ê†àÁöÑÁî®ÈÄî</h3>
<ul>
<li>
<p>‰øùÂ≠òÂáΩÊï∞ÁöÑËøîÂõûÂú∞ÂùÄ</p>
<p><code>call</code>Êåá‰ª§Á≠â‰ª∑‰∫é<code>push ËøîÂõûÂú∞ÂùÄ</code>‰∏é<code>jmp ÂáΩÊï∞Âú∞ÂùÄ</code></p>
<p><code>ret</code>Êåá‰ª§‰ªéÊ†à‰∏≠ËØªÂèñËøîÂõûÂú∞ÂùÄÔºåÁÑ∂ÂêéË∑≥ËΩ¨Âà∞Ëøô‰∏™Âú∞ÂùÄÔºåÁ≠â‰ª∑‰∫é<code>pop ËøîÂõûÂú∞ÂùÄ</code>‰∏é<code>jmp ËøîÂõûÂú∞ÂùÄ</code></p>
<p>Áî±Ê≠§ÂèØÂÆûÁé∞ÂáΩÊï∞ÁöÑÈÄíÂΩíË∞ÉÁî®</p>
</li>
<li>
<p>ÂèÇÊï∞‰º†ÈÄí</p>
<p>ÊúÄÂ∏∏Áî®ÁöÑÂèÇÊï∞‰º†ÈÄíÁ∫¶ÂÆöÊòØ<code>cdecl</code></p>
<p>‰ª•‰∏ã‰∏∫ÂÖ∂‰∏ªË¶ÅËßÑÂàô</p>
<ol>
<li><strong>ÂèÇÊï∞‰ªéÂè≥Âà∞Â∑¶ÂéãÂÖ•Ê†à</strong></li>
<li><strong>Ë∞ÉÁî®ËÄÖË¥üË¥£Ê∏ÖÁêÜÊ†à</strong>ÔºöÂáΩÊï∞Ë∞ÉÁî®ÁªìÊùüÂêéÔºåË∞ÉÁî®ËÄÖÈúÄË¶ÅË¥üË¥£‰ªéÊ†à‰∏≠ÂºπÂá∫‰º†ÈÄíÁªôÂáΩÊï∞ÁöÑÊâÄÊúâÂèÇÊï∞„ÄÇËøôÊÑèÂë≥ÁùÄÁºñËØëÂô®‰ºöÂú®Ë∞ÉÁî®ÂáΩÊï∞‰πãÂêéÁîüÊàêÁõ∏Â∫îÁöÑ‰ª£Á†ÅÊù•Ë∞ÉÊï¥Â†ÜÊ†àÊåáÈíàÔºåÊÅ¢Â§çË∞ÉÁî®ÂâçÁöÑÁä∂ÊÄÅ„ÄÇ</li>
<li><strong>ÂèØÂèòÂèÇÊï∞ÂàóË°®ÊîØÊåÅ</strong>Ôºöcdecl ÊîØÊåÅÂáΩÊï∞ÂÖ∑ÊúâÂèØÂèòÊï∞ÈáèÁöÑÂèÇÊï∞ÔºàÂ¶Ç printf ÂáΩÊï∞ÔºâÔºåËøôÊòØÈÄöËøáÂú®ÂèÇÊï∞ÂàóË°®‰∏≠‰ΩøÁî®ÁúÅÁï•Âè∑Ôºà‚Ä¶ÔºâÊù•Ë°®Á§∫ÁöÑ„ÄÇ</li>
<li><strong>ËøîÂõûÂÄºÈÄöÂ∏∏Âú®EAXÂØÑÂ≠òÂô®‰∏≠</strong>ÔºàÂØπ‰∫éx86Êû∂ÊûÑÔºâÔºöÂ§ßÂ§öÊï∞ÊÉÖÂÜµ‰∏ãÔºåÂáΩÊï∞ÁöÑËøîÂõûÂÄºÂ¶ÇÊûúÂ§ßÂ∞èÈÄÇÂΩìÔºàÊØîÂ¶ÇÊï¥Êï∞„ÄÅÊåáÈíàÔºâÔºå‰ºöÈÄöËøáEAXÂØÑÂ≠òÂô®ËøîÂõû„ÄÇÂØπ‰∫éÊõ¥Â§ßÁöÑËøîÂõûÁ±ªÂûãÔºåÂèØËÉΩ‰ºöÈÄöËøáÂÖ∂‰ªñÊñπÂºèÔºåÂ¶ÇÈÄöËøáÊåáÈíà‰º†ÈÄí„ÄÇ</li>
</ol>
<p>‰æãÂ¶Ç</p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">push arg3
push arg2
push arg1
call f
add esp.12;4*3<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Ë¢´Ë∞ÉÁî®ÁöÑÂáΩÊï∞ÂèØ‰ª•ÈÄöËøáÊ†àÊåáÈíàËé∑ÂèñÊâÄÈúÄÂèÇÊï∞</p>
<table>
<thead>
<tr>
<th>ESP</th>
<th>ËøîÂõûÂú∞ÂùÄ</th>
</tr>
</thead>
<tbody>
<tr>
<td>ESP+4</td>
<td>arg1, ÂÆÉÂú®IDAÈáåËÆ∞‰∏∫arg_0</td>
</tr>
<tr>
<td>ESP+8</td>
<td>arg2, ÂÆÉÂú®IDAÈáåËÆ∞‰∏∫arg_4</td>
</tr>
<tr>
<td>ESP+0xC</td>
<td>arg3, ÂÆÉÂú®IDAÈáåËÆ∞‰∏∫arg_8</td>
</tr>
</tbody>
</table>
<p>ÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåÁ®ãÂ∫èÂëòÂèØ‰ª•‰ΩøÁî®Ê†àÊù•‰º†ÈÄíÂèÇÊï∞Ôºå‰πüÂèØ‰ª•‰∏ç‰ΩøÁî®Ê†à‰º†ÈÄíÂèÇÊï∞„ÄÇÂèÇÊï∞Â§ÑÁêÜÊñπÈù¢Âπ∂Ê≤°ÊúâÁõ∏ÂÖ≥ÁöÑÁ°¨ÊÄßËßÑÂÆö„ÄÇ‰æãÂ¶Ç‰πüÂèØ‰ª•Áî®ÂØÑÂ≠òÂô®ÊàñËÄÖÂ†Ü‰∏äÂºÄËæüÂÜÖÂ≠òËøõË°å‰º†ÂèÇÔºå‰∏çËøáÂú®x86ËøôÁßçÁ∫¶ÂÆöÂ∑≤ÊòØ‰π†ÊÉØ</p>
<p>Â¶ÇÊûúÂáΩÊï∞ÂèØÂ§ÑÁêÜÁöÑÂèÇÊï∞Êï∞ÈáèÂèØÂèòÔºåÂ∞±ÈúÄË¶ÅÁî®ËØ¥ÊòéÁ¨¶Â¶Ç%dËøõË°åÊ†ºÂºèÂåñËØ¥ÊòéÔºåÊòéÁ°ÆÂèÇÊï∞‰ø°ÊÅØ</p>
<pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d %d %d"</span><span class="token punctuation">,</span> <span class="token number">1234</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Ëøô‰∏™ÂëΩ‰ª§‰∏ç‰ªÖ‰ºöËÆ©printf()ÊòæÁ§∫1234ÔºåËÄå‰∏îËøò‰ºöËÆ©ÂÆÉÊòæÁ§∫Êï∞ÊçÆÊ†àÂÜÖ1234‰πãÂêéÁöÑ‰∏§‰∏™Âú∞ÂùÄÁöÑÈöèÊú∫Êï∞„ÄÇ</p>
<p>Áî±Ê≠§ÂèØÁü•ÔºåÂ£∞Êòémain()ÂáΩÊï∞ÁöÑÊñπÊ≥ïÂπ∂‰∏çÊòØÈÇ£‰πàÈáçË¶Å„ÄÇÊàë‰ª¨ÂèØ‰ª•Â∞Ü‰πãÂ£∞Êòé‰∏∫<code>main(),main(int argc, char *argv[])Êàñmain(int argc, char *argv[], char *envp[])</code>,CRT‰∏≠Ë∞ÉÁî®<code>main()</code>Êåá‰ª§Â¶Ç‰∏ã:</p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">push envp
push argv
push argc
call main<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li>
<p>Â≠òÂÇ®Â±ÄÈÉ®ÂèòÈáè</p>
</li>
<li>
<p>x86.alloca()ÂáΩÊï∞</p>
<p><code>malloc()</code>ÊòØÂú®Â†Ü‰∏äÂàÜÈÖçÂÜÖÂ≠òÔºåËÄå<code>alloc()</code>Áõ¥Êé•‰ΩøÁî®Ê†àÊù•ÂàÜÈÖçÂÜÖÂ≠ò</p>
<p>Áî±‰∫éÂáΩÊï∞Â∞æÂ£∞ÁöÑ‰ª£Á†Å‰ºöËøòÂéü<code>ESP</code>ÁöÑÂÄºÔºå‰∏çÈúÄË¶ÅÁâπÂú∞‰ΩøÁî®<code>free()</code>Êù•ÈáäÊîæÂÜÖÂ≠ò</p>
</li>
<li>
<p>(Win)SEHÁªìÊûÑÂåñÂºÇÂ∏∏Â§ÑÁêÜ</p>
<p>Â¶ÇÊûúÁ®ãÂ∫èÈáåÂ≠òÂú®<code>SEH</code>ËÆ∞ÂΩïÔºåÈÇ£‰πàËÆ∞ÂΩï‰ºö‰øùÂ≠òÂú®Ê†à‰∏≠</p>
</li>
<li>
<p>ÁºìÂÜ≤Âå∫Ê∫¢Âá∫‰øùÊä§</p>
</li>
<li>
<p>ÂÖ∏ÂûãÁöÑÊ†àÁöÑÂÜÖÂ≠òÂ≠òÂÇ®Ê†ºÂºè</p>
<p>Âú®32‰ΩçÁ≥ªÁªü‰∏≠ÔºåÂú®Á®ãÂ∫èË∞ÉÁî®ÂáΩÊï∞‰πãÂêé„ÄÅÊâßË°åÂÆÉÁöÑÁ¨¨‰∏ÄÊù°Êåá‰ª§‰πãÂâçÔºåÊ†àÂú®ÂÜÖÂ≠ò‰∏≠ÁöÑÂ≠òÂÇ®Ê†ºÂºè‰∏ÄËà¨Â¶Ç‰∏ãË°®ÊâÄÁ§∫„ÄÇ</p>
<table>
<thead>
<tr>
<th>‚Ä¶</th>
<th>‚Ä¶‚Ä¶</th>
</tr>
</thead>
<tbody>
<tr>
<td>ESP-0xC</td>
<td>Á¨¨2‰∏™Â±ÄÈÉ®ÂèòÈáèÔºåÂú®IDAÈáåËÆ∞‰∏∫var_8</td>
</tr>
<tr>
<td>ESP-8</td>
<td>Á¨¨1‰∏™Â±ÄÈÉ®ÂèòÈáèÔºåÂú®IDAÈáåËÆ∞‰∏∫var_4</td>
</tr>
<tr>
<td>ESP-4</td>
<td>‰øùÂ≠òÁöÑEBPÂÄº</td>
</tr>
<tr>
<td>ESP</td>
<td>ËøîÂõûÂú∞ÂùÄ</td>
</tr>
<tr>
<td>ESP+4</td>
<td>arg1, Âú®IDAÈáåËÆ∞‰∏∫arg_0</td>
</tr>
<tr>
<td>ESP+8</td>
<td>arg2, Âú®IDAÈáåËÆ∞‰∏∫arg_4</td>
</tr>
<tr>
<td>ESP+0xC</td>
<td>arg3, Âú®IDAÈáåËÆ∞‰∏∫arg_8</td>
</tr>
<tr>
<td>‚Ä¶</td>
<td>‚Ä¶‚Ä¶</td>
</tr>
</tbody>
</table>
</li>
</ul>
<hr />
<h3 id="Ê†àÁöÑÂô™Èü≥"><a class="markdownIt-Anchor" href="#Ê†àÁöÑÂô™Èü≥"></a> Ê†àÁöÑÂô™Èü≥</h3>
<p>ÂáΩÊï∞ÈÄÄÂá∫‰ª•Âêé,ÂéüÊúâÊ†àÁöÑÁ©∫Èó¥ÈáåÁöÑÂ±ÄÈÉ®ÂèòÈáè‰∏ç‰ºöË¢´Ëá™Âä®Ê∏ÖÈô§Ôºå‰ªçÁÑ∂‰øùÁïôÂ∞±Êàê‰∫ÜÊ†à‰∏≠ÁöÑËÑèÊï∞ÊçÆ</p>
<p>‰æãÂ¶Ç</p>
<pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>

<span class="token keyword">void</span> <span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
<span class="token punctuation">&#123;</span>
        <span class="token keyword">int</span> a<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> b<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">f2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
<span class="token punctuation">&#123;</span>
        <span class="token keyword">int</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">;</span>
        <span class="token function">printf</span> <span class="token punctuation">(</span><span class="token string">"%d, %d, %d\n"</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
<span class="token punctuation">&#123;</span>
        <span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">f2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Êàë‰ª¨‰ºöÂèëÁé∞ÔºåÊ≤°ÊúâÂØπf2ÁöÑÂèòÈáèÂàùÂßãÂåñÔºå‰ªçÁÑ∂ÊâìÂç∞ÁöÑÊòØ 1 2 3</p>
<p>ÂèØ‰ª•Á†îÁ©∂‰∏Ä‰∏ãÊ±áÁºñ‰ª£Á†Å,Âà©Áî®MSVSÁºñËØëÁöÑ‰ª£Á†ÅÂ¶Ç‰∏ã</p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">$SG2752 DB      &#39;%d, %d, %d&#39;, 0aH, 00H

_c$ &#x3D; -12       ; size &#x3D; 4
_b$ &#x3D; -8        ; size &#x3D; 4
_a$ &#x3D; -4        ; size &#x3D; 4
_f1    PROC
       push     ebp
       mov      ebp, esp
       sub      esp, 12
       mov      DWORD PTR _a$[ebp], 1
       mov      DWORD PTR _b$[ebp], 2
       mov      DWORD PTR _c$[ebp], 3
       mov      esp, ebp
       pop      ebp
       ret      0
_f1    ENDP

_c$ &#x3D; -12       ; size &#x3D; 4
_b$ &#x3D; -8        ; size &#x3D; 4
_a$ &#x3D; -4        ; size &#x3D; 4
_f2    PROC
       push     ebp
       mov      ebp, esp
       sub      esp, 12
       mov      eax, DWORD PTR _c$[ebp]
       push     eax
       mov      ecx, DWORD PTR _b$[ebp]
       push     ecx
       mov      edx, DWORD PTR _a$[ebp]
       push     edx
       push     OFFSET $SG2752 ; ‚Äô%d, %d, %d‚Äô
       call     DWORD PTR __imp__printf
       add      esp, 16
       mov      esp, ebp
       pop      ebp
       ret      0
_f2    ENDP

main   PROC
       push     ebp
       mov      ebp, esp
       call     _f1
       call     _f2
       xor      eax, eax
       pop      ebp
       ret      0
_main  ENDP<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Âú®Ëøô‰∏™Áâπ‰æãÈáåÔºåÁ¨¨‰∫å‰∏™ÂáΩÊï∞Âú®Á¨¨‰∏Ä‰∏™ÂáΩÊï∞‰πãÂêéÊâßË°åÔºåËÄåÁ¨¨‰∫å‰∏™ÂáΩÊï∞ÂèòÈáèÁöÑÂú∞ÂùÄÂíåSPÁöÑÂÄºÂèà‰∏éÁ¨¨‰∏Ä‰∏™ÂáΩÊï∞ÁöÑÊÉÖÂÜµÁõ∏Âêå„ÄÇÊâÄ‰ª•ÔºåÁõ∏ÂêåÂú∞ÂùÄÁöÑÂèòÈáèËé∑ÂæóÁöÑÂÄºÁõ∏Âêå„ÄÇ</p>
<p>ÊÄªËÄåË®Ä‰πãÔºåÂú®ËøêË°åÁ¨¨‰∫å‰∏™ÂáΩÊï∞Êó∂ÔºåÊ†à‰∏≠ÁöÑÊâÄÊúâÂÄºÔºàÂç≥ÂÜÖÂ≠ò‰∏≠ÁöÑÂçïÂÖÉÔºâÂèóÂâç‰∏Ä‰∏™ÂáΩÊï∞ÁöÑÂΩ±ÂìçÔºåËÄåËé∑Âæó‰∫ÜÂâç‰∏Ä‰∏™ÂáΩÊï∞ÁöÑÂèòÈáèÁöÑÂÄº„ÄÇ‰∏•Ê†ºÂú∞ËØ¥ÔºåËøô‰∫õÂú∞ÂùÄÁöÑÂÄº‰∏çÊòØÈöèÊú∫ÂÄºÔºåËÄåÊòØÂèØÈ¢ÑÊµãÁöÑ‰º™ÈöèÊú∫ÂÄº„ÄÇ</p>
<h3 id="problems-2"><a class="markdownIt-Anchor" href="#problems-2"></a> Problems</h3>
<h4 id="51"><a class="markdownIt-Anchor" href="#51"></a> 5.1</h4>
<p>Â¶ÇÊûú‰ΩøÁî®MSVCÁºñËØë„ÄÅËøêË°å‰∏ãÂàóÁ®ãÂ∫èÔºåÂ∞Ü‰ºöÊâìÂç∞Âá∫3‰∏™Êï¥Êï∞„ÄÇËøô‰∫õÊï∞ÂÄºÊù•Ëá™Âì™ÈáåÔºüÂ¶ÇÊûú‰ΩøÁî®MSVCÁöÑ‰ºòÂåñÈÄâÈ°π‚Äú/Ox‚ÄùÔºåÁ®ãÂ∫èÂèà‰ºöÂú®Â±èÂπï‰∏äËæìÂá∫‰ªÄ‰πàÔºü‰∏∫‰ªÄ‰πàGCCÁöÑÊÉÖÂÜµÂÆåÂÖ®‰∏çÂêåÔºü</p>
<pre class="line-numbers language-none"><code class="language-none">#include &lt;stdio.h&gt;

int main() 
&#123;
         printf (&quot;%d, %d, %d\n&quot;);

         return 0;
&#125;;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Â¶ÇÊûúÊú™ÂêØÁî®MSVCÁöÑ‰ºòÂåñÁºñËØëÂäüËÉΩÔºåÁ®ãÂ∫èÊòæÁ§∫ÁöÑÊï∞Â≠óÂàÜÂà´ÊòØEBPÁöÑÂÄº„ÄÅRAÂíåargc„ÄÇÂú®ÂëΩ‰ª§Ë°å‰∏≠ÊâßË°åÁõ∏Â∫îÁöÑÁ®ãÂ∫èÂç≥ÂèØËøõË°åÈ™åËØÅ„ÄÇ</p>
<p>Â¶ÇÊûúÂêØÁî®‰∫ÜMSVCÁöÑ‰ºòÂåñÁºñËØëÂäüËÉΩÔºåÁ®ãÂ∫èÊòæÁ§∫ÁöÑÊï∞Â≠óÂàÜÂà´Êù•Ëá™ÔºöËøîÂõûÂú∞ÂùÄRA„ÄÅargcÂíåÊï∞ÁªÑargvÔºªÔºΩ„ÄÇ</p>
<p>GCC‰ºöÁªômain() ÂáΩÊï∞ÁöÑÂÖ•Âè£ÂàÜÈÖç16Â≠óËäÇÁöÑÂú∞ÂùÄÁ©∫Èó¥ÔºåÊâÄ‰ª•ËæìÂá∫ÂÜÖÂÆπ‰ºöÊúâ‰∏çÂêå„ÄÇ</p>
<h4 id="52"><a class="markdownIt-Anchor" href="#52"></a> 5.2</h4>
<p>Á≠îÔºöÊâìÂç∞Êó∂Èó¥</p>
<h2 id="chap6-printfÂáΩÊï∞‰∏éÂèÇÊï∞‰º†ÈÄí"><a class="markdownIt-Anchor" href="#chap6-printfÂáΩÊï∞‰∏éÂèÇÊï∞‰º†ÈÄí"></a> Chap6 printf()ÂáΩÊï∞‰∏éÂèÇÊï∞‰º†ÈÄí</h2>
<p>ÊºîÁ§∫Á®ãÂ∫è</p>
<pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"a=%d,b=%d,c=%d"</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span> 
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Áî®<code> g++ -m32 -o 1 1.c</code>ËøõË°åÁºñËØëÊàñËÄÖ‰ΩøÁî®<code>MSVS</code>Â∑•ÂÖ∑ÈìæËøõË°åÁºñËØëÔºåË∑üÈöèÊú¨‰π¶ÁöÑËäÇÂ•èÔºåÈÖçÁΩÆ‰∏Ä‰∏ã<code>MSVS</code>ÁöÑÁéØÂ¢É</p>
<p><a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/cpp/build/building-on-the-command-line?view=msvc-170#download-and-install-the-tools">ÈÄöËøáÂëΩ‰ª§Ë°å‰ΩøÁî® Microsoft C++ Â∑•ÂÖ∑ÈõÜ | Microsoft Learn</a></p>
<p>È¶ñÂÖàÂ∞Ü<code>Microsoft Visual Studio\2022\Community\VC\Auxiliary\Build</code>Âä†ÂÖ•ÁéØÂ¢ÉÂèòÈáè</p>
<p>ÂëΩ‰ª§Ë°åËæìÂÖ•<code>vcvarsall.bat x86</code></p>
<p>ÁÑ∂Âêé<code>cl 1.cpp</code></p>
<hr />
<p>MSVSÂ∑•ÂÖ∑Èìæ‰∏Ä‰∫õÂ∏∏Áî®ÁöÑÊåá‰ª§</p>
<p><code>cl /Fa 1.c</code>ÁîüÊàê‰∏çÂ∏¶Ê≥®ÈáäÁöÑÊ±áÁºñ‰ª£Á†Å</p>
<p><code>cl /FAs 1.c</code>ÁîüÊàêÂ∏¶Ê≥®ÈáäÁöÑÊ±áÁºñ‰ª£Á†Å,ÁîüÊàê1.asm</p>
<p><code>dumpbin /all example.obj</code>ÊòæÁ§∫ÁõÆÊ†áÊñá‰ª∂‰∏≠ÁöÑÊâÄÊúâ‰ø°ÊÅØÔºåÂåÖÊã¨ÊÆµÂÜÖÂÆπ„ÄÅÁ¨¶Âè∑Ë°®ÂíåÈáçÂÆö‰Ωç‰ø°ÊÅØ„ÄÇ</p>
<p>/c ‰ª£Ë°®Âè™ÁºñËØë‰∏çÈìæÊé•„ÄÇ</p>
<p>/I ÊåáÂÆöÂ§¥Êñá‰ª∂ÁöÑÁõÆÂΩï</p>
<p>/C Âú®ÁºñËØëÊúüÈó¥‰øùÁïô‰ª£Á†ÅÊ≥®ÈáäÔºåËøôÈáåÂíå/IËøûÂú®‰∏ÄËµ∑‰ΩøÁî®Ôºå/IC</p>
<p>È¶ñÂÖà‰ªãÁªç‰∏Ä‰∏™Ê¶ÇÂøµÔºåVC‰∏≠Êúâ‰∏™PDBÊñá‰ª∂ÔºåÂÖ®Áß∞ÊòØProgram DatabaseÔºåÁî®Êù•Â≠òÊîæÁ®ãÂ∫è‰ø°ÊÅØÁöÑÂ∞èÁöÑ<a target="_blank" rel="noopener" href="http://lib.csdn.net/base/14">Êï∞ÊçÆÂ∫ì</a>Êñá‰ª∂„ÄÇ</p>
<p>ÁºñËØëDebugÁâàÊú¨Êó∂ÔºåË∞ÉËØï‰ø°ÊÅØÈúÄË¶Å‰øùÁïôÔºåÊàë‰ª¨ÂèØ‰ª•ÈÄâÊã©Áõ¥Êé•Â∞ÜË∞ÉËØï‰ø°ÊÅØÂÜôÂà∞.objÊñá‰ª∂‰∏≠ÔºåÊàñËÄÖÂ≠òÂà∞.pdbÊñá‰ª∂‰∏≠„ÄÇ</p>
<p>/Z7 ‰∏ç‰∫ßÁîü.pdbÊñá‰ª∂ÔºåÂ∞ÜÊâÄÊúâË∞ÉËØï‰ø°ÊÅØÂ≠òÂÖ•.objÊñá‰ª∂‰∏≠</p>
<p>/ZiÂíå/ZI ÈÉΩ‰∫ßÁîü.pdbÊñá‰ª∂Ôºå‰∏çËøá/ZIÊîØÊåÅ&quot;ÁºñËæëÁªßÁª≠Ë∞ÉËØï&quot;ÂäüËÉΩ, (the edit and continue feature), Áúã‰∏äÂéªÊõ¥ÈÖ∑Ôºå‰ΩÜÊòØÊàë‰ªéÊù•Ê≤°ÊúâÁî®ËøáËøô‰∏™ÂäüËÉΩ„ÄÇ</p>
<p>/ZIÊúâ‰∏Ä‰∫õËæπÈôÖÊïàÂ∫îÔºå‰ºöÁ¶ÅÊ≠¢#pragma optmize Êåá‰ª§Ôºå‰πü‰∏çËÉΩÂíå/clr‰∏ÄËµ∑Áî®„ÄÇ</p>
<p>/nologo- Â∑≤ÁªèÊó†ÊïàÔºåËá™Â∑±ÁîüÊàêÂëΩ‰ª§Ë°åÁöÑÊó∂ÂÄôÔºåÊ≤°ÂøÖË¶ÅÁî®‰∫Ü„ÄÇ</p>
<p>/W3 ‰πü‰∏≠Ë≠¶ÂëäÁ∫ßÂà´ÔºåVCÊèê‰æõ‰∫ÜÂæàÂ§öË≠¶ÂëäÁ∫ßÂà´ÔºåÂèÇËÄÉ<a target="_blank" rel="noopener" href="http://msdn.microsoft.com/en-us/library/vstudio/thxezb7y.aspx">http://msdn.microsoft.com/en-us/library/vstudio/thxezb7y.aspx</a></p>
<p>Ëá™Â∑±ÁºñËØëÁöÑËØùÔºåÁõ¥Êé•Áî®/WallÊúÄÂ•Ω„ÄÇ</p>
<p>/WX- ‰∏çÂ§™ÊòéÁôΩ‰∏∫‰ªÄ‰πàÊúâ - Âè∑ÔºåÔºà‰º∞ËÆ°ÊòØÂíå:NOÁöÑÊÑèÊÄùÁõ∏ÂêåÔºå‰πüÂ∞±ÊòØ‰∏çÂêØÁî®ËØ•ÂäüËÉΩÔºâÔºå /WXÁöÑÊÑèÊÄùÊòØÂ∞ÜwarningËΩ¨ÂèòÊàêerrorÔºåËøôÊ†∑Âº∫Ëø´Ê∂àÈô§ÊâÄÊúâÁöÑwarningÔºåÂ¶ÇÊûúÂíå/Wall‰∏ÄËµ∑‰ΩøÁî®ÔºåÈÇ£ÊòØÊúÄÂ•ΩÁöÑ„ÄÇ</p>
<p>/sdl ÊòØÂØπ‰ª£Á†ÅËøõË°åÂÆâÂÖ®Ê£ÄÊü•ÔºåÂ¶ÇÊûúÂèëÁé∞Áõ∏ÂÖ≥Ë≠¶ÂëäÔºåËΩ¨ÂèòÊàêÈîôËØØËæìÂá∫</p>
<p>/Od Á¶ÅÊ≠¢‰ºòÂåñ</p>
<p>/Oy- Á¶ÅÊ≠¢ËØ•ÈÄâÈ°πÔºåËØ•ÈÄâÈ°πÂ¶ÇÊûúÊ≤°Êúâ - Âè∑ÔºåÂàô‰ºöÂú®x86‰∏äÁºñËØëÊó∂ÂøΩÁï•frame-pointerÔºåËµ∑Âà∞Âä†ÈÄüÁ®ãÂ∫èÁöÑ‰ΩúÁî®„ÄÇ frame-pointerÔºåÊàëÊöÇÊó∂‰∏çÁü•ÈÅìÊòØÂï•„ÄÇ</p>
<p>/D È¢ÑÂ§ÑÁêÜÂÆö‰πâÔºåÂêéÈù¢ÂèØ‰ª•Ë∑ü‰∏çÂêåÁöÑÂèÇÊï∞ÈÉΩÊòØÂÆèÂïäÔºåÊØîÂ¶Ç<br />
/Gm ÂêØÁî®ÊúÄÂ∞èÂåñÈáçÊñ∞ÁºñËØë, VCÁî®.idb‰øùÁïô‰∫Ü‰∏äÊ¨°ÁºñËØëÁöÑÁºìÂ≠ò‰ø°ÊÅØÔºåÂåÖÊã¨Êñá‰ª∂‰æùËµñÂÖ≥Á≥ª„ÄÇ‰∏ãÊ¨°ÁºñËØëÊó∂ÂèØ‰ª•‰ΩøÁî®.idbÊñá‰ª∂Áî®Êù•Ê£ÄÊü•ÔºåË∑≥Ëøá‰∏çÈúÄË¶ÅÈáçÊñ∞ÁºñËØëÁöÑÊñá‰ª∂„ÄÇ</p>
<p>ÂÖ∑‰ΩìÂèÇËßÅ:</p>
<p><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/cpp/build/reference/compiler-options?view=msvc-170&amp;redirectedfrom=MSDN">MSVC Compiler Options | Microsoft Learn</a></p>
<h3 id="x86"><a class="markdownIt-Anchor" href="#x86"></a> x86</h3>
<p>MSVSÁºñËØëÂæóÂà∞ÁöÑÊ±áÁºñÊåá‰ª§Â¶Ç‰∏ã</p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">_TEXT	SEGMENT
_main	PROC

; 3    : &#123;

	push	ebp
	mov	ebp, esp

; 4    :     printf(&quot;a&#x3D;%d,b&#x3D;%d,c&#x3D;%d&quot;,1,2,3);

	push	3
	push	2
	push	1
	push	OFFSET $SG9695
	call	_printf
	add	esp, 16					; 00000010H

; 5    :     return 0; 

	xor	eax, eax

; 6    : &#125;

	pop	ebp
	ret	0
_main	ENDP
_TEXT	ENDS<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ÂèØ‰ª•ÁúãÂà∞<code>printf()</code>ÂáΩÊï∞ÁöÑÂèÇÊï∞ÊòØÈÄÜÂ∫èÂ≠òÂÖ•Ê†à‰∏≠ÔºåÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞Âú®ÊúÄÂêéÂÖ•Ê†à</p>
<p>Âú®<code>32</code>‰Ωç‰∏ãÔºå32‰ΩçÂú∞ÂùÄÊåáÈíàÂíåintÁ±ªÂûãÊï∞ÊçÆÈÉΩÂç†ÊçÆ<code>32‰Ωç</code>Âç≥<code>4Â≠óËäÇ</code>ÁöÑÁ©∫Èó¥ÔºåÂõ†Ê≠§4‰∏™ÂèÇÊï∞ÊÄªÂÖ±Âç†Áî®<code>16</code>Â≠óËäÇÁöÑÂ≠òÂÇ®Á©∫Èó¥</p>
<p>Âõ†Ê≠§Âú®Ë∞ÉÁî®ÂáΩÊï∞‰πãÂêéÔºå‚ÄúADD ESP, X‚ÄùÊåá‰ª§‰øÆÊ≠£ESPÂØÑÂ≠òÂô®‰∏≠ÁöÑÊ†àÊåáÈíà„ÄÇÈÄöÂ∏∏ÊÉÖÂÜµ‰∏ãÔºåÊàë‰ª¨ÂèØ‰ª•ÈÄöËøácall‰πãÂêéÁöÑËøôÊù°Êåá‰ª§Âà§Êñ≠ÂèÇÊï∞ÁöÑÊï∞ÈáèÔºö<code>ÂèòÈáèÊÄªÊï∞Ôºù*X*√∑4„ÄÇ</code>(‰ªÖÈÄÇÁî®‰∫éË∞ÉÁî®Á∫¶ÂÆö‰∏∫<code>cdecl</code>ÁöÑÁ®ãÂ∫è)</p>
<p>Â¶ÇÊûúÊüê‰∏™Á®ãÂ∫èËøûÁª≠Âú∞Ë∞ÉÁî®Â§ö‰∏™ÂáΩÊï∞Ôºå‰∏îË∞ÉÁî®ÂáΩÊï∞ÁöÑÊåá‰ª§‰πãÈó¥‰∏çÂ§πÊùÇÂÖ∂‰ªñÊåá‰ª§ÔºåÈÇ£‰πàÁºñËØëÂô®ÂèØËÉΩÊääÈáäÊîæÂèÇÊï∞Â≠òÂÇ®Á©∫Èó¥ÁöÑ‚ÄúADD ESP,X‚ÄùÊåá‰ª§ËøõË°åÂêàÂπ∂Ôºå‰∏ÄÊ¨°ÊÄßÂú∞ÈáäÊîæÊâÄÊúâÁ©∫Èó¥</p>
<hr />
<p>‰ΩìÈ™åÁî®<code>onlydbg</code>Âä†ËΩΩËøô‰∏™Á®ãÂ∫è</p>
<p>ËøôÈáåÈúÄË¶ÅÁî®Âà∞debugÁâàÊú¨ÁöÑÁºñËØëÂëΩ‰ª§</p>
<p><code>cl /Z7 /EHsc 1.exe 1.c</code>‰æø‰∫éË∑üË∏™Á®ãÂ∫è</p>
<p>ÊâæÂà∞<code>main</code>ÂáΩÊï∞ÁöÑÊñπÊ≥ï:ÊñπÊ≥ïÂæàÂ§öÔºå‰∏çÁªÜËØ¥‰∫Ü</p>
<p>ÂÖ∑‰ΩìÊìç‰ΩúÊåâ‰π¶‰∏äÊù•</p>
<h2 id="chap7-scanf"><a class="markdownIt-Anchor" href="#chap7-scanf"></a> Chap7 scanf()</h2>
<p>ÊºîÁ§∫Á®ãÂ∫è</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> x<span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Enter X:\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"You Entered: %d\n"</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="x86-2"><a class="markdownIt-Anchor" href="#x86-2"></a> x86</h3>
<p><code>cl /FAs /Z7 2 2.c</code></p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">_DATA	SEGMENT
$SG9696	DB	&#39;Enter X:&#39;, 0aH, 00H
	ORG $+2
$SG9697	DB	&#39;%d&#39;, 00H
	ORG $+1
$SG9698	DB	&#39;You Entered: %d&#39;, 0aH, 00H
_DATA	ENDS
_TEXT	SEGMENT
_x$ &#x3D; -4						; size &#x3D; 4
_main	PROC

; 3    : &#123;

	push	ebp
	mov	ebp, esp
	push	ecx

; 4    :     int x;
; 5    :     printf(&quot;Enter X:\n&quot;);

	push	OFFSET $SG9696
	call	_printf
	add	esp, 4

; 6    :     scanf(&quot;%d&quot;, &amp;x);

	lea	eax, DWORD PTR _x$[ebp]
	push	eax
	push	OFFSET $SG9697
	call	_scanf
	add	esp, 8

; 7    : 
; 8    :     printf(&quot;You Entered: %d\n&quot;, x);

	mov	ecx, DWORD PTR _x$[ebp]
	push	ecx
	push	OFFSET $SG9698
	call	_printf
	add	esp, 8

; 9    :     return 0;

	xor	eax, eax

; 10   : &#125;

	mov	esp, ebp
	pop	ebp
	ret	0
_main	ENDP<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Ê±áÁºñËß£ËØª:</p>
<ul>
<li>
<p>ÂèØ‰ª•ÁúãÂà∞Ôºå<code>scanf()</code>‰º†ÈÄíÁöÑÁ¨¨‰∫å‰∏™ÂèÇÊï∞(eax)ÊòØ‰∏Ä‰∏™ÊåáÂêëÊ†à‰∏≠ÁöÑÊåáÈíàÔºåxÊòØÂ±ÄÈÉ®ÂèòÈáèÔºåÂ≠òÂÇ®Âú®Ê†à‰∏≠„ÄÇÂú®Ê†à‰∏≠ÂàÜÈÖç‰∫Ü4Â≠óËäÇÁ©∫Èó¥ÔºåÂ≠òÂÇ®Â±ÄÈÉ®ÂèòÈáèx</p>
</li>
<li>
<p>**Ê±áÁºñÂÆè_x$ ÔºàÂÖ∂ÂÄº‰∏∫‚àí4Ôºâ**Áî®‰∫éËÆøÈóÆÂ±ÄÈÉ®ÂèòÈáè<em>x</em>ÔºåËÄåEBPÂØÑÂ≠òÂô®Áî®Êù•Â≠òÂÇ®Ê†àÂΩìÂâçÂ∏ßÁöÑÊåáÈíà„ÄÇ</p>
<p>Âú®ÂáΩÊï∞ËøêË°åÁöÑÊúüÈó¥ÔºåEBP‰∏ÄÁõ¥ÊåáÂêëÂΩìÂâçÁöÑÊ†àÂ∏ßÔºàstack frameÔºâ„ÄÇËøôÊ†∑ÔºåÂáΩÊï∞Âç≥ÂèØÈÄöËøá<strong>EBP+offsetÁöÑÊñπÂºèËÆøÈóÆÊú¨Âú∞ÂèòÈáè„ÄÅ‰ª•ÂèäÂ§ñÈÉ®‰º†ÂÖ•ÁöÑÂáΩÊï∞ÂèÇÊï∞</strong>„ÄÇ</p>
<p>ESP‰πüÂèØ‰ª•Áî®Êù•ËÆøÈóÆÊú¨Âú∞ÂèòÈáèÔºåËé∑ÂèñÂáΩÊï∞ÊâÄÈúÄÁöÑËøêË°åÂèÇÊï∞„ÄÇ‰∏çËøá<strong>ESPÁöÑÂÄºÁªèÂ∏∏ÂèëÁîüÂèòÂåñÔºåÁî®Ëµ∑Êù•Âπ∂‰∏çÊñπ‰æø</strong>„ÄÇÂáΩÊï∞Âú®ÂêØÂä®‰πãÂàùÂ∞±‰ºöÂà©Áî®EBPÂØÑÂ≠òÂô®‰øùÂ≠òESPÂØÑÂ≠òÂô®ÁöÑÂÄº„ÄÇËøôÂ∞±ÊòØ‰∏∫‰∫ÜÁ°Æ‰øùÂú®ÂáΩÊï∞ËøêË°åÊúüÈó¥‰øùËØÅEBPÂØÑÂ≠òÂô®Â≠òÂÇ®ÁöÑÂéüÂßãESPÂÄºÂõ∫ÂÆö‰∏çÂèò„ÄÇ</p>
<p>Âú®32‰ΩçÁ≥ªÁªüÈáåÔºåÂÖ∏ÂûãÁöÑÊ†àÂ∏ßÔºàstack frameÔºâÁªìÊûÑÂ¶Ç‰∏ãË°®ÊâÄÁ§∫„ÄÇ</p>
<table>
<thead>
<tr>
<th>‚Ä¶‚Ä¶</th>
<th>‚Ä¶‚Ä¶</th>
</tr>
</thead>
<tbody>
<tr>
<td>EBP-8</td>
<td>Â±ÄÈÉ®ÂèòÈáèÔºÉ2ÔºåIDAÊ†áËÆ∞‰∏∫var_8</td>
</tr>
<tr>
<td>EBP-4</td>
<td>Â±ÄÈÉ®ÂèòÈáèÔºÉ1ÔºåIDAÊ†áËÆ∞‰∏∫var_4</td>
</tr>
<tr>
<td>EBP</td>
<td>EBPÁöÑÂÄº</td>
</tr>
<tr>
<td>EBP+4</td>
<td>ËøîÂõûÂú∞ÂùÄReturn address</td>
</tr>
<tr>
<td>EBP+8</td>
<td>ÂáΩÊï∞ÂèÇÊï∞ÔºÉ1ÔºåIDAÊ†áËÆ∞‰∏∫arg_0</td>
</tr>
<tr>
<td>EBP+0xC</td>
<td>ÂáΩÊï∞ÂèÇÊï∞ÔºÉ2ÔºåIDAÊ†áËÆ∞‰∏∫arg_4</td>
</tr>
<tr>
<td>EBP+0x10</td>
<td>ÂáΩÊï∞ÂèÇÊï∞ÔºÉ3ÔºåIDAÊ†áËÆ∞‰∏∫arg_8</td>
</tr>
<tr>
<td>‚Ä¶‚Ä¶</td>
<td>‚Ä¶‚Ä¶</td>
</tr>
</tbody>
</table>
</li>
<li>
<p><code>scanf()</code>Âú®Ê≠§‰æã‰∏≠Êúâ‰∏§‰∏™ÂèÇÊï∞,Á¨¨‰∏Ä‰∏™ÂèÇÊï∞ÊòØ‰∏Ä‰∏™ÊåáÈíàÔºåÊåáÂêëÂê´Êúâ&quot;%d&quot;ÁöÑÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÔºåÁ¨¨‰∫å‰∏™ÂèÇÊï∞ÊòØÂ±ÄÈÉ®ÂèòÈáè<code>x</code>ÁöÑÂú∞ÂùÄ</p>
<p>‚Äúlea eax, DWORD PTR _x$[ebp]‚ÄùÊåá‰ª§Â∞ÜÂèòÈáè<em>x</em>ÁöÑÂú∞ÂùÄÊîæÂÖ•EAXÂØÑÂ≠òÂô®„ÄÇ</p>
<p>Âú®Ê≠§Â§Ñ<code>LEA</code>‰ºöÂ∞Ü<code>EBP</code>ÂØÑÂ≠òÂô®ÂÄº‰∏éÂÆè_x$Ê±ÇÂíå,ÁÑ∂ÂêéÂ∞ÜËøô‰∏™ÁªìÊûúÂ≠òÂÇ®Âà∞<code>EAX</code>ÔºåÁÑ∂ÂêéÊää<code>EAX</code>ÂØÑÂ≠òÂô®ÁöÑÂÄºÈÄÅÂÖ•Ê†à‰∏≠(Â∞±ÊòØÊääxÁöÑÂú∞ÂùÄÈÄÅÂÖ•EAXÂØÑÂ≠òÂô®)</p>
</li>
<li>
<p>ËÄåÂêéË∞ÉÁî®<code>printf()</code>ÂáΩÊï∞ÔºåÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞Âç≥Ê†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÁöÑÊåáÈíà</p>
<p>Á¨¨‰∫å‰∏™ÂèÇÊï∞ÊòØ<code>mov ecx,[ebp-4]</code>Èó¥Êé•ÂèñÂÄºÔºå‰º†ÈÄíÁªôecxÁöÑÂÄºÊòØ<code>ebp-4</code>ÊåáÂêëÁöÑÂú∞ÂùÄÁöÑÂÄºÔºåÂç≥ÂèòÈáèxÁöÑÂÄº</p>
</li>
</ul>
<hr />
<p>Áî®<code>onlydbg</code>Âä®ÊÄÅË∑üË∏™Ëøô‰∏™ËøáÁ®ãÔºåÂÖ∑‰Ωì‰π¶‰∏äÊúâ</p>
<ul>
<li>Ë∞ÉËØïÂèØ‰ª•ÂèëÁé∞ÔºåÊâßË°åÂÆå<code>scanf()</code>ÂáΩÊï∞,<code>EAX</code>Â≠òÂÇ®ÊúâÂáΩÊï∞ÁöÑËøîÂõûÂÄºÔºåÂÖ∂ÂÄºÊòØ<code>scanf()</code>ËØªÂèñÂèÇÊï∞ÁöÑ‰∏™Êï∞</li>
<li>Êàë‰ª¨ÂèØ‰ª•Âú®Ê†à‰∏≠ÊâæÂà∞Â±ÄÈÉ®ÂèòÈáèÁöÑÂú∞ÂùÄÔºåËøõËÄåË∑üË∏™ÂÖ∂ÂÄº</li>
</ul>
<h3 id="ÂÖ®Â±ÄÂèòÈáè"><a class="markdownIt-Anchor" href="#ÂÖ®Â±ÄÂèòÈáè"></a> ÂÖ®Â±ÄÂèòÈáè</h3>
<p>Â¶ÇÊûú‰∏äÊñáÁöÑ<code>x</code>ÊòØÂÖ®Â±ÄÂèòÈáè,‰ºöÊúâ‰ªÄ‰πàÊ†∑ÁöÑÂèòÂåñ</p>
<p>Â∞Ü<code>x</code>ÊîπÊàêÂÖ®Â±ÄÂèòÈáè</p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">_DATA	SEGMENT
$SG9696	DB	&#39;Enter X:&#39;, 0aH, 00H
	ORG $+2
$SG9697	DB	&#39;%d&#39;, 00H
	ORG $+1
$SG9698	DB	&#39;You Entered: %d&#39;, 0aH, 00H
_DATA	ENDS
_TEXT	SEGMENT
_main	PROC

; 4    : &#123;

	push	ebp
	mov	ebp, esp

; 5    :    
; 6    :     printf(&quot;Enter X:\n&quot;);

	push	OFFSET $SG9696
	call	_printf
	add	esp, 4

; 7    :     scanf(&quot;%d&quot;, &amp;x);

	push	OFFSET _x
	push	OFFSET $SG9697
	call	_scanf
	add	esp, 8

; 8    : 
; 9    :     printf(&quot;You Entered: %d\n&quot;, x);

	mov	eax, DWORD PTR _x
	push	eax
	push	OFFSET $SG9698
	call	_printf
	add	esp, 8

; 10   :     return 0;

	xor	eax, eax

; 11   : &#125;

	pop	ebp
	ret	0
_main	ENDP
_TEXT	ENDS<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>
<p>ÂèØ‰ª•ÂèëÁé∞<code>x</code>ÁöÑÂ≠òÂÇ®Á©∫Èó¥‰∏çÂÜçÁî±Ê†à‰∏≠Â≠òÂÇ®,ËÄåÊòØÂú®Êï∞ÊçÆÊÆµ(Áî±‰∫éÊ≤°ÁªôxËµãÂÄºÔºåÁºñËØëÂô®Ëá™Âä®‰ºòÂåñ‰∏∫bssÊÆµ(‰∏çÂç†ÊçÆÁ©∫Èó¥))</p>
</li>
<li>
<p>Â¶ÇÊûúÂØπ‰∏äËø∞Ê∫ê‰ª£Á†ÅÁ®çÂÅöÊîπÂä®ÔºåÂä†‰∏äÂèòÈáèÂàùÂßãÂåñÁöÑÊåá‰ª§Ôºö</p>
<pre class="line-numbers language-none"><code class="language-none">int x&#x3D;10; &#x2F;&#x2F;ËÆæÁΩÆÈªòËÆ§ÂÄº<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>ÈÇ£‰πàÂØπÂ∫îÁöÑ‰ª£Á†Å‰ºöÂèò‰∏∫Ôºö</p>
<pre class="line-numbers language-none"><code class="language-none">_DATA   SEGMENT
_x      DD      0aH
...<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>‰∏äËø∞Êåá‰ª§Â∞ÜÂàùÂßãÂåñx„ÄÇÂÖ∂‰∏≠DD‰ª£Ë°®DWORDÔºåË°®Á§∫<em>x</em>ÊòØ32‰ΩçÁöÑÊï∞ÊçÆ„ÄÇ</p>
<p>Ëã•Âú®IDAÈáåÊâìÂºÄÂØπxËøõË°åÂàùÂßãÂåñÁöÑÂèØÊâßË°åÊñá‰ª∂ÔºåÊàë‰ª¨Â∞Ü‰ºöÁúãÂà∞Âú®Êï∞ÊçÆÊÆµÁöÑÂºÄÂ§¥ÈÉ®ÂàÜÁúãÂà∞ÂàùÂßãÂåñÂèòÈáè<em>x</em>„ÄÇÁ¥ßÈöèÂÖ∂ÂêéÁöÑÁ©∫Èó¥Áî®‰∫éÂ≠òÂÇ®Êú¨‰æã‰∏≠ÁöÑÂ≠óÁ¨¶‰∏≤„ÄÇ</p>
<p>Áî®IDAÊâìÂºÄ7.2ËäÇÈáåÈÇ£‰∏™‰∏çÂàùÂßãÂåñÂèòÈáè<em>x</em>ÁöÑ‰æãÂ≠êÔºåÈÇ£‰πàÂ∞Ü‰ºöÁúã</p>
<p>ÊúâÂæàÂ§öÂ∏¶‚ÄúÔºü‚ÄùÊ†áËÆ∞ÁöÑÂèòÈáèÔºåËøôÊòØÊú™ÂàùÂßãÂåñÁöÑ<em>x</em>ÂèòÈáèÁöÑÊ†áËÆ∞„ÄÇËøôÊÑèÂë≥ÁùÄÂú®Á®ãÂ∫èÂä†ËΩΩÂà∞ÂÜÖÂ≠ò‰πãÂêéÔºåÊìç‰ΩúÁ≥ªÁªüÂ∞Ü‰∏∫Ëøô‰∫õÂèòÈáèÂàÜÈÖçÁ©∫Èó¥„ÄÅÂπ∂Â°´ÂÖ•Êï∞Â≠óÈõ∂„ÄÇ‰ΩÜÊòØÂú®ÂèØÊâßË°åÊñá‰ª∂ÈáåÔºåËøô‰∫õÊú™ÂàùÂßãÂåñÁöÑÂèòÈáè‰∏çÂç†Áî®ÂÜÖÂ≠òÁ©∫Èó¥„ÄÇ‰∏∫‰∫ÜÊñπ‰æø‰ΩøÁî®Â∑®ÂûãÊï∞ÁªÑ‰πãÁ±ªÁöÑÂ§ßÂûãÊï∞ÊçÆÔºå‰∫∫‰ª¨ÂàªÊÑèÂÅö‰∫ÜËøôÁßçËÆæÂÆö„ÄÇ</p>
</li>
</ul>
<h3 id="problem"><a class="markdownIt-Anchor" href="#problem"></a> Problem</h3>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>

<span class="token keyword">void</span> <span class="token function">alter_string</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>s<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
        <span class="token function">strcpy</span> <span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token string">"Goodbye!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">printf</span> <span class="token punctuation">(</span><span class="token string">"Result: %s\n"</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
        <span class="token function">alter_string</span> <span class="token punctuation">(</span><span class="token string">"Hello, world!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Âú®<code>win</code>ÂèØËøêË°åÔºåÂõ†‰∏∫sÊòØÂú®dataÊÆµ</p>
<p>ËÄåÂú®<code>linux</code>‰∏çÂèØËøêË°åÔºåsÂ≠òÂÇ®Âú®<code>rodata</code>ÊÆµÔºå‰∏çÂèØÂÜô</p>
<h2 id="chap8-ÂèÇÊï∞Ëé∑Âèñ"><a class="markdownIt-Anchor" href="#chap8-ÂèÇÊï∞Ëé∑Âèñ"></a> Chap8 ÂèÇÊï∞Ëé∑Âèñ</h2>
<p>main()ÂáΩÊï∞Êää3‰∏™Êï∞Â≠óÊé®ÈÄÅÂÖ•Ê†àÔºåÁÑ∂ÂêéË∞ÉÁî®‰∫Üf(int, int, int)„ÄÇË¢´Ë∞ÉÁî®ÊñπÂáΩÊï∞f()ÈÄöËøá_a<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mn>8</mn><mtext>‰∏ÄÁ±ªÁöÑÊ±áÁºñÂÆèËÆøÈóÆÊâÄÈúÄÂèÇÊï∞‰ª•ÂèäÂáΩÊï∞Ëá™ÂÆö‰πâÁöÑÂ±ÄÈÉ®ÂèòÈáè„ÄÇÂè™‰∏çËøá‰ªéË¢´Ë∞ÉÁî®ÊñπÂáΩÊï∞ÁöÑÊï∞ÊçÆÊ†àÁöÑËßíÂ∫¶Êù•ÁúãÔºåÂ§ñÈÉ®ÂèÇËÄÉÁöÑÂÅèÁßªÈáèÊòØÊ≠£ÂÄºÔºåËÄåÂ±ÄÈÉ®ÂèòÈáèÁöÑÂÅèÁßªÈáèÊòØË¥üÂÄº„ÄÇÂèØËßÅÔºåÂΩìÈúÄË¶ÅËÆøÈóÆÊ†àÂ∏ßÔºà</mtext><mi>s</mi><mi>t</mi><mi>a</mi><mi>c</mi><mi>k</mi><mi>f</mi><mi>r</mi><mi>a</mi><mi>m</mi><mi>e</mi><mtext>Ôºâ‰ª•Â§ñÁöÑÊï∞ÊçÆÊó∂ÔºåË¢´Ë∞ÉÁî®ÊñπÂáΩÊï∞ÂèØÊääÊ±áÁºñÂÆèÔºà‰æã</mtext><msub><mtext>Â¶Ç</mtext><mi>a</mi></msub></mrow><annotation encoding="application/x-tex">=8‰∏ÄÁ±ªÁöÑÊ±áÁºñÂÆèËÆøÈóÆÊâÄÈúÄÂèÇÊï∞‰ª•ÂèäÂáΩÊï∞Ëá™ÂÆö‰πâÁöÑÂ±ÄÈÉ®ÂèòÈáè„ÄÇÂè™‰∏çËøá‰ªéË¢´Ë∞ÉÁî®ÊñπÂáΩÊï∞ÁöÑÊï∞ÊçÆÊ†àÁöÑËßíÂ∫¶Êù•ÁúãÔºåÂ§ñÈÉ®ÂèÇËÄÉÁöÑÂÅèÁßªÈáèÊòØÊ≠£ÂÄºÔºåËÄåÂ±ÄÈÉ®ÂèòÈáèÁöÑÂÅèÁßªÈáèÊòØË¥üÂÄº„ÄÇÂèØËßÅÔºåÂΩìÈúÄË¶ÅËÆøÈóÆÊ†àÂ∏ßÔºàstack frameÔºâ‰ª•Â§ñÁöÑÊï∞ÊçÆÊó∂ÔºåË¢´Ë∞ÉÁî®ÊñπÂáΩÊï∞ÂèØÊääÊ±áÁºñÂÆèÔºà‰æãÂ¶Ç_a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord">8</span><span class="mord cjk_fallback">‰∏Ä</span><span class="mord cjk_fallback">Á±ª</span><span class="mord cjk_fallback">ÁöÑ</span><span class="mord cjk_fallback">Ê±á</span><span class="mord cjk_fallback">Áºñ</span><span class="mord cjk_fallback">ÂÆè</span><span class="mord cjk_fallback">ËÆø</span><span class="mord cjk_fallback">ÈóÆ</span><span class="mord cjk_fallback">ÊâÄ</span><span class="mord cjk_fallback">ÈúÄ</span><span class="mord cjk_fallback">ÂèÇ</span><span class="mord cjk_fallback">Êï∞</span><span class="mord cjk_fallback">‰ª•</span><span class="mord cjk_fallback">Âèä</span><span class="mord cjk_fallback">ÂáΩ</span><span class="mord cjk_fallback">Êï∞</span><span class="mord cjk_fallback">Ëá™</span><span class="mord cjk_fallback">ÂÆö</span><span class="mord cjk_fallback">‰πâ</span><span class="mord cjk_fallback">ÁöÑ</span><span class="mord cjk_fallback">Â±Ä</span><span class="mord cjk_fallback">ÈÉ®</span><span class="mord cjk_fallback">Âèò</span><span class="mord cjk_fallback">Èáè</span><span class="mord cjk_fallback">„ÄÇ</span><span class="mord cjk_fallback">Âè™</span><span class="mord cjk_fallback">‰∏ç</span><span class="mord cjk_fallback">Ëøá</span><span class="mord cjk_fallback">‰ªé</span><span class="mord cjk_fallback">Ë¢´</span><span class="mord cjk_fallback">Ë∞É</span><span class="mord cjk_fallback">Áî®</span><span class="mord cjk_fallback">Êñπ</span><span class="mord cjk_fallback">ÂáΩ</span><span class="mord cjk_fallback">Êï∞</span><span class="mord cjk_fallback">ÁöÑ</span><span class="mord cjk_fallback">Êï∞</span><span class="mord cjk_fallback">ÊçÆ</span><span class="mord cjk_fallback">Ê†à</span><span class="mord cjk_fallback">ÁöÑ</span><span class="mord cjk_fallback">Ëßí</span><span class="mord cjk_fallback">Â∫¶</span><span class="mord cjk_fallback">Êù•</span><span class="mord cjk_fallback">Áúã</span><span class="mord cjk_fallback">Ôºå</span><span class="mord cjk_fallback">Â§ñ</span><span class="mord cjk_fallback">ÈÉ®</span><span class="mord cjk_fallback">ÂèÇ</span><span class="mord cjk_fallback">ËÄÉ</span><span class="mord cjk_fallback">ÁöÑ</span><span class="mord cjk_fallback">ÂÅè</span><span class="mord cjk_fallback">Áßª</span><span class="mord cjk_fallback">Èáè</span><span class="mord cjk_fallback">ÊòØ</span><span class="mord cjk_fallback">Ê≠£</span><span class="mord cjk_fallback">ÂÄº</span><span class="mord cjk_fallback">Ôºå</span><span class="mord cjk_fallback">ËÄå</span><span class="mord cjk_fallback">Â±Ä</span><span class="mord cjk_fallback">ÈÉ®</span><span class="mord cjk_fallback">Âèò</span><span class="mord cjk_fallback">Èáè</span><span class="mord cjk_fallback">ÁöÑ</span><span class="mord cjk_fallback">ÂÅè</span><span class="mord cjk_fallback">Áßª</span><span class="mord cjk_fallback">Èáè</span><span class="mord cjk_fallback">ÊòØ</span><span class="mord cjk_fallback">Ë¥ü</span><span class="mord cjk_fallback">ÂÄº</span><span class="mord cjk_fallback">„ÄÇ</span><span class="mord cjk_fallback">ÂèØ</span><span class="mord cjk_fallback">ËßÅ</span><span class="mord cjk_fallback">Ôºå</span><span class="mord cjk_fallback">ÂΩì</span><span class="mord cjk_fallback">ÈúÄ</span><span class="mord cjk_fallback">Ë¶Å</span><span class="mord cjk_fallback">ËÆø</span><span class="mord cjk_fallback">ÈóÆ</span><span class="mord cjk_fallback">Ê†à</span><span class="mord cjk_fallback">Â∏ß</span><span class="mord cjk_fallback">Ôºà</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mord mathnormal">a</span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">a</span><span class="mord mathnormal">m</span><span class="mord mathnormal">e</span><span class="mord cjk_fallback">Ôºâ</span><span class="mord cjk_fallback">‰ª•</span><span class="mord cjk_fallback">Â§ñ</span><span class="mord cjk_fallback">ÁöÑ</span><span class="mord cjk_fallback">Êï∞</span><span class="mord cjk_fallback">ÊçÆ</span><span class="mord cjk_fallback">Êó∂</span><span class="mord cjk_fallback">Ôºå</span><span class="mord cjk_fallback">Ë¢´</span><span class="mord cjk_fallback">Ë∞É</span><span class="mord cjk_fallback">Áî®</span><span class="mord cjk_fallback">Êñπ</span><span class="mord cjk_fallback">ÂáΩ</span><span class="mord cjk_fallback">Êï∞</span><span class="mord cjk_fallback">ÂèØ</span><span class="mord cjk_fallback">Êää</span><span class="mord cjk_fallback">Ê±á</span><span class="mord cjk_fallback">Áºñ</span><span class="mord cjk_fallback">ÂÆè</span><span class="mord cjk_fallback">Ôºà</span><span class="mord cjk_fallback">‰æã</span><span class="mord"><span class="mord cjk_fallback">Â¶Ç</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>Ôºâ‰∏éEBPÂØÑÂ≠òÂô®ÁöÑÂÄºÁõ∏Âä†Ôºå‰ªéËÄåÊ±ÇÂæóÊâÄÈúÄÂú∞ÂùÄ„ÄÇ</p>
<p>ÂΩìÂèòÈáè<em>a</em>ÁöÑÂÄºÂ≠òÂÖ•EAXÂØÑÂ≠òÂô®‰πãÂêéÔºåf()ÂáΩÊï∞ÈÄöËøáÂêÑÂèÇÊï∞ÁöÑÂú∞ÂùÄ‰æùÊ¨°ËøõË°å‰πòÊ≥ïÂíåÂä†Ê≥ïËøêÁÆóÔºåËøêÁÆóÁªìÊûú‰∏ÄÁõ¥Â≠òÂÇ®‰∫éEAXÂØÑÂ≠òÂô®„ÄÇÊ≠§ÂêéEAXÁöÑÂÄºÂ∞±ÂèØ‰ª•Áõ¥Êé•‰Ωú‰∏∫ËøîÂõûÂÄº‰º†ÈÄíÁªôË∞ÉÁî®ÊñπÂáΩÊï∞„ÄÇË∞ÉÁî®ÊñπÂáΩÊï∞main()ÂÜçÊääEAXÁöÑÂÄºÂΩì‰ΩúÂèÇÊï∞‰º†ÈÄíÁªôprintf()ÂáΩÊï∞„ÄÇ</p>
<h2 id="chap9-ËøîÂõûÂÄº"><a class="markdownIt-Anchor" href="#chap9-ËøîÂõûÂÄº"></a> Chap9 ËøîÂõûÂÄº</h2>
<p>Âú®<strong>x86Á≥ª</strong>ÁªüÈáåÔºåË¢´Ë∞ÉÁî®ÊñπÂáΩÊï∞ÈÄöÂ∏∏ÈÄöËøáEA<strong>XÂØÑÂ≠òÂô®ËøîÂõûËøêÁÆóÁªìÊûú</strong>„ÄÇËã•ËøîÂõûÂÄºÂ±û‰∫ébyteÊàñcharÁ±ªÂûãÊï∞ÊçÆÔºåËøîÂõûÂÄºÂ∞Ü<strong>Â≠òÂÇ®‰∫éEAXÂØÑÂ≠òÂô®ÁöÑ‰Ωé8‰Ωç‚Äî‚ÄîALÂØÑÂ≠òÂô®Â≠òÂÇ®ËøîÂõûÂÄº</strong>„ÄÇÂ¶ÇÊûú<strong>ËøîÂõûÂÄºÊòØÊµÆÁÇπfloatÂûãÊï∞ÊçÆÔºåÈÇ£‰πàËøîÂõûÂÄºÂ∞ÜÂ≠òÂÇ®Âú®FPUÁöÑST(0)ÂØÑÂ≠òÂô®</strong>Èáå„ÄÇARMÁ≥ªÁªüÁöÑÊÉÖÂÜµÁõ∏ÂØπÁÆÄÂçï‰∏Ä‰∫õÔºåÂÆÉÈÄöÂ∏∏‰ΩøÁî®R0ÂØÑÂ≠òÂô®Âõû‰º†ËøîÂõûÂÄº„ÄÇ</p>
<h3 id="voidÁ±ªÂûãÁöÑËøîÂõûÂÄº"><a class="markdownIt-Anchor" href="#voidÁ±ªÂûãÁöÑËøîÂõûÂÄº"></a> voidÁ±ªÂûãÁöÑËøîÂõûÂÄº</h3>
<p>Ë∞ÉÁî®<code>main</code></p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">push envp
push argv
push argc
call main
push eax
call exit<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>‰πüÂ∞±ÊòØ<code>exit(main(argc,argv,envp));</code></p>
<p>Â¶ÇÊûúÂ£∞Êòémain()ÁöÑÊï∞ÊçÆÁ±ªÂûãÊòØvoidÔºåÂàômain()ÂáΩÊï∞‰∏ç‰ºöÊòéÁ°ÆËøîÂõû‰ªª‰ΩïÂÄºÔºàÊ≤°ÊúâreturnÊåá‰ª§Ôºâ„ÄÇ‰∏çËøáÂú®main()ÂáΩÊï∞ÈÄÄÂá∫Êó∂ÔºåEAXÂØÑÂ≠òÂô®Ëøò‰ºöÂ≠òÊúâÊï∞ÊçÆÔºåEAXÂØÑÂ≠òÂô®‰øùÂ≠òÁöÑÊï∞ÊçÆ‰ºöË¢´‰º†ÈÄíÁªôexit()ÂáΩÊï∞„ÄÅÊàê‰∏∫ÂêéËÄÖÁöÑËæìÂÖ•ÂèÇÊï∞„ÄÇÈÄöÂ∏∏EAXÂØÑÂ≠òÂô®ÁöÑÂÄº‰ºöÊòØË¢´Ë∞ÉÁî®ÊñπÂáΩÊï∞ÊÆãÁïôÁöÑÁ°ÆÂÆöÊï∞ÊçÆÔºåÊâÄ‰ª•voidÁ±ªÂûãÂáΩÊï∞ÁöÑËøîÂõûÂÄº„ÄÅ‰πüÂ∞±ÊòØ‰∏ªÂáΩÊï∞ÈÄÄÂá∫‰ª£Á†ÅÂæÄÂæÄÂ±û‰∫é‰º™ÈöèÊú∫Êï∞ÔºàpseudorandomÔºâ</p>
<h4 id="ËøîÂõûÂÄº‰∏∫ÁªìÊûÑ‰ΩìÂûãÊï∞ÊçÆ"><a class="markdownIt-Anchor" href="#ËøîÂõûÂÄº‰∏∫ÁªìÊûÑ‰ΩìÂûãÊï∞ÊçÆ"></a> ËøîÂõûÂÄº‰∏∫ÁªìÊûÑ‰ΩìÂûãÊï∞ÊçÆ</h4>
<p>Ë∞ÉÁî®ÊñπÂáΩÊï∞ÔºàcallerÔºâÂàõÂª∫‰∫ÜÊï∞ÊçÆÁªìÊûÑ„ÄÅÂàÜÈÖç‰∫ÜÊï∞ÊçÆÁ©∫Èó¥ÔºåË¢´Ë∞ÉÁî®ÁöÑÂáΩÊï∞‰ªÖÂêëÁªìÊûÑ‰ΩìÂ°´ÂÖÖÊï∞ÊçÆ„ÄÇÂÖ∂ÊïàÊûúÁ≠âÂêå‰∫éËøîÂõûÁªìÊûÑ‰Ωì„ÄÇ</p>
<h2 id="chap10-ÊåáÈíà"><a class="markdownIt-Anchor" href="#chap10-ÊåáÈíà"></a> Chap10 ÊåáÈíà</h2>
<p>ÊåáÈíàÈÄöÂ∏∏Áî®Êù•Â∏ÆÂä©ÂáΩÊï∞Â§ÑÁêÜËøîÂõûÂÄº„ÄÇÂΩìÂáΩÊï∞ÈúÄË¶ÅËøîÂõûÂ§ö‰∏™ÂÄºÊó∂ÔºåÂÆÉÈÄöÂ∏∏ÈÉΩÊòØÈÄöËøáÊåáÈíà‰º†ÈÄíËøîÂõûÂÄºÁöÑ„ÄÇ</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>

<span class="token keyword">void</span> <span class="token function">f1</span> <span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">*</span>sum<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">*</span>product<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
         <span class="token operator">*</span>sum<span class="token operator">=</span>x<span class="token operator">+</span>y<span class="token punctuation">;</span>
         <span class="token operator">*</span>product<span class="token operator">=</span>x<span class="token operator">*</span>y<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> sum<span class="token punctuation">,</span> product<span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
         <span class="token function">f1</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">,</span> <span class="token number">456</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>sum<span class="token punctuation">,</span> <span class="token operator">&amp;</span>product<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token function">printf</span> <span class="token punctuation">(</span><span class="token string">"sum=%d, product=%d\n"</span><span class="token punctuation">,</span> sum<span class="token punctuation">,</span> product<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">COMM     _product:DWORD
COMM     _sum:DWORD
; ÂÆö‰πâÂ≠óÁ¨¶‰∏≤Â∏∏Èáè $SG2803ÔºåË°®Á§∫Ê†ºÂºèÂåñËæìÂá∫ÁöÑÂ≠óÁ¨¶‰∏≤ &quot;sum&#x3D;%d, product&#x3D;%d\n&quot;
$SG2803 DB     &#39;sum&#x3D;%d, product&#x3D;%d&#39;, 0aH, 00H
; ÂÆö‰πâÂèÇÊï∞Âú®Ê†àÂ∏ß‰∏≠ÁöÑÂÅèÁßªÈáè
_x$ &#x3D; 8             ; ÂèÇÊï∞ _x Âú®Ê†àÂ∏ß‰∏≠ÁöÑÂÅèÁßªÈáèÔºåÂ§ßÂ∞è‰∏∫ 4 Â≠óËäÇ
_y$ &#x3D; 12            ; ÂèÇÊï∞ _y Âú®Ê†àÂ∏ß‰∏≠ÁöÑÂÅèÁßªÈáèÔºåÂ§ßÂ∞è‰∏∫ 4 Â≠óËäÇ
_sum$ &#x3D; 16          ; _sum Âú®Ê†àÂ∏ß‰∏≠ÁöÑÂÅèÁßªÈáèÔºåÂ§ßÂ∞è‰∏∫ 4 Â≠óËäÇ
_product$ &#x3D; 20      ; _product Âú®Ê†àÂ∏ß‰∏≠ÁöÑÂÅèÁßªÈáèÔºåÂ§ßÂ∞è‰∏∫ 4 Â≠óËäÇ
; ÂÆö‰πâ _f1 ÂáΩÊï∞
_f1   PROC
      ; Â∞ÜÂèÇÊï∞ _y ÁöÑÂÄºÂä†ËΩΩÂà∞ ecx ÂØÑÂ≠òÂô®
      mov  ecx, DWORD PTR _y$[esp-4]
      ; Â∞ÜÂèÇÊï∞ _x ÁöÑÂÄºÂä†ËΩΩÂà∞ eax ÂØÑÂ≠òÂô®
      mov  eax, DWORD PTR _x$[esp-4]
      ; ËÆ°ÁÆó _x Âíå _y ÁöÑÂíåÔºåÁªìÊûúÂ≠òÂÇ®Âà∞ edx ÂØÑÂ≠òÂô®
      lea  edx, DWORD PTR [eax+ecx]
      ; ËÆ°ÁÆó _x Âíå _y ÁöÑ‰πòÁßØÔºåÁªìÊûúÂ≠òÂÇ®Âà∞ eax ÂØÑÂ≠òÂô®
      imul eax, ecx;eax&#x3D;eax*ecx
      ; Â∞Ü _product ÁöÑÂú∞ÂùÄÂä†ËΩΩÂà∞ ecx ÂØÑÂ≠òÂô®
      mov  ecx, DWORD PTR _product$[esp-4]
      ; ‰øùÂ≠ò esi ÂØÑÂ≠òÂô®ÁöÑÂÄºÔºå‰∏∫ÂêéÁª≠Êìç‰ΩúÂÅöÂáÜÂ§á
      push esi
      ; Â∞Ü _sum ÁöÑÂú∞ÂùÄÂä†ËΩΩÂà∞ esi ÂØÑÂ≠òÂô®
      mov  esi, DWORD PTR _sum$[esp]
      ; Â∞ÜÂíåÁöÑÁªìÊûúÂ≠òÂÇ®Âà∞ _sum ÊåáÂêëÁöÑ‰ΩçÁΩÆ
      mov  DWORD PTR [esi], edx
      ; Â∞ÜÁßØÁöÑÁªìÊûúÂ≠òÂÇ®Âà∞ _product ÊåáÂêëÁöÑ‰ΩçÁΩÆ
      mov  DWORD PTR [ecx], eax
      ; ÊÅ¢Â§ç esi ÂØÑÂ≠òÂô®ÁöÑÂÄº
      pop  esi
      ; ËøîÂõûÂà∞Ë∞ÉÁî®ËÄÖ
      ret  0
_f1   ENDP

; ÂÆö‰πâ _main ÂáΩÊï∞
_main PROC
      ; Â∞Ü _product ÁöÑÂú∞ÂùÄÂéãÂÖ•Ê†à‰∏≠
      push OFFSET _product
      ; Â∞Ü _sum ÁöÑÂú∞ÂùÄÂéãÂÖ•Ê†à‰∏≠
      push OFFSET _sum
      ; Â∞ÜÂèÇÊï∞ 456 ÂéãÂÖ•Ê†à‰∏≠
      push 456          ; 456 ÁöÑÂçÅÂÖ≠ËøõÂà∂Ë°®Á§∫‰∏∫ 0x1c8
      ; Â∞ÜÂèÇÊï∞ 123 ÂéãÂÖ•Ê†à‰∏≠
      push 123          ; 123 ÁöÑÂçÅÂÖ≠ËøõÂà∂Ë°®Á§∫‰∏∫ 0x7b
      ; Ë∞ÉÁî® _f1 ÂáΩÊï∞
      call _f1
      ; Â∞Ü _product ÁöÑÂÄºÂä†ËΩΩÂà∞ eax ÂØÑÂ≠òÂô®
      mov  eax, DWORD PTR _product
      ; Â∞Ü _sum ÁöÑÂÄºÂä†ËΩΩÂà∞ ecx ÂØÑÂ≠òÂô®
      mov  ecx, DWORD PTR _sum
      ; Â∞Ü _product Âíå _sum ÁöÑÂÄº‰Ωú‰∏∫ÂèÇÊï∞ÔºåË∞ÉÁî® printf ÂáΩÊï∞
      push eax
      push ecx
      push OFFSET $SG2803
      call DWORD PTR __imp__printf
      ; Ë∞ÉÊï¥Ê†àÊåáÈíàÔºåÊ∏ÖÁêÜÂèÇÊï∞
      add  esp, 28    
      xor  eax, eax
      ; ËøîÂõûÂà∞Ë∞ÉÁî®ËÄÖ
      ret  0
_main ENDP<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="chap12-Êù°‰ª∂ËΩ¨Áßª"><a class="markdownIt-Anchor" href="#chap12-Êù°‰ª∂ËΩ¨Áßª"></a> Chap12 Êù°‰ª∂ËΩ¨Áßª</h2>
<h3 id="Êï∞ÂÄºÊØîËæÉ"><a class="markdownIt-Anchor" href="#Êï∞ÂÄºÊØîËæÉ"></a> Êï∞ÂÄºÊØîËæÉ</h3>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>

<span class="token keyword">void</span> <span class="token function">f_signed</span> <span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>a<span class="token operator">></span>b<span class="token punctuation">)</span>
          <span class="token function">printf</span> <span class="token punctuation">(</span><span class="token string">"a>b\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>a<span class="token operator">==</span>b<span class="token punctuation">)</span>
          <span class="token function">printf</span> <span class="token punctuation">(</span><span class="token string">"a==b\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>a<span class="token operator">&lt;</span>b<span class="token punctuation">)</span>
          <span class="token function">printf</span> <span class="token punctuation">(</span><span class="token string">"a&lt;b\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">f_unsigned</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>a<span class="token operator">></span>b<span class="token punctuation">)</span>
          <span class="token function">printf</span> <span class="token punctuation">(</span><span class="token string">"a>b\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>a<span class="token operator">==</span>b<span class="token punctuation">)</span>
          <span class="token function">printf</span> <span class="token punctuation">(</span><span class="token string">"a==b\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>a<span class="token operator">&lt;</span>b<span class="token punctuation">)</span>
          <span class="token function">printf</span> <span class="token punctuation">(</span><span class="token string">"a&lt;b\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
<span class="token punctuation">&#123;</span>
    <span class="token function">f_signed</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">f_unsigned</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">_a$ &#x3D;  8  ; size  &#x3D; 4 
_b$ &#x3D; 12  ; size  &#x3D; 4 
_f_unsigned PROC
    push   ebp
    mov    ebp, esp
    mov    eax, DWORD PTR _a$[ebp]
    cmp    eax, DWORD PTR _b$[ebp]
    jbe    SHORT $LN3@f_unsigned
    push   OFFSET $SG2761    ; &#39;a&gt;b&#39;
    call   _printf
    add    esp, 4
$LN3@f_unsigned:
    mov    ecx, DWORD PTR _a$[ebp]
    cmp    ecx, DWORD PTR _b$[ebp]
    jne    SHORT $LN2@f_unsigned
    push   OFFSET $SG2763    ; &#39;a&#x3D;&#x3D;b&#39;
    call   _printf
    add    esp, 4
$LN2@f_unsigned:
    mov    edx, DWORD PTR _a$[ebp]
    cmp    edx, DWORD PTR _b$[ebp]
    jae    SHORT $LN4@f_unsigned
    push   OFFSET $SG2765    ; &#39;a&lt;b&#39;
    call   _printf
    add    esp, 4
LN4@f_unsigned:
    Pop   ebp
    Ret   0
_f_unsigned ENDP
_main   PROC
        push    ebp
        mov     ebp, esp
        push    2
        push    1
        call    _f_signed
        add     esp, 8
        push    2
        push    1
        call    _f_unsigned
        add     esp, 8
        xor     eax, eax
        pop     ebp
        ret     0
_main   ENDP<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>JLEÔºåÂç≥‚ÄúJump if Less or Equal‚Äù„ÄÇÂ¶ÇÊûú‰∏ä‰∏ÄÊù°CMPÊåá‰ª§ÁöÑÁ¨¨‰∏Ä‰∏™Êìç‰ΩúË°®ËææÂºèÂ∞è‰∫éÊàñÁ≠â‰∫éÔºà‰∏çÂ§ß‰∫éÔºâÁ¨¨‰∫å‰∏™Ë°®ËææÂºèÔºåJLEÂ∞ÜË∑≥ËΩ¨Âà∞Êåá‰ª§ÊâÄÊ†áÊòéÁöÑÂú∞ÂùÄÔºõÂ¶ÇÊûú‰∏çÊª°Ë∂≥‰∏äËø∞Êù°‰ª∂ÔºåÂàôËøêË°å‰∏ã‰∏ÄÊù°Êåá‰ª§ÔºåÂ∞±Êú¨‰æãËÄåË®ÄÁ®ãÂ∫èÂ∞Ü‰ºöË∞ÉÁî®printf()ÂáΩÊï∞„ÄÇÁ¨¨‰∫å‰∏™Êù°‰ª∂ËΩ¨ÁßªÊåá‰ª§ÊòØJNEÔºå‚ÄúJump if Not Equal‚ÄùÔºåÂ¶ÇÊûú‰∏ä‰∏ÄÊù°CMPÁöÑ‰∏§‰∏™Êìç‰ΩúÁ¨¶‰∏çÁõ∏Á≠âÔºåÂàôËøõË°åÁõ∏Â∫îË∑≥ËΩ¨„ÄÇ</li>
<li>JGEÔºåÂç≥‚ÄúJump if Greater or Equal‚Äù„ÄÇÂ¶ÇÊûúCMPÁöÑÁ¨¨‰∏Ä‰∏™Ë°®ËææÂºèÂ§ß‰∫éÊàñÁ≠â‰∫éÁ¨¨‰∫å‰∏™Ë°®ËææÂºèÔºà‰∏çÂ∞è‰∫éÔºâÔºåÂàôËøõË°åË∑≥ËΩ¨„ÄÇËøôÊÆµÁ®ãÂ∫èÈáåÔºåÂ¶ÇÊûú‰∏â‰∏™Ë∑≥ËΩ¨ÁöÑÂà§Êñ≠Êù°‰ª∂ÈÉΩ‰∏çÊª°Ë∂≥ÔºåÂ∞Ü‰∏ç‰ºöË∞ÉÁî®printf()ÂáΩÊï∞Ôºõ‰∏çËøáÔºåÈô§ÈùûËøõË°åÁâπÊÆäÂπ≤È¢ÑÔºåÂê¶ÂàôËøôÁßçÊÉÖÂÜµÂ∫îËØ•‰∏ç‰ºöÂèëÁîü</li>
<li>ÁªèGCCÁºñËØëÂêéÔºåf_unsigned()ÂáΩÊï∞‰ΩøÁî®ÁöÑÊù°‰ª∂ËΩ¨ÁßªÊåá‰ª§ÊòØJBEÔºàJump if Below or EqualÔºåÁõ∏ÂΩì‰∫éJLEÔºâÂíåJAEÔºàJump if Above or EqualÔºåÁõ∏ÂΩì‰∫éJGEÔºâ„ÄÇ==JA/JAE/JB/JBE‰∏éJG/JGE/JL/JLEÁöÑÂå∫Âà´ÔºåÂú®‰∫éÂÆÉ‰ª¨Ê£ÄÊü•ÁöÑÊ†áÂøó‰Ωç‰∏çÂêåÔºöÂâçËÄÖÊ£ÄÊü•ÂÄü/Ëøõ‰ΩçÊ†áÂøó‰ΩçCFÔºà1ÊÑèÂë≥ÁùÄÂ∞è‰∫éÔºâÂíåÈõ∂Ê†áÂøó‰ΩçZFÔºà1ÊÑèÂë≥ÁùÄÁõ∏Á≠âÔºâÔºåÂêéËÄÖÊ£ÄÊü•‚ÄúSF XOR OF‚ÄùÔºà1ÊÑèÂë≥ÁùÄÂºÇÂè∑ÔºâÂíåZF„ÄÇ==‰ªéÊåá‰ª§ÂèÇÊï∞ÁöÑËßíÂ∫¶ÁúãÔºå<mark>ÂâçËÄÖÈÄÇÁî®‰∫éunsignedÔºàÊó†Á¨¶Âè∑ÔºâÁ±ªÂûãÊï∞ÊçÆÁöÑÔºàCMPÔºâËøêÁÆóÔºåËÄåÂêéËÄÖÁöÑÈÄÇÁî®‰∫ésignedÔºàÊúâÁ¨¶Âè∑ÔºâÁ±ªÂûãÊï∞ÊçÆÁöÑËøêÁÆó„ÄÇ</mark></li>
</ul>
<h3 id="ËÆ°ÁÆóÁªùÂØπÂÄº"><a class="markdownIt-Anchor" href="#ËÆ°ÁÆóÁªùÂØπÂÄº"></a> ËÆ°ÁÆóÁªùÂØπÂÄº</h3>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">my_abs</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
         <span class="token keyword">if</span> <span class="token punctuation">(</span>i<span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">)</span>
                 <span class="token keyword">return</span> <span class="token operator">-</span>i<span class="token punctuation">;</span>
         <span class="token keyword">else</span>
                 <span class="token keyword">return</span> i<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">i$ &#x3D; 8

my_abs   PROC
; ECX &#x3D; ËæìÂÖ•ÂÄº
         test    ecx, ecx          ; ÊâßË°å ECX ÂíåËá™Ë∫´ÁöÑÊåâ‰Ωç‰∏éÊìç‰Ωú‰ª•ËÆæÁΩÆÊ†áÂøó
; Ê£ÄÊü•ËæìÂÖ•ÂÄºÁöÑÁ¨¶Âè∑
; Â¶ÇÊûúÁ¨¶Âè∑‰∏∫Ê≠£ÂàôË∑≥Ëøá NEG Êåá‰ª§
         jns     SHORT $LN2@my_abs ; Â¶ÇÊûú ECX ‰∏∫ÈùûË¥üÊï∞ÔºåÂàôË∑≥ËΩ¨Âà∞ $LN2@my_abs
; ÂèñÂèçÂÄº
         neg     ecx               ; Â¶ÇÊûú ECX ‰∏∫Ë¥üÊï∞ÔºåÂèñÂèç ECX (ECX &#x3D; -ECX)
$LN2@my_abs:
; Â∞ÜÁªìÊûúÂáÜÂ§áÂà∞ EAX:
       mov    eax,   ecx    ; Â∞Ü ECX ÁöÑÂÄºÂ§çÂà∂Âà∞ EAX
        ret     0                   ; ‰ªéËøáÁ®ãËøîÂõûÔºà‰∏çÊ∏ÖÈô§‰ªª‰ΩïÂèÇÊï∞Ôºâ
my_abs  ENDP                        ; ËøáÁ®ã my_abs ÁöÑÁªìÊùü
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>neg</code> Êåá‰ª§Áî®‰∫éÂ∞ÜÂØÑÂ≠òÂô®ÊàñÂÜÖÂ≠ò‰ΩçÁΩÆ‰∏≠ÁöÑÊìç‰ΩúÊï∞ÂèñÂèç„ÄÇÂÖ∑‰ΩìÊù•ËØ¥ÔºåÂÆÉÂ∞Ü<mark>Êìç‰ΩúÊï∞Âèò‰∏∫ÂÆÉÁöÑÁõ∏ÂèçÊï∞ÔºàÂç≥ÂèñË¥üÂÄºÔºâ</mark>„ÄÇ<code>neg</code> Êåá‰ª§ÂÆûÈôÖ‰∏äÊòØËÆ°ÁÆó‰∫åË°•Êï∞„ÄÇ</p>
<p>‰ª•‰∏ãÊòØ <code>neg</code> Êåá‰ª§ÁöÑËØ¶ÁªÜËß£ÈáäÔºö</p>
<ul>
<li>Â¶ÇÊûúÊìç‰ΩúÊï∞ÊòØÊ≠£Êï∞Ôºå<code>neg</code> ‰ºöÂ∞ÜÂÖ∂Âèò‰∏∫Ë¥üÊï∞„ÄÇ</li>
<li>Â¶ÇÊûúÊìç‰ΩúÊï∞ÊòØË¥üÊï∞Ôºå<code>neg</code> ‰ºöÂ∞ÜÂÖ∂Âèò‰∏∫Ê≠£Êï∞„ÄÇ</li>
<li>Â¶ÇÊûúÊìç‰ΩúÊï∞ÊòØÈõ∂Ôºå<code>neg</code> ‰ºö‰øùÊåÅÂÖ∂‰∏∫Èõ∂„ÄÇ</li>
</ul>
<p>Âú®Â§ÑÁêÜËøáÁ®ã‰∏≠Ôºå<code>neg</code> Êåá‰ª§‰ºöÂΩ±ÂìçÊ†áÂøóÂØÑÂ≠òÂô®ÔºàFlags RegisterÔºâ‰∏≠ÁöÑ‰ª•‰∏ãÊ†áÂøóÔºö</p>
<ul>
<li><strong>CFÔºàËøõ‰ΩçÊ†áÂøóÔºâ</strong>ÔºöÂ¶ÇÊûúÁªìÊûú‰∏∫ÈùûÈõ∂ÔºåÂàôËÆæÁΩÆ CF„ÄÇ</li>
<li><strong>ZFÔºàÈõ∂Ê†áÂøóÔºâ</strong>ÔºöÂ¶ÇÊûúÁªìÊûú‰∏∫Èõ∂ÔºåÂàôËÆæÁΩÆ ZF„ÄÇ</li>
<li><strong>SFÔºàÁ¨¶Âè∑Ê†áÂøóÔºâ</strong>ÔºöÊ†πÊçÆÁªìÊûúÁöÑÊúÄÈ´ò‰ΩçËÆæÁΩÆ SF„ÄÇ</li>
<li><strong>OFÔºàÊ∫¢Âá∫Ê†áÂøóÔºâ</strong>ÔºöÂ¶ÇÊûúÊìç‰ΩúÊï∞ÊòØÊúÄÂ∞èÁöÑË¥üÊï∞ÔºåÂàôËÆæÁΩÆ OFÔºà‰æãÂ¶ÇÔºåÂØπ‰∫é32‰ΩçÊï¥Êï∞Ôºå-2^31 Âèò‰∏∫ 2^31-1 ‰ºöÂØºËá¥Ê∫¢Âá∫Ôºâ„ÄÇ</li>
</ul>
<p>ÂÅáËÆæ <code>ECX</code> ÂØÑÂ≠òÂô®ÂåÖÂê´ÂÄº <code>5</code> Êàñ <code>-5</code>ÔºåÂú®ÊâßË°å <code>neg</code> Êåá‰ª§ÂêéÁöÑÂèòÂåñÂ¶Ç‰∏ãÔºö</p>
<pre class="line-numbers language-none"><code class="language-none">mov ecx, 5     ; ECX &#x3D; 5
neg ecx        ; ECX &#x3D; -5

mov ecx, -5    ; ECX &#x3D; -5
neg ecx        ; ECX &#x3D; 5<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="Êù°‰ª∂ËøêÁÆóÁ¨¶"><a class="markdownIt-Anchor" href="#Êù°‰ª∂ËøêÁÆóÁ¨¶"></a> Êù°‰ª∂ËøêÁÆóÁ¨¶</h3>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> <span class="token function">f</span> <span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> a<span class="token operator">==</span><span class="token number">10</span> <span class="token operator">?</span> <span class="token string">"it is ten"</span> <span class="token operator">:</span> <span class="token string">"it is not ten"</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>
<p>Âú®ÁºñËØëÂê´ÊúâÊù°‰ª∂ËøêÁÆóÁ¨¶ÁöÑËØ≠Âè•Êó∂ÔºåÊó©ÊúüÊó†‰ºòÂåñÂäüËÉΩÁöÑÁºñËØëÂô®‰ºö‰ª•ÁºñËØë‚Äúif/else‚ÄùËØ≠Âè•ÁöÑÊñπÊ≥ïËøõË°åÂ§ÑÁêÜ„ÄÇ</p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">$SG746   DB       &#39;it is ten&#39;, 00H         ; ÂÆö‰πâÂ≠óÁ¨¶‰∏≤ &quot;it is ten&quot; Âπ∂‰ª•Á©∫Â≠óÁ¨¶ÁªìÂ∞æ
$SG747   DB       &#39;it is not ten&#39;, 00H     ; ÂÆö‰πâÂ≠óÁ¨¶‰∏≤ &quot;it is not ten&quot; Âπ∂‰ª•Á©∫Â≠óÁ¨¶ÁªìÂ∞æ

tv65 &#x3D; -4 ; ËøôÊòØ‰∏Ä‰∏™‰∏¥Êó∂ÂèòÈáèÔºåÂ≠òÂÇ®Âú®Ê†àÂ∏ß‰∏≠ÁöÑÂÅèÁßªÈáè‰∏∫ -4
_a$ &#x3D; 8   ; ËæìÂÖ•ÂÄºÂú®Ê†àÂ∏ß‰∏≠ÁöÑÂÅèÁßªÈáè‰∏∫ 8

_f       PROC
         push     ebp                      ; ‰øùÂ≠òÂü∫ÊåáÈíà EBP
         mov      ebp, esp                 ; ËÆæÁΩÆÊñ∞ÁöÑÊ†àÂ∏ß
         push     ecx                      ; ‰øùÂ≠ò ECX ÂØÑÂ≠òÂô®ÁöÑÂÄº
; ÊØîËæÉËæìÂÖ•ÂÄºÊòØÂê¶‰∏∫10
         cmp      DWORD PTR _a$[ebp], 10   ; ÊØîËæÉ‰Ωç‰∫éÊ†àÂ∏ßÂÅèÁßª _a$ Â§ÑÁöÑÂÄºÊòØÂê¶‰∏∫10
; Â¶ÇÊûú‰∏çÁ≠â‰∫é10ÔºåÂàôË∑≥ËΩ¨Âà∞ $LN3@f
         jne      SHORT $LN3@f             ; Â¶ÇÊûú‰∏çÁ≠â‰∫é10ÔºåË∑≥ËΩ¨Âà∞ $LN3@f
; Â∞ÜÊåáÂêëÂ≠óÁ¨¶‰∏≤ &#39;it is ten&#39; ÁöÑÊåáÈíàÂ≠òÂÇ®Âà∞‰∏¥Êó∂ÂèòÈáè‰∏≠
         mov      DWORD PTR tv65[ebp], OFFSET $SG746 ; Â∞ÜÂ≠óÁ¨¶‰∏≤ &quot;it is ten&quot; ÁöÑÂú∞ÂùÄÂ≠òÂÇ®Âà∞ tv65 ÂèòÈáè‰∏≠
; Ë∑≥ËΩ¨Âà∞ÈÄÄÂá∫Ê†áÁ≠æ
         jmp      SHORT $LN4@f             ; Ë∑≥ËΩ¨Âà∞ $LN4@f
$LN3@f:
; Â∞ÜÊåáÂêëÂ≠óÁ¨¶‰∏≤ &#39;it is not ten&#39; ÁöÑÊåáÈíàÂ≠òÂÇ®Âà∞‰∏¥Êó∂ÂèòÈáè‰∏≠
         mov      DWORD PTR tv65[ebp], OFFSET $SG747 ; Â∞ÜÂ≠óÁ¨¶‰∏≤ &quot;it is not ten&quot; ÁöÑÂú∞ÂùÄÂ≠òÂÇ®Âà∞ tv65 ÂèòÈáè‰∏≠
$LN4@f:
; ËøôÊòØÈÄÄÂá∫ÈÉ®ÂàÜ„ÄÇ‰ªé‰∏¥Êó∂ÂèòÈáè‰∏≠Â§çÂà∂ÊåáÂêëÂ≠óÁ¨¶‰∏≤ÁöÑÊåáÈíàÂà∞ EAX ‰∏≠
         mov      eax, DWORD PTR tv65[ebp] ; Â∞Ü tv65 ÂèòÈáè‰∏≠ÁöÑÂÄºÂ§çÂà∂Âà∞ EAX ÂØÑÂ≠òÂô®
         mov      esp, ebp                 ; ÊÅ¢Â§çÊ†àÊåáÈíà
         pop      ebp                      ; ÊÅ¢Â§çÂü∫ÊåáÈíà
         ret      0                        ; ËøîÂõûÔºåÊ∏ÖÁêÜÊ†à‰∏äÁöÑÂèÇÊï∞
_f       ENDP                              ; ËøáÁ®ã _f ÁªìÊùü
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ÂºÄÂêØÁºñËØëÂô®‰ºòÂåñ</p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">$SG792  DB       &#39;it is ten&#39;, 00H
$SG793  DB       &#39;it is not ten&#39;, 00H

_a$ &#x3D; 8 ; size &#x3D; 4
_f      PROC
; compare input value with 10
        cmp      DWORD PTR _a$[esp-4], 10
        mov      eax, OFFSET $SG792 ; &#39;it is ten&#39;
; jump to $LN4@f if equal
        je       SHORT $LN4@f
        mov      eax, OFFSET $SG793 ; &#39;it is not ten&#39;
$LN4@f:
        ret      0 
_f      ENDP<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
</ul>
<h3 id="ÊØîËæÉÂ§ßÂ∞è"><a class="markdownIt-Anchor" href="#ÊØîËæÉÂ§ßÂ∞è"></a> ÊØîËæÉÂ§ßÂ∞è</h3>
<ul>
<li>ÂêØÁî®‰ºòÂåñÂäüËÉΩÂêéÔºåÁºñËØëÂô®‰ºöÂ∞ΩÂèØËÉΩÈÅøÂÖç‰ΩøÁî®Êù°‰ª∂ËΩ¨ÁßªÊåá‰ª§</li>
</ul>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">my_max</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>a<span class="token operator">></span>b<span class="token punctuation">)</span>
                <span class="token keyword">return</span> a<span class="token punctuation">;</span>
        <span class="token keyword">else</span>
                <span class="token keyword">return</span> b<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">my_min</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>a<span class="token operator">&lt;</span>b<span class="token punctuation">)</span>
                <span class="token keyword">return</span> a<span class="token punctuation">;</span>
        <span class="token keyword">else</span>
                <span class="token keyword">return</span> b<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Ê≤°ÂºÄÂêØ‰ºòÂåñ</p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">_a$ &#x3D; 8
_b$ &#x3D; 12
_my_min PROC
        push     ebp
        mov      ebp, esp
        mov      eax, DWORD PTR _a$[ebp]
; compare A and B:
        cmp      eax, DWORD PTR _b$[ebp]
; jump, if A is greater or equal to B:
        jge      SHORT $LN2@my_min
; reload A to EAX if otherwise and jump to exit
        mov      eax, DWORD PTR _a$[ebp]
        jmp      SHORT $LN3@my_min
        jmp      SHORT $LN3@my_min ; this is redundant JMP
$LN2@my_min:
; return B
        mov      eax, DWORD PTR _b$[ebp]
$LN3@my_min:
        pop      ebp
        ret      0
_my_min ENDP

_a$ &#x3D; 8
_b$ &#x3D; 12
_my_max PROC
        push     ebp
        mov      ebp, esp
        mov      eax, DWORD PTR _a$[ebp]
; compare A and B:
        cmp      eax, DWORD PTR _b$[ebp]
; jump if A is less or equal to B:
        jle      SHORT $LN2@my_max
; reload A to EAX if otherwise and jump to exit
        mov      eax, DWORD PTR _a$[ebp]
        jmp      SHORT $LN3@my_max
        jmp      SHORT $LN3@my_max ; this is redundant JMP
$LN2@my_max:
; return B
        mov      eax, DWORD PTR _b$[ebp]
$LN3@my_max:
        pop      ebp
        ret      0
_my_max ENDP<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="chap13-switch"><a class="markdownIt-Anchor" href="#chap13-switch"></a> Chap13 Switch</h2>
<h3 id="caseËæÉÂ∞ëÁöÑÊÉÖÂΩ¢"><a class="markdownIt-Anchor" href="#caseËæÉÂ∞ëÁöÑÊÉÖÂΩ¢"></a> caseËæÉÂ∞ëÁöÑÊÉÖÂΩ¢</h3>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>

<span class="token keyword">void</span> <span class="token function">f</span> <span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>a<span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
    <span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span> <span class="token function">printf</span> <span class="token punctuation">(</span><span class="token string">"zero\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span> <span class="token function">printf</span> <span class="token punctuation">(</span><span class="token string">"one\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span> <span class="token function">printf</span> <span class="token punctuation">(</span><span class="token string">"two\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token operator">:</span> <span class="token function">printf</span> <span class="token punctuation">(</span><span class="token string">"something unknown\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span> 
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token function">f</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//test</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>msvs‰∏çÂºÄÂêØ‰ºòÂåñ</p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">tv64 &#x3D; -4 ; size &#x3D; 4
_a$ &#x3D; 8   ; size &#x3D; 4
_f     PROC
    push   ebp
    mov    ebp, esp
    push   ecx
    mov    eax, DWORD PTR _a$[ebp]
    mov    DWORD PTR tv64[ebp], eax
    cmp    DWORD PTR tv64[ebp], 0
    je     SHORT $LN4@f 
    cmp    DWORD PTR tv64[ebp], 1
    je     SHORT $LN3@f
    cmp    DWORD PTR tv64[ebp], 2
    je     SHORT $LN2@f
    jmp    SHORT $LN1@f
$LN4@f:0
    push   OFFSET $SG739 ; &#39;zero&#39;, 0aH, 00H
    call   _printf
    add    esp, 4
    jmp    SHORT $LN7@f
$LN3@f:1
    push   OFFSET $SG741 ; &#39;one&#39;, 0aH, 00H
    call   _printf
    add    esp, 4
    jmp    SHORT $LN7@f
$LN2@f:2
    push   OFFSET $SG743 ; &#39;two&#39;, 0aH, 00H
    call   _printf
    add    esp, 4
    jmp    SHORT $LN7@f
$LN1@f:default
    push   OFFSET $SG745 ; &#39;something unknown&#39;, 0aH, 00H
    call   _printf
    add    esp, 4
$LN7@f:ret
    mov    esp, ebp
    pop    ebp
    ret    0 
_f     ENDP<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ÂèØ‰ª•ÂèëÁé∞ÁºñËØëÂô®ÊääSwitchÁøªËØëÊàê‰∫Üif elseÂΩ¢ÂºèÂèØ‰ª•ËÆ§‰∏∫Ôºåswitch()ËØ≠Âè•ÊòØ‰∏ÄÁßçÊó®Âú®ÁÆÄÂåñÂ§ßÈáèÂµåÂ•óif()ËØ≠Âè•ËÄåËÆæËÆ°ÁöÑËØ≠Ê≥ïÁ≥ñ</p>
<p><mark>ÂºÄÂêØ‰ºòÂåñ</mark></p>
<p><code>cl 1.c /Fa1.asm /Ox</code></p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">_a$ &#x3D; 8 ; size &#x3D; 4
_f     PROC
    mov    eax, DWORD PTR _a$[esp-4];eax&#x3D;a
    sub    eax, 0;eax&#x3D;eax-0 
    je     SHORT $LN4@f;if a&#x3D;&#x3D;0
    sub    eax, 1
    je     SHORT $LN3@f;if a&#x3D;&#x3D;1
    sub    eax, 1
    je     SHORT $LN2@f;if a&#x3D;&#x3D;2
    ;default
    mov    DWORD PTR _a$[esp-4], OFFSET $SG791 ; &#39;something unknown&#39;, 0aH, 00H
    jmp    _printf
$LN2@f:;2
    mov    DWORD PTR _a$[esp-4], OFFSET $SG789 ; &#39;two&#39;, 0aH, 00H
    jmp    _printf
$LN3@f:;1
    mov    DWORD PTR _a$[esp-4], OFFSET $SG787 ; &#39;one&#39;, 0aH, 00H
    jmp    _printf
$LN4@f:;0
    mov    DWORD PTR _a$[esp-4], OFFSET $SG785 ; &#39;zero&#39;, 0aH, 00H
    jmp    _printf
_f     ENDP<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>‰∏§Â§Ñ‰∏çÂêå</p>
<ul>
<li>
<p>aÂ≠òÂà∞eax‰πãÂêéÔºåeax-0ÔºõËøôÊ†∑Áúã‰ººÊó†ÊÑè‰πâ,ÂÆûÈôÖ‰∏äÂèØ‰ª•Ê£ÄÊü•eaxÂØÑÂ≠òÂô®ÁöÑÂÄºÊòØÂê¶‰∏∫0,Â¶ÇÊûúeaxÊòØ0ÔºåZF=1,ËøõËÄåÊ£ÄÊü•Á¨¨‰∏Ä‰∏™Âà§Êñ≠Êù°‰ª∂,Â¶ÇÊûú‰∏çÊòØÂ∞±ÁªßÁª≠-1Âà§Êñ≠</p>
</li>
<li>
<p>Âú®ÊääÂ≠óÁ¨¶‰∏≤ÊåáÈíàÂ≠òÂÇ®Âà∞ÂèòÈáè<em>a</em>‰πãÂêéÔºåÂáΩÊï∞‰ΩøÁî®JMPÊåá‰ª§Ë∞ÉÁî®printf()ÂáΩÊï∞„ÄÇ</p>
<p>ËøôÁÇπ‰∏çÈöæËß£ÈáäÔºöË∞É<mark>Áî®ÊñπÂáΩÊï∞ÊääÂèÇÊï∞Êé®ÈÄÅÂÖ•Ê†à‰πãÂêéÔºåÁöÑÁ°ÆÈÄöÂ∏∏ÈÄöËøáCALLÊåá‰ª§Ë∞ÉÁî®ÂÖ∂‰ªñÂáΩÊï∞„ÄÇËøôÁßçÊÉÖÂÜµ‰∏ãÔºåCALLÊåá‰ª§‰ºöÊääËøîÂõûÂú∞ÂùÄÊé®ÈÄÅÂÖ•Ê†à„ÄÅÂπ∂ÈÄöËøáÊó†Êù°‰ª∂ËΩ¨ÁßªÁöÑÊâãÊÆµÂêØÁî®Ë¢´Ë∞ÉÁî®ÊñπÂáΩÊï∞</mark>„ÄÇÂ∞±Êú¨‰æãËÄåË®ÄÔºåÂú®Ë¢´Ë∞ÉÁî®ÊñπÂáΩÊï∞ËøêË°åÁöÑ‰ªªÊÑèÊó∂ÂàªÔºåÊ†àÁöÑÂÜÖÂ≠òÂ≠òÂÇ®ÁªìÊûÑ‰∏∫Ôºö</p>
<ul>
<li>ESP‚Äî‚ÄîÊåáÂêëRA„ÄÇ</li>
<li>ESPÔºã4‚Äî‚ÄîÊåáÂêëÂèòÈáè<em>a</em>„ÄÇ</li>
</ul>
<p>Âè¶‰∏ÄÊñπÈù¢ÔºåÂú®Êú¨‰æãÁ®ãÂ∫èË∞ÉÁî®printf()ÂáΩÊï∞‰πãÂâç„ÄÅ‰πãÂêéÔºå<mark>Èô§‰∫ÜÂà∂ÂêÑÁ¨¨‰∏Ä‰∏™Ê†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÁöÑÂèÇÊï∞ÈóÆÈ¢ò‰ª•Â§ñÔºåÊ†àÁöÑÂ≠òÂÇ®ÁªìÊûÑÂÖ∂ÂÆûÊ≤°ÊúâÂèëÁîüÂèòÂåñ</mark>„ÄÇÊâÄ‰ª•ÔºåÁºñËØëÂô®Âú®ÂàÜÈÖçJMPÊåá‰ª§‰πãÂâçÔºåÊääÂ≠óÁ¨¶‰∏≤ÊåáÈíàÂ≠òÂÇ®Âà∞Áõ∏Â∫îÂú∞ÂùÄ‰∏ä„ÄÇ</p>
<p>Ëøô‰∏™Á®ãÂ∫èÊää<mark>ÂáΩÊï∞ÁöÑÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞ÊõøÊç¢‰∏∫Â≠óÁ¨¶‰∏≤ÁöÑÊåáÈíà</mark>ÔºåÁÑ∂ÂêéË∑≥ËΩ¨Âà∞printf()ÂáΩÊï∞ÁöÑÂú∞ÂùÄÔºåÂ∞±Â•ΩÂÉèÁ®ãÂ∫èÊ≤°Êúâ‚ÄúË∞ÉÁî®‚ÄùËøáf()ÂáΩÊï∞„ÄÅÁõ¥Êé•‚ÄúËΩ¨Áßª‚Äù‰∫Üprintf()ÂáΩÊï∞‰∏ÄËà¨„ÄÇÂΩìprintf()ÂáΩÊï∞ÂÆåÊàêËæìÂá∫ÁöÑ‰ΩøÂëΩ‰ª•ÂêéÔºåÂÆÉ‰ºöÊâßË°åRETËøîÂõûÊåá‰ª§„ÄÇRETÊåá‰ª§‰ºö‰ªéÊ†à‰∏≠ËØªÂèñÔºàPOPÔºâËøîÂõûÂú∞ÂùÄRA„ÄÅÂπ∂Ë∑≥ËΩ¨Âà∞RA„ÄÇ‰∏çËøá<mark>Ëøô‰∏™RA‰∏çÊòØÂÖ∂Ë∞ÉÁî®ÊñπÂáΩÊï∞‚Äî‚Äîf()ÂáΩÊï∞ÂÜÖÁöÑÊüê‰∏™Âú∞ÂùÄÔºåËÄåÊòØË∞ÉÁî®f()ÂáΩÊï∞ÁöÑÂáΩÊï∞Âç≥main()ÂáΩÊï∞ÁöÑÊüê‰∏™Âú∞ÂùÄ</mark>„ÄÇÊç¢ËÄåË®Ä‰πãÔºå==Ë∑≥ËΩ¨Âà∞Ëøô‰∏™RAÂú∞ÂùÄÂêéÔºåprintf()ÂáΩÊï∞‰ºö‰º¥ÈöèÂÖ∂Ë∞ÉÁî®ÊñπÂáΩÊï∞f()==‰∏ÄÂêåÁªìÊùü„ÄÇ</p>
<p>Èô§ÈùûÊØè‰∏™case‰ªéÂè•ÁöÑÊúÄÂêé‰∏ÄÊù°Êåá‰ª§ÈÉΩÊòØË∞ÉÁî®printf()ÂáΩÊï∞ÔºåÂê¶ÂàôÁºñËØëÂô®Â∞±ÂÅö‰∏çÂà∞ËøôÁßçÁ®ãÂ∫¶ÁöÑ‰ºòÂåñ„ÄÇÊüêÁßçÊÑè‰πâ‰∏äËØ¥Ëøô‰∏élongjmp()ÂáΩÊï∞ÂçÅÂàÜÁõ∏‰ºº„ÄÇÂΩìÁÑ∂ÔºåËøôÁßç‰ºòÂåñÁöÑÁõÆÁöÑÊó†ÈùûÂ∞±ÊòØÊèêÈ´òÁ®ãÂ∫èÁöÑËøêË°åÈÄüÂ∫¶„ÄÇ</p>
</li>
</ul>
<h3 id="caseËæÉÂ§öÁöÑÊÉÖÂΩ¢"><a class="markdownIt-Anchor" href="#caseËæÉÂ§öÁöÑÊÉÖÂΩ¢"></a> caseËæÉÂ§öÁöÑÊÉÖÂΩ¢</h3>
<p>Âú®switch()ËØ≠Âè•Â≠òÂú®Â§ßÈáècase()ÂàÜÊîØÁöÑÊÉÖÂÜµ‰∏ãÔºåÁºñËØëÂô®Â∞±‰∏çËÉΩÁõ¥Êé•Â•óÁî®Â§ßÈáèJE/JNEÊåá‰ª§‰∫Ü„ÄÇ‰ºöÁîüÊàê‰∏ÄÁßçË∑≥ËΩ¨Ë°®,Âê¶ÂàôÁ®ãÂ∫è‰ª£Á†ÅËÇØÂÆö‰ºöÈùûÂ∏∏Â∫ûÂ§ß„ÄÇ</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>

<span class="token keyword">void</span> <span class="token function">f</span> <span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>a<span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
    <span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span> <span class="token function">printf</span> <span class="token punctuation">(</span><span class="token string">"zero\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span> <span class="token function">printf</span> <span class="token punctuation">(</span><span class="token string">"one\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span> <span class="token function">printf</span> <span class="token punctuation">(</span><span class="token string">"two\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">3</span><span class="token operator">:</span> <span class="token function">printf</span> <span class="token punctuation">(</span><span class="token string">"three\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">4</span><span class="token operator">:</span> <span class="token function">printf</span> <span class="token punctuation">(</span><span class="token string">"four\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token operator">:</span> <span class="token function">printf</span> <span class="token punctuation">(</span><span class="token string">"something unknown\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span> 
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token function">f</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// test</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>x86,Êú™ÂºÄÂêØ‰ºòÂåñ,msvs</p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">tv64 &#x3D; -4    ; size&#x3D;4 
_a$  &#x3D;  8    ; size &#x3D; 4
_f     PROC
     push   ebp
     mov    ebp, esp;ÂáΩÊï∞Â∫èË®Ä
     push   ecx
     mov    eax, DWORD PTR _a$[ebp];eax&#x3D;a
     mov    DWORD PTR tv64[ebp], eax;tv64&#x3D;a
     cmp    DWORD PTR tv64[ebp], 4;if a&#x3D;&#x3D;4
     ja     SHORT $LN1@f;if a&gt;4
     mov    ecx, DWORD PTR tv64[ebp]
     jmp    DWORD PTR $LN11@f[ecx*4];jmp Ë∑≥ËΩ¨Ë°®
$LN6@f:0
     push   OFFSET $SG739 ; &#39;zero&#39;, 0aH, 00H
     call   _printf
     add    esp, 4
     jmp    SHORT $LN9@f
$LN5@f:1
     push   OFFSET $SG741 ; &#39;one&#39;, 0aH, 00H
     call   _printf
     add    esp, 4
     jmp    SHORT $LN9@f
$LN4@f:2
     push   OFFSET $SG743 ; &#39;two&#39;, 0aH, 00H
     call   _printf
     add    esp, 4
     jmp    SHORT $LN9@f
$LN3@f:3
     push   OFFSET $SG745 ; &#39;three&#39;, 0aH, 00H
     call   _printf
     add    esp, 4
     jmp    SHORT $LN9@f
$LN2@f:4
     push   OFFSET $SG747 ; &#39;four&#39;, 0aH, 00H
     call   _printf
     add    esp, 4
     jmp    SHORT $LN9@f
$LN1@f:defalut
     push   OFFSET $SG749 ; &#39;something unknown&#39;, 0aH, 00H
     call   _printf
     add    esp, 4
$LN9@f:;ret
     mov    esp, ebp
     pop    ebp
     ret    0
     npad    2; align next label
$LN11@f:;Ë∑≥ËΩ¨Ë°®
     DD    $LN6@f ; 0
     DD    $LN5@f ; 1
     DD    $LN4@f ; 2
     DD    $LN3@f ; 3
     DD    $LN2@f ; 4
_f     ENDP<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>
<p>Ê±áÁºñËß£ËØª:</p>
<ul>
<li>
<p>ËøôÊÆµ‰ª£Á†ÅÂèØË¢´ÂàÜ‰∏∫Êï∞‰∏™Ë∞ÉÁî®<code>printf()</code>ÂáΩÊï∞ÁöÑÊåá‰ª§ÁªÑ</p>
</li>
<li>
<p>$ln11@FÁöÑÂÅèÁßªÈáèÂºÄÂßãÁöÑË°®Âè´ÂÅöË∑≥ËΩ¨Ë°®(jumptable)</p>
</li>
<li>
<p>ÂáΩÊï∞ÊúÄÂàùÊääÂèòÈáèa‰∏éÊï∞Â≠ó4ËøõË°åÊØîËæÉÔºåÂ¶ÇÊûúa&gt;4ÔºåÂ∞±ÊâìÂç∞something unknown</p>
</li>
<li>
<p><code>jmp    DWORD PTR $LN11@f[ecx*4]</code>Â¶ÇÊûúa&lt;=4Ôºå‰ºöÂÖàËÆ°ÁÆóa*4,ÁÑ∂ÂêéÊ†πÊçÆLN11@fËøô‰∏™Ë°®Êü•ËØ¢ÔºåÂπ∂Ë∑≥ËΩ¨Âà∞Ëøô‰∏™Ë°®ÊâÄÊåáÂêëÁöÑÂú∞ÂùÄ„ÄÇ<mark>‰∏∫‰ªÄ‰πàË¶Åx4?ÊòØÂõ†‰∏∫x86Á≥ªÁªüÁöÑÂÜÖÂ≠òÂú∞ÂùÄÈÉΩÊòØ32‰ΩçÊï∞ÊçÆÔºåÊØè‰∏™Âú∞ÂùÄÂç†Áî®4Â≠óËäÇÔºåÂÅèÁßªÂú∞ÂùÄÈúÄË¶Åx4ÊâçËÉΩÂà∞Ëææ</mark></p>
<p>Ê≠§Êó∂ÁöÑswitchËØ≠Âè•Á≠âÊïà‰∫é<code>jmp DWORD PTR ($LN11@f[ecx*4])$LN11@f+ecx*4</code></p>
</li>
<li>
<p>npadÊåá‰ª§Â±û‰∫é<code>Ê±áÁºñÂÆè</code>Ôºå==ÂÆÉÁöÑ‰ΩúÁî®ÊòØÊääÁ¥ßÊé•ÂÖ∂ÂêéÁöÑÊ†áÁ≠æÂú∞ÂùÄÂêë4Â≠óËäÇÔºàÊàñ16Â≠óËäÇÔºâËæπÁïåÂØπÈΩê„ÄÇ==npadÁöÑÂú∞ÂùÄÂØπÈΩêÂäüËÉΩÂèØ<code>ÊèêÈ´òÂ§ÑÁêÜÂô®ÁöÑIOËØªÂÜôÊïàÁéá</code>ÔºåÈÄöËøá‰∏ÄÊ¨°Êìç‰ΩúÂç≥ÂèØÂÆåÊàêÂÜÖÂ≠òÊÄªÁ∫ø„ÄÅÁºìÂÜ≤ÂÜÖÂ≠òÁ≠âËÆæÂ§áÁöÑÊï∞ÊçÆÊìç‰Ωú„ÄÇ</p>
</li>
</ul>
</li>
</ul>
<p>switch()ÁöÑÂ§ß‰ΩìÊ°ÜÊû∂</p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">MOV REG,input
CMP REG,4 ; maximal number of cases
JA default 
SHL REG,3 ; find element in table.shift for 3bits in x64.
MOV REG, jump_table[REG]
JMP REG

case1;
     ; do something
     JMP exit
case2;
     ; do something
     JMP exit
case3;
     ; do something
     JMP exit
case4;
     ; do something
     JMP exit
Case5;
     ; do something
     JMP exit

defaule:

     ‚Ä¶

exit:

     ‚Ä¶

jump_table dd casel
           dd case2
           dd case3
           dd case4
           dd case5<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Ëã•‰∏ç‰ΩøÁî®‰∏äËø∞Êåá‰ª§ÔºåÊàë‰ª¨‰πüÂèØ‰ª•<mark>Âú®32‰ΩçÁ≥ªÁªü‰∏ä‰ΩøÁî®Êåá‰ª§JMP jump_table[REG*4]</mark>/Âú®<mark>64‰Ωç‰∏ä‰ΩøÁî®JMP jump_table[REG*8]</mark>ÔºåÂÆûÁé∞ËΩ¨ÁßªË°®‰∏≠ÁöÑÂØªÂùÄËÆ°ÁÆó„ÄÇ</p>
<p>ËØ¥Âà∞Â∫ïÔºåËΩ¨ÁßªË°®Âè™‰∏çËøáÊòØÊüêÁßçÊåáÈíàÊï∞ÁªÑÂÆÉÂíå18.5ËäÇ‰ªãÁªçÁöÑÈÇ£ÁßçÊåáÈíàÊï∞ÁªÑÂçÅÂàÜÈõ∑Âêå„ÄÇ</p>
<h3 id="case‰ªéÂè•Â§öÂØπ‰∏Ä"><a class="markdownIt-Anchor" href="#case‰ªéÂè•Â§öÂØπ‰∏Ä"></a> case‰ªéÂè•Â§öÂØπ‰∏Ä</h3>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>

<span class="token keyword">void</span> <span class="token function">f</span> <span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
         <span class="token keyword">switch</span> <span class="token punctuation">(</span>a<span class="token punctuation">)</span>
         <span class="token punctuation">&#123;</span>
         <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>
         <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span>
         <span class="token keyword">case</span> <span class="token number">7</span><span class="token operator">:</span>
         <span class="token keyword">case</span> <span class="token number">10</span><span class="token operator">:</span>
                  <span class="token function">printf</span> <span class="token punctuation">(</span><span class="token string">"1, 2, 7, 10\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                  <span class="token keyword">break</span><span class="token punctuation">;</span>
         <span class="token keyword">case</span> <span class="token number">3</span><span class="token operator">:</span>
         <span class="token keyword">case</span> <span class="token number">4</span><span class="token operator">:</span>
         <span class="token keyword">case</span> <span class="token number">5</span><span class="token operator">:</span>
         <span class="token keyword">case</span> <span class="token number">6</span><span class="token operator">:</span>
                  <span class="token function">printf</span> <span class="token punctuation">(</span><span class="token string">"3, 4, 5\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                  <span class="token keyword">break</span><span class="token punctuation">;</span>
         <span class="token keyword">case</span> <span class="token number">8</span><span class="token operator">:</span>
         <span class="token keyword">case</span> <span class="token number">9</span><span class="token operator">:</span>
         <span class="token keyword">case</span> <span class="token number">20</span><span class="token operator">:</span>
         <span class="token keyword">case</span> <span class="token number">21</span><span class="token operator">:</span>
                  <span class="token function">printf</span> <span class="token punctuation">(</span><span class="token string">"8 9, 21\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                  <span class="token keyword">break</span><span class="token punctuation">;</span>
         <span class="token keyword">case</span> <span class="token number">22</span><span class="token operator">:</span>
                  <span class="token function">printf</span> <span class="token punctuation">(</span><span class="token string">"22\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                  <span class="token keyword">break</span><span class="token punctuation">;</span>
         <span class="token keyword">default</span><span class="token operator">:</span>
                  <span class="token function">printf</span> <span class="token punctuation">(</span><span class="token string">"default\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                  <span class="token keyword">break</span><span class="token punctuation">;</span>
         <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> 
<span class="token punctuation">&#123;</span>
         <span class="token function">f</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Â¶ÇÊûúÁºñËØëÂô®ÂàªÊùøÂú∞ÊåâÁÖßÊØèÁßçÂèØËÉΩÁöÑÈÄªËæëÂàÜÊîØÈÄê‰∏ÄÂàÜÈÖçÂØπÂ∫îÁöÑÊåá‰ª§ÁªÑÔºåÈÇ£‰πàÁ®ãÂ∫èÈáåÂ∞Ü‰ºöÂ≠òÂú®Â§ßÈáèÁöÑÈáçÂ§çÊåá‰ª§„ÄÇ‰∏ÄËà¨ËÄåË®ÄÔºåÁºñËØëÂô®‰ºöÈÄöËøáÊüêÁßç<mark>Ê¥æÂèëÊú∫Âà∂</mark>Êù•Èôç‰Ωé‰ª£Á†ÅÁöÑÂÜó‰ΩôÂ∫¶„ÄÇ</p>
<p>‰ΩøÁî®MSVS ÂºÄÂêØ/Ox‰ºòÂåñ</p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly"> 1 $SG2798 DB        &#39;1, 2, 7, 10&#39;, 0aH, 00H
 2 $SG2800 DB        &#39;3, 4, 5&#39;, 0aH, 00H
 3 $SG2802 DB        &#39;8, 9, 21&#39;, 0aH, 00H
 4 $SG2804 DB        &#39;22&#39;, 0aH, 00H
 5 $SG2806 DB        &#39;default&#39;, 0aH, 00H
 6
 7 _a$ &#x3D; 8
 8 _f      PROC
 9         mov       eax, DWORD PTR _a$[esp-4]
10         dec       eax
11         cmp       eax, 21
12         ja        SHORT $LN1@f
13         movzx     eax, BYTE PTR $LN10@f[eax];‰ªéeaxÂØÑÂ≠òÂô®ÊåáÂêëÁöÑÂÜÖÂ≠òÂú∞ÂùÄ‰∏≠ËØªÂèñ‰∏Ä‰∏™Â≠óËäÇÔºàBYTEÔºâÂ§ßÂ∞èÁöÑÊï∞ÊçÆÔºåÁÑ∂ÂêéÊó†Á¨¶Âè∑Êâ©Â±ïËøô‰∏™Â≠óËäÇÂà∞32‰ΩçÔºàDWORDÔºâÔºåÊúÄÂêéÂ∞ÜÊâ©Â±ïÂêéÁöÑÁªìÊûúÂ≠òÂÇ®Âà∞eaxÂØÑÂ≠òÂô®‰∏≠„ÄÇ
14         jmp       DWORD PTR $LN11@f[eax*4]
15 $LN5@f:
16         mov       DWORD PTR _a$[esp-4], OFFSET $SG2798 ; &#39;1, 2, 7, 10&#39;
17         jmp       DWORD PTR __imp__printf
18 $LN4@f:
19         mov       DWORD PTR _a$[esp-4], OFFSET $SG2800 ; &#39;3, 4, 5&#39;
20         jmp       DWORD PTR __imp__printf
21 $LN3@f:
22         mov       DWORD PTR _a$[esp-4], OFFSET $SG2802 ; &#39;8, 9, 21&#39;
23         jmp       DWORD PTR __imp__printf
24 $LN2@f:
25         mov       DWORD PTR _a$[esp-4], OFFSET $SG2804 ; &#39;22&#39;
26         jmp       DWORD PTR __imp__printf
27 $LN1@f:
28         mov       DWORD PTR _a$[esp-4], OFFSET $SG2806 ; &#39;default&#39;
29         jmp       DWORD PTR __imp__printf
30         npad      2 ; align $LN11@f table on 16-byte boundary
31 $LN11@f:
32         DD        $LN5@f ; print &#39;1, 2, 7, 10&#39;
33         DD        $LN4@f ; print &#39;3, 4, 5&#39;
34         DD        $LN3@f ; print &#39;8, 9, 21&#39;
35         DD        $LN2@f ; print &#39;22&#39;
36         DD        $LN1@f ; print &#39;default&#39;
37 $LN10@f:
38         DB        0 ; a&#x3D;1  ;byteÂûã1‰∏™Â≠óËäÇ
39         DB        0 ; a&#x3D;2
40         DB        1 ; a&#x3D;3
41         DB        1 ; a&#x3D;4
42         DB        1 ; a&#x3D;5
43         DB        1 ; a&#x3D;6
44         DB        0 ; a&#x3D;7
45         DB        2 ; a&#x3D;8
46         DB        2 ; a&#x3D;9
47         DB        0 ; a&#x3D;10
48         DB        4 ; a&#x3D;11
49         DB        4 ; a&#x3D;12
50         DB        4 ; a&#x3D;13
51         DB        4 ; a&#x3D;14
52         DB        4 ; a&#x3D;15
53         DB        4 ; a&#x3D;16
54         DB        4 ; a&#x3D;17
55         DB        4 ; a&#x3D;18
56         DB        4 ; a&#x3D;19
57         DB        2 ; a&#x3D;20
58         DB        2 ; a&#x3D;21
59         DB        3 ; a&#x3D;22
60 _f      ENDP<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Ê±áÁºñËß£ËØª:</p>
<ul>
<li>
<p>ËøôÈáå‰ΩøÁî®‰∫Ü‰∏§‰∏™Ë°®Ôºå‰∏Ä‰∏™ÊòØÁ¥¢ÂºïË°®$LN10@f,Âè¶‰∏Ä‰∏™ËΩ¨ÁßªË°®ÊòØ$LN11@f</p>
</li>
<li>
<p><code>movzx</code> ÊòØÊ±áÁºñËØ≠Ë®Ä‰∏≠ÁöÑ‰∏Ä‰∏™Êåá‰ª§ÔºåÂÆÉÊòØ <code>move with zero extend</code> ÁöÑÁº©ÂÜôÔºåÁî®‰∫éÊó†Á¨¶Âè∑Êâ©Â±ïÂπ∂‰º†ÈÄÅÊï∞ÊçÆ„ÄÇÊ≠§Êåá‰ª§‰∏ªË¶ÅÁî®‰∫éÂ∞Ü‰∏Ä‰∏™ËæÉÂ∞è‰ΩçÂÆΩÁöÑÊï∞ÊçÆÔºàÈÄöÂ∏∏ÊòØ8‰ΩçÊàñ16‰ΩçÔºâÂä†ËΩΩÂà∞‰∏Ä‰∏™ËæÉÂ§ß‰ΩçÂÆΩÁöÑÂØÑÂ≠òÂô®ÊàñÂÜÖÂ≠ò‰ΩçÁΩÆ‰∏≠ÔºåÂπ∂Âú®<mark>Êâ©Â±ïÈ´ò‰ΩçÊó∂Áî®0Â°´ÂÖÖ„ÄÇ</mark></p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">1mov bl, 80h   ; Â∞Ü8‰ΩçÁ´ãÂç≥Êï∞80hÈÄÅÂÖ•8‰ΩçÂØÑÂ≠òÂô®BL
2movzx ax, bl  ; Â∞ÜBLÁöÑÂÜÖÂÆπÊó†Á¨¶Âè∑Êâ©Â±ïÂà∞16‰ΩçÔºåÂπ∂ÊîæÂÖ•AXÂØÑÂ≠òÂô®<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>Âú®Ëøô‰∏™‰æãÂ≠ê‰∏≠Ôºå<code>BL</code> ÂØÑÂ≠òÂô®‰∏≠ÁöÑÂÄºÊòØ <code>80h</code>ÔºàÂçÅËøõÂà∂128ÔºâÔºåÂΩì‰ΩøÁî® <code>movzx</code> Êåá‰ª§Â∞Ü <code>BL</code> ÁöÑÂÜÖÂÆπÂ§çÂà∂Âà∞ <code>AX</code> ÂØÑÂ≠òÂô®Êó∂ÔºåÂõ†‰∏∫ÊòØÊó†Á¨¶Âè∑Êâ©Â±ïÔºåÊâÄ‰ª• <code>BL</code> ÁöÑÂÄºË¢´Êâ©Â±ï‰∏∫ <code>0080h</code>ÔºàÂâçÂØºÁöÑÈ´ò‰ΩçË°•0ÔºâÔºåËøôÊ†∑ <code>AX</code> ÂØÑÂ≠òÂô®ÁöÑÂÄºÂ∞±ÂèòÊàê‰∫Ü <code>0080h</code>„ÄÇ</p>
</li>
<li>
<p>È¶ñÂÖàmovzxÊåá‰ª§Âú®Á¥¢ÂºïË°®‰∏≠Êü•ËØ¢ËæìÂÖ•ÂÄº,ËøîÂõû0(input1,2,7,10);1(input3,4,5),2(input8,9,21),3(input 22)4(default)</p>
</li>
<li>
<p>ÁÑ∂ÂêéÊääÁº©ÂΩ±Ë°®ÁöÑËøîÂõûÂÄºÔºåÂú®Á¨¨‰∫å‰∏™ËΩ¨ÁßªË°®‰∏≠ÂÆåÊàêË∑≥ËΩ¨s</p>
</li>
</ul>
<hr />
<h3 id="fall-through"><a class="markdownIt-Anchor" href="#fall-through"></a> fall-through</h3>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"> <span class="token number">1</span> #define R <span class="token number">1</span>
 <span class="token number">2</span> #define W <span class="token number">2</span>
 <span class="token number">3</span> #define RW <span class="token number">3</span>
 <span class="token number">4</span>
 <span class="token number">5</span> <span class="token keyword">void</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token keyword">int</span> type<span class="token punctuation">)</span>
 <span class="token number">6</span> <span class="token punctuation">&#123;</span>
 <span class="token number">7</span>          <span class="token keyword">int</span> read<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> write<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
 <span class="token number">8</span>
 <span class="token number">9</span>          <span class="token keyword">switch</span> <span class="token punctuation">(</span>type<span class="token punctuation">)</span>
<span class="token number">10</span>          <span class="token punctuation">&#123;</span>
<span class="token number">11</span>          <span class="token keyword">case</span> RW<span class="token operator">:</span>
<span class="token number">12</span>                   read<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token number">13</span>          <span class="token keyword">case</span> W<span class="token operator">:</span>
<span class="token number">14</span>                   write<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token number">15</span>                   <span class="token keyword">break</span><span class="token punctuation">;</span>
<span class="token number">16</span>          <span class="token keyword">case</span> R<span class="token operator">:</span>
<span class="token number">17</span>                   read<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token number">18</span>                   <span class="token keyword">break</span><span class="token punctuation">;</span>
<span class="token number">19</span>          <span class="token keyword">default</span><span class="token operator">:</span>
<span class="token number">20</span>                   <span class="token keyword">break</span><span class="token punctuation">;</span>
<span class="token number">21</span>          <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token number">22</span>          <span class="token function">printf</span> <span class="token punctuation">(</span><span class="token string">"read=%d, write=%d\n"</span><span class="token punctuation">,</span> read<span class="token punctuation">,</span> write<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token number">23</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Êó†ËÆ∫typeÁöÑÂÄºÊòØRWËøòÊòØWÔºåÁ®ãÂ∫èÈÉΩ‰ºöÊâßË°åÁ¨¨14Ë°åÁöÑÊåá‰ª§„ÄÇtype‰∏∫RWÁöÑÈôàËø∞ËØ≠Âè•ÈáåÊ≤°ÊúâbreakÊåá‰ª§Ôºå‰ªéËÄåÂà©Áî®switchËØ≠Âè•ÁöÑfall throughÊïàÂ∫î„ÄÇ</p>
<p>msvs x86 assembly</p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">$SG1305 DB       &#39;read&#x3D;%d, write&#x3D;%d&#39;, 0aH, 00H

_write$ &#x3D; -12    ; size&#x3D; 4
_read$  &#x3D; -8     ; size&#x3D; 4
tv64  &#x3D; -4       ; size&#x3D; 4
_type$  &#x3D; 8      ; size&#x3D; 4
_f        PROC
          push   ebp
          mov    ebp, esp
          sub    esp, 12;int write,read,tv64
          mov    DWORD PTR _read$[ebp], 0;read&#x3D;0
          mov    DWORD PTR _write$[ebp], 0;write&#x3D;0
          mov    eax, DWORD PTR _type$[ebp];eax&#x3D;type
          mov    DWORD PTR tv64[ebp], eax;tv64&#x3D;type
          cmp    DWORD PTR tv64[ebp], 1 ; R
          je     SHORT $LN2@f
          cmp    DWORD PTR tv64[ebp], 2 ; W
          je     SHORT $LN3@f;Êó†breakËØ≠Âè•
          cmp    DWORD PTR tv64[ebp], 3 ; RW
          je     SHORT $LN4@f
          jmp    SHORT $LN5@f;break
$LN4@f: ; case RW:
          mov    DWORD PTR _read$[ebp], 1
$LN3@f: ; case W:
          mov    DWORD PTR _write$[ebp], 1
          jmp    SHORT $LN5@f
$LN2@f: ; case R:
          mov    DWORD PTR _read$[ebp], 1
$LN5@f: ;printf
          mov    ecx, DWORD PTR _write$[ebp]
          push   ecx
          mov    edx, DWORD PTR _read$[ebp]
          push   edx
          push   OFFSET $SG1305 ; &#39;read&#x3D;%d, write&#x3D;%d&#39;
          call   _printf
          add    esp, 12
          mov    esp, ebp
          pop    ebp
          ret    0
_f        ENDP<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="chap14-Âæ™ÁéØ"><a class="markdownIt-Anchor" href="#chap14-Âæ™ÁéØ"></a> Chap14 Âæ™ÁéØ</h2>
<p>x86Êåá‰ª§ÈõÜÈáåÊúâ‰∏ÄÊù°‰∏ìÈó®ÁöÑLOOPÊåá‰ª§„ÄÇ<mark>LOOPÊåá‰ª§Ê£ÄÊµãECXÂØÑÂ≠òÂô®ÁöÑÂÄºÊòØÂê¶ÊòØ0ÔºåÂ¶ÇÊûúÂÆÉ‰∏çÊòØ0ÂàôÂ∞ÜÂÖ∂ÈÄíÂáèÔºåÂπ∂Â∞ÜÊìç‰ΩúÊùÉ‰∫§ÁªôÊìç‰ΩúÁ¨¶ÊâÄÊåáÂÆöÁöÑÊ†áÁ≠æÂ§ÑÔºàÂç≥Ë∑≥ËΩ¨Ôºâ</mark>„ÄÇÊàñËÆ∏ÊòØÂõ†‰∏∫Âæ™ÁéØÊåá‰ª§Ëøá‰∫éÂ§çÊùÇÁöÑÁºòÊïÖÔºåËá≥‰ªäÂ∞öÊú™ËßÅËøáÁõ¥Êé•‰ΩøÁî®LOOPÊåá‰ª§Â∞ÜÂæ™ÁéØËØ≠Âè•ËΩ¨ËØëÊàêÊ±áÁºñËØ≠Âè•ÁöÑÁºñËØëÂô®„ÄÇÊâÄ‰ª•ÔºåÂ¶ÇÊûú<mark>Âì™‰∏™Á®ãÂ∫èÁõ¥Êé•‰ΩøÁî®LOOPÊåá‰ª§ËøõË°åÂæ™ÁéØÊéßÂà∂ÔºåÈÇ£ÂÆÉÂæàÂèØËÉΩÂ∞±ÊòØÊâãÂÜôÁöÑÊ±áÁºñÁ®ãÂ∫è„ÄÇ</mark></p>
<h3 id="for"><a class="markdownIt-Anchor" href="#for"></a> for</h3>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>

<span class="token keyword">void</span> <span class="token function">printing_function</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
        <span class="token function">printf</span> <span class="token punctuation">(</span><span class="token string">"f(%d)\n"</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
<span class="token punctuation">&#123;</span>
        <span class="token keyword">int</span> i<span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
                <span class="token function">printing_function</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span> 
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">_i$ &#x3D; -4 
_main   PROC
    push   ebp
    mov    ebp, esp
    push   ecx
    mov    DWORD PTR _i$[ebp], 2     ; ÂàùÂßãÊÄÅ;i&#x3D;2
    jmp    SHORT $LN3@main
$LN2@main:
    mov    eax, DWORD PTR _i$[ebp]     ; Âæ™ÁéØÊéßÂà∂ËØ≠Âè•Ôºö
    add    eax, 1                      ; iÈÄíÂ¢û1
    mov    DWORD PTR _i$[ebp], eax
$LN3@main:
    cmp    DWORD PTR _i$[ebp], 10      ; Âà§Êñ≠ÊòØÂê¶Êª°Ë∂≥Âæ™ÁéØÊù°‰ª∂ if i&#x3D;&#x3D;10
    jge    SHORT $LN1@main             ; Â¶ÇÊûúi&#x3D;10 ÂàôÁªàÊ≠¢Âæ™ÁéØËØ≠Âè•
    mov    ecx, DWORD PTR _i$[ebp]     ; Âæ™ÁéØ‰Ωì: call f(i)
    push   ecx;‰º†ÂèÇ
    call   _printing_function
    add    esp, 4
    jmp    SHORT $LN2@main             ; Ë∑≥Âà∞Âæ™ÁéØÂºÄÂßãÂ§Ñ
$LN1@main: ;exit                            ; Âæ™ÁéØÁªìÊùü
    xor    eax, eax
    mov    esp, ebp
    pop    ebp
    ret     0
_main    ENDP<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<hr />
<p>gcc</p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">main            proc near    ; ÂºÄÂßãÂÆö‰πâ‰∏ªÁ®ãÂ∫èËøáÁ®ã

var_20          &#x3D; dword    ptr -20h  ; ÂÆö‰πâ‰∏Ä‰∏™ÂèòÈáèvar_20ÔºåÂú®Ê†à‰∏äË∑ùÁ¶ªEBP-20hÁöÑ‰ΩçÁΩÆ
var_4           &#x3D; dword    ptr ‚Äì4     ; ÂÆö‰πâÂè¶‰∏Ä‰∏™ÂèòÈáèvar_4ÔºåÂú®Ê†à‰∏äË∑ùÁ¶ªEBP-4ÁöÑ‰ΩçÁΩÆ

                push       ebp         ; ‰øùÂ≠òÂΩìÂâçÂü∫ÂùÄÊåáÈíàÔºàEBPÔºâ
                mov        ebp, esp    ; Â∞ÜÊ†àÈ°∂ÊåáÈíàÔºàESPÔºâÂ§çÂà∂Âà∞Âü∫ÂùÄÊåáÈíàÔºàEBPÔºâÔºåÂª∫Á´ãÊñ∞ÁöÑÂ†ÜÊ†àÂ∏ß
                and        esp, 0FFFFFFF0h ; Á°Æ‰øùESP‰∏∫16Â≠óËäÇÂØπÈΩêÔºåÈÄöËøá‰∏éÊìç‰ΩúÂéªÊéâESPÁöÑ‰Ωé4‰Ωç
                sub        esp, 20h    ; Âú®Ê†à‰∏ä‰∏∫Â±ÄÈÉ®ÂèòÈáèÂàÜÈÖçÁ©∫Èó¥ÔºåÂáèÂ∞èESP 32Â≠óËäÇ(20h)

                mov        [esp+20h+var_4], 2 ; ÂàùÂßãÂåñÂèòÈáèvar_4ÔºåÂç≥(i&#x3D;2)ÔºåËøôÈáåÂ≠òÁöÑÊòØÂæ™ÁéØËµ∑ÂßãÂÄº
                jmp        short loc_8048476 ; Êó†Êù°‰ª∂Ë∑≥ËΩ¨Âà∞Âæ™ÁéØÊù°‰ª∂Ê£ÄÊü•Â§ÑÂºÄÂßãÂæ™ÁéØ

loc_8048465:                  ; Âæ™ÁéØ‰ΩìÂºÄÂßã
                mov        eax, [esp+20h+var_4] ; ÊääËÆ°Êï∞Âô®(i)ÁöÑÂÄºÂä†ËΩΩÂà∞EAXÂØÑÂ≠òÂô®
                mov        [esp+20h+var_20], eax ; ÊääEAXÁöÑÂÄºÔºàÂç≥iÁöÑÂÄºÔºâÂ≠òÂÖ•var_20ÔºåÂèØËÉΩÊòØ‰∏∫Ë∞ÉÁî®ÂáÜÂ§áÂèÇÊï∞
                call       printing_function ; Ë∞ÉÁî®ÊâìÂç∞ÂáΩÊï∞ÔºåÂèØËÉΩÊâìÂç∞var_20‰∏≠ÁöÑÂÄº
                add        [esp+20h+var_4], 1 ; Â∞ÜËÆ°Êï∞Âô®(i)Âä†1ÔºåÂç≥i&#x3D;i+1

loc_8048476:                  ; Âæ™ÁéØÊù°‰ª∂Ê£ÄÊü•
                cmp        [esp+20h+var_4], 9 ; ÊØîËæÉËÆ°Êï∞Âô®(i)ÊòØÂê¶Â∞è‰∫éÁ≠â‰∫é9
                jle        short loc_8048465 ; Â¶ÇÊûúi&lt;&#x3D;9ÔºåÂàôË∑≥ËΩ¨ÂõûÂæ™ÁéØ‰ΩìÁªßÁª≠ÊâßË°å

                mov        eax, 0      ; ËÆæÁΩÆËøîÂõûÂÄº‰∏∫0ÔºåËøôÈáå‰Ωú‰∏∫Á®ãÂ∫èÊ≠£Â∏∏ÈÄÄÂá∫ÁöÑÊ†áÂøó
                leave                   ; ÊÅ¢Â§çÂÖàÂâçÁöÑÂ†ÜÊ†àÁä∂ÊÄÅÔºåÂ∞ÜESPËÆæÁΩÆÂõûEBPÁöÑÂÄºÔºåÁÑ∂ÂêéÂºπÂá∫EBP
                retn                    ; ËøîÂõûË∞ÉÁî®ËÄÖÔºåÁªìÊùüÁ®ãÂ∫è

main            endp             ; ÁªìÊùü‰∏ªÁ®ãÂ∫èËøáÁ®ãÂÆö‰πâ<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<hr />
<p>msvsÂºÄÂêØ‰ºòÂåñ</p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">_main    PROC
     push   esi
     mov    esi, 2
$LL3@main:
     push   esi
     call   _printing_function
     inc    esi
     add    esp, 4
     cmp    esi, 10     ; 0000000aH
     jl     SHORT $LL3@main
     xor    eax, eax
     pop    esi
     ret    0
_main    ENDP<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ÂºÄÂêØ‰ºòÂåñÂêéÔºå<code>ESI</code>ÂØÑÂ≠òÂô®Êàê‰∫ÜËÆ°Êï∞Âô®<code>i</code>ÁöÑ‰∏ìÁî®ÂØÑÂ≠òÂô®,Â§ßÂπÖÁÆÄÊ¥Å‰∫ÜÊ±áÁºñs</p>
<p><mark>ËøõË°åËøôÁßç‰ºòÂåñÁöÑÂâçÊèêÊù°‰ª∂ÊòØÔºöË¢´Ë∞ÉÁî®ÊñπÂáΩÊï∞‰∏çÂ∫îÂΩì‰øÆÊîπÂ±ÄÈÉ®ÂèòÈáè‰∏ìÁî®ÂØÑÂ≠òÂô®ÁöÑÂÄº„ÄÇÂΩìÁÑ∂ÔºåÂú®Êú¨‰æã‰∏≠ÁºñËØëÂô®ËÉΩÂ§üÂà§Êñ≠ÂáΩÊï∞printing_function ()‰∏ç‰ºö‰øÆÊîπESIÂØÑÂ≠òÂô®ÁöÑÂÄº„ÄÇÂú®ÁºñËØëÂô®ÂÜ≥ÂÆöÁªôÂ±ÄÈÉ®ÂèòÈáèÂàÜÈÖç‰∏ìÁî®ÂØÑÂ≠òÂô®ÁöÑÊó∂ÂÄôÔºåÂÆÉ‰ºöÂú®ÂáΩÊï∞Â∫èË®ÄÈÉ®ÂàÜ‰øùÂ≠òËøô‰∫õ‰∏ìÁî®ÂØÑÂ≠òÂô®ÁöÑÂàùÂßãÁä∂ÊÄÅÔºåÁÑ∂ÂêéÂú®ÂáΩÊï∞Â∞æÂ£∞ÈáåËøòÂéüËøô‰∫õÂØÑÂ≠òÂô®ÁöÑÂéüÂßãÂÄºÔºåÂõ†Ê≠§Â≠òÂú®<code>push esi</code>Âíå<code>pop esi</code>Êù•ËøòÂéüÂéüÂßãÂÄº</mark></p>
<hr />
<p><code>gcc -O3 -o 1 1,c</code></p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">main            proc near

var_10          &#x3D; dword ptr -10h

                push    ebp
                mov     ebp, esp
                and     esp, 0FFFFFFF0h
                sub     esp, 10h
                mov     [esp+10h+var_10], 2
                call    printing_function
                mov     [esp+10h+var_10], 3
                call    printing_function
                mov     [esp+10h+var_10], 4
                call    printing_function
                mov     [esp+10h+var_10], 5
                call    printing_function
                mov     [esp+10h+var_10], 6
                call    printing_function
                mov     [esp+10h+var_10], 7
                call    printing_function
                mov     [esp+10h+var_10], 8
                call    printing_function
                mov     [esp+10h+var_10], 9
                call    printing_function
                xor     eax, eax
                leave
                retn
main            endp<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>
<p>Âú®ËøôÈáåÔºågccÊääÂæ™ÁéØÊåá‰ª§ÁªôÂàÜËß£‰∫Ü(Â∞±ÊòØÁªôÂ±ïÂºÄ‰∫Ü)</p>
<p>ÁºñËØëÂô®‰ºöÂØπ<mark>Ëø≠‰ª£Ê¨°Êï∞ËæÉÂ∞ëÁöÑÂæ™ÁéØËøõË°åÂæ™ÁéØÂàÜËß£</mark>ÔºàLoop unwindingÔºâÂØπÂ§ÑÁêÜ„ÄÇÂ±ïÂºÄÂæ™ÁéØ‰Ωì‰ª•Âêé‰ª£Á†ÅÁöÑÊâßË°åÊïàÁéá‰ºöÊúâÊâÄÊèêÂçáÔºå‰ΩÜÊòØ‰ºöÂ¢ûÂä†Á®ãÂ∫è‰ª£Á†ÅÁöÑ‰ΩìÁßØ„ÄÇ</p>
</li>
<li>
<p><mark>Â¶ÇÊûúËø≠‰ª£Ê¨°Êï∞Â§öÁöÑËØùÔºågccÁöÑ‰ºòÂåñ‰ª£Á†ÅÂ∞±‰∏émsvsÁõ∏Â∑ÆÊó†Âá†</mark></p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">                public main
main            proc near

var_20          &#x3D; dword    ptr -20h

                push       ebp
                mov        ebp, esp
                and        esp, 0FFFFFFF0h
                push       ebx
                mov        ebx, 2 ; i&#x3D;2
                sub        esp, 1Ch

; aligning label loc_80484D0 (loop body begin) by 16-byte border:
                nop
loc_80484D0:
; pass (i) as first argument to printing_function():
                mov        [esp+20h+var_20], ebx
                add        ebx, 1 ; i++
                call       printing_function
                cmp        ebx, 64h ; i&#x3D;&#x3D;100?
                jnz        short loc_80484D0 ; if not, continue
                add        esp, 1Ch
                xor        eax, eax ; return 0
                pop        ebx
                mov        esp, ebp
                pop        ebp
                retn
main            endp<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Âå∫Âà´Âú®‰∫égccÊòØÊãøebx‰Ωú‰∏∫iÁöÑ‰∏ìÊúâÂØÑÂ≠òÂô®ÔºåÂÖ∂‰ªñ‰∏émsvsÁ±ª‰ºº</p>
</li>
</ul>
<hr />
<h3 id="ÂÜÖÂ≠òÂùóÂ§çÂà∂"><a class="markdownIt-Anchor" href="#ÂÜÖÂ≠òÂùóÂ§çÂà∂"></a> ÂÜÖÂ≠òÂùóÂ§çÂà∂</h3>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>

<span class="token keyword">void</span> <span class="token function">my_memcpy</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token operator">*</span> dst<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token operator">*</span> src<span class="token punctuation">,</span> <span class="token class-name">size_t</span> cnt<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
         <span class="token class-name">size_t</span> i<span class="token punctuation">;</span>
         <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>cnt<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
                  dst<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>src<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<hr />
<p><code>gcc -Os</code></p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">; RDI &#x3D; ÁõÆÊ†áÂú∞ÂùÄ;dst
; RSI &#x3D; Ê∫êÂú∞ÂùÄ;src
; RDX &#x3D; ÂùóÂ§ßÂ∞è;cnt

; Âú® 0 ÁöÑ‰ΩçÁΩÆÂàùÂßãÂåñËÆ°Êï∞Âô®ÔºàiÔºâ
xor     eax, eax   
 
.L2:    
; Â¶ÇÊûúÊâÄÊúâÂ≠óËäÇÂ∑≤Â§çÂà∂ÔºåÂàôÈÄÄÂá∫Ôºö
cmp     rax, rdx   ; ÂØπÂØÑÂ≠òÂô®raxÂíårdxÁöÑÂÄºËøõË°åÊØîËæÉ„ÄÇ   
je      .L5    ; Â¶ÇÊûúËøô‰∏§‰∏™ÂÄºÁõ∏Á≠âÔºàÂç≥Â∑≤ÁªèÊã∑Ë¥ù‰∫ÜËßÑÂÆöÁöÑÂ≠óËäÇÊï∞ÔºâÔºåÂ∞±Ë∑≥ËΩ¨Âà∞.L5ÔºåÂç≥ËøîÂõûÔºàretÔºâ„ÄÇ

; Âú® RSI+i Â§ÑÂä†ËΩΩÂ≠óËäÇÔºö
mov     cl, BYTE PTR [rsi+rax]   ; Â∞ÜÂú∞ÂùÄ‰∏∫Ôºàrsi+raxÔºâÁöÑ‰∏Ä‰∏™Â≠óËäÇÂÄºÂä†ËΩΩÂà∞clÂØÑÂ≠òÂô®‰∏≠„ÄÇ

; Âú® RDI+i Â§ÑÂ≠òÂÇ®Â≠óËäÇÔºö
mov     BYTE PTR [rdi+rax], cl   ; Â∞ÜclÂØÑÂ≠òÂô®ÁöÑÂÄºÂ≠òÂÇ®Âà∞Âú∞ÂùÄ‰∏∫Ôºàrdi+raxÔºâÁöÑÂÜÖÂ≠ò‰∏≠„ÄÇ

inc     rax   ; i++ÔºåÂ∞ÜraxÂØÑÂ≠òÂô®ÁöÑÂÄºÂ¢ûÂä†1Ôºå‰ª•‰æø‰∏ã‰∏ÄÊ¨°Â§çÂà∂‰∏ã‰∏Ä‰∏™Â≠óËäÇ„ÄÇ
jmp     .L2   ; Êó†Êù°‰ª∂Ë∑≥ËΩ¨Âà∞.L2ÔºåËøõË°å‰∏ã‰∏ÄËΩÆÁöÑÊØîËæÉÂíåÂ≠óËäÇÊã∑Ë¥ù„ÄÇ

.L5:
ret    ; ÂáΩÊï∞ËøîÂõûÔºåÁªìÊùüÊã∑Ë¥ùÊìç‰Ωú„ÄÇ<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="ÊÄªÁªì"><a class="markdownIt-Anchor" href="#ÊÄªÁªì"></a> ÊÄªÁªì</h3>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">    MOV [counter], 2 ; initialization
    JMP label_check
label_increment:
    ADD [counter], 1 ; increment
label_check:
    CMP [counter], 10
    JGE exit
    ; loop body
    ; do something here
    ; use counter variable in local stack
    JMP label_increment
exit:<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ÈÄöÂ∏∏ÊÉÖÂÜµ‰∏ãÔºåÁ®ãÂ∫èÂ∫îÂΩìÈ¶ñÂÖàÂà§Êñ≠Âæ™ÁéØÊù°‰ª∂ÊòØÂê¶Êª°Ë∂≥ÔºåÁÑ∂ÂêéÂÜçÊâßË°åÂæ™ÁéØ‰Ωì„ÄÇ‰ΩÜÊòØÂú®ÁºñËØëÂô®Á°ÆÂÆöÁ¨¨‰∏ÄÊ¨°Ëø≠‰ª£ËÇØÂÆö‰ºöÂèëÁîüÁöÑÊÉÖÂÜµ‰∏ãÔºåÂÆÉÂèØËÉΩ‰ºöË∞ÉÊç¢Âæ™ÁéØ‰ΩìÂíåÂà§Êñ≠ËØ≠Âè•ÁöÑÈ°∫Â∫è„ÄÇ‰∏ãÈù¢Ëøô‰∏™Á®ãÂ∫èÂ∞±ÊòØ‰∏™ÂÖ∏ÂûãÁöÑ‰æãÂ≠ê„ÄÇ</p>
<p>Êåá‰ª§Ê∏ÖÂçï14.19„ÄÄx86</p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">    MOV REG, 2 ; initialization
body:
    ; loop body
    ; do something here
    ; use counter in REG, but do not modify it!
    INC REG ; increment
    CMP REG, 10
    JL body<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ÁºñËØëÂô®‰∏ç‰ºö‰ΩøÁî®LOOPÊåá‰ª§„ÄÇÁî±LOOPÊéßÂà∂ÁöÑÂæ™ÁéØÊéßÂà∂ËØ≠Âè•ÊØîËæÉÂ∞ëËßÅ„ÄÇÂ¶ÇÊûúÊüêÊÆµ‰ª£Á†ÅÂ∏¶ÊúâLOOPÊåá‰ª§ÔºåÈÇ£‰πàÊÇ®Â∫îÂΩìËÆ§‰∏∫ËøôÊòØÊâãÂÜôÂá∫Êù•ÁöÑÊ±áÁºñÁ®ãÂ∫è„ÄÇ</p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">    ; count from 10 to 1
    MOV ECX, 10
body:
    ; loop body
    ; do something here
    ; use counter in ECX, but do not modify it!
    LOOP body<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>ECX</code>‰Ωú‰∏∫countÁöÑ‰∏ìÁî®ÂØÑÂ≠òÂô®</p>
<h3 id="problem-2"><a class="markdownIt-Anchor" href="#problem-2"></a> Problem</h3>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">;</span>i<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">--</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">;</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<ol start="4">
<li></li>
</ol>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">100</span><span class="token punctuation">;</span>i<span class="token operator">+=</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="chap15-cËØ≠Ë®ÄÂ≠óÁ¨¶‰∏≤ÁöÑÂáΩÊï∞"><a class="markdownIt-Anchor" href="#chap15-cËØ≠Ë®ÄÂ≠óÁ¨¶‰∏≤ÁöÑÂáΩÊï∞"></a> Chap15 CËØ≠Ë®ÄÂ≠óÁ¨¶‰∏≤ÁöÑÂáΩÊï∞</h2>
<h3 id="strlen"><a class="markdownIt-Anchor" href="#strlen"></a> strlen()</h3>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">my_strlen</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span> str<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>eos<span class="token operator">=</span>str<span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">*</span>eos<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">(</span>eos<span class="token operator">-</span>str<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token function">my_strlen</span><span class="token punctuation">(</span><span class="token string">"hello!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<hr />
<p><code>Non-optimizing MSVS</code></p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">_eos$ &#x3D; -4                            ; ÂÆö‰πâÂ±ÄÈÉ®ÂèòÈáèeosÁöÑÊ†àÂÅèÁßªÈáè‰∏∫-4
_str$ &#x3D; 8                             ; ÂÆö‰πâÂèÇÊï∞strÁöÑÊ†àÂÅèÁßªÈáè‰∏∫8
_strlen PROC
    push    ebp                       ; ‰øùÂ≠òÂü∫ÂùÄÊåáÈíà
    mov     ebp, esp                  ; ËÆæÁΩÆÊñ∞ÁöÑÂü∫ÂùÄÊåáÈíà
    push    ecx                       ; ‰øùÂ≠òecxÂØÑÂ≠òÂô®ÁöÑÂÄº
    mov     eax, DWORD PTR _str$[ebp] ; Â∞Ü‰º†ÂÖ•ÁöÑÂ≠óÁ¨¶‰∏≤ÊåáÈíàÂ≠òÂÇ®Âà∞eax‰∏≠
    mov     DWORD PTR _eos$[ebp], eax ; Â∞ÜeaxÁöÑÂÄºÔºàÂç≥Â≠óÁ¨¶‰∏≤ÊåáÈíàÔºâ‰øùÂ≠òÂà∞Â±ÄÈÉ®ÂèòÈáèeos ‰∏≠
$LN2@strlen_:
    mov     ecx, DWORD PTR _eos$[ebp] ; Â∞ÜeosÁöÑÂÄºÂä†ËΩΩÂà∞ecx‰∏≠

    ; ‰ªéecxÊåáÂêëÁöÑÂú∞ÂùÄÂ§ÑÂèñ8‰ΩçÂ≠óËäÇÔºåÂπ∂Â∞ÜÂÖ∂‰Ωú‰∏∫32‰ΩçÂÄºÔºàÂ∏¶Á¨¶Âè∑Êâ©Â±ïÔºâÂä†ËΩΩÂà∞edx‰∏≠
    movsx   edx, BYTE PTR [ecx];edx&#x3D;*eos
    mov     eax, DWORD PTR _eos$[ebp] ; Â∞ÜeosÁöÑÂÄºÂä†ËΩΩÂà∞eax‰∏≠
    add     eax, 1                    ; Â∞ÜeaxËá™Â¢û1ÔºåÊåáÂêë‰∏ã‰∏Ä‰∏™Â≠óÁ¨¶
    mov     DWORD PTR _eos$[ebp], eax ; Â∞ÜÊõ¥Êñ∞ÂêéÁöÑeaxÂÄº‰øùÂ≠òÂõûeos‰∏≠
    test    edx, edx                  ; ÊµãËØïedxÂØÑÂ≠òÂô®ÔºàÂç≥ÂΩìÂâçÂ≠óÁ¨¶ÊòØÂê¶‰∏∫0Ôºâ
    je      SHORT $LN1@strlen_        ; Â¶ÇÊûúedx‰∏∫0ÔºåË∑≥ËΩ¨Âà∞$LN1@strlen_ÔºåÁªìÊùüÂæ™ÁéØ
    jmp     SHORT $LN2@strlen_        ; Âê¶ÂàôÔºåÁªßÁª≠Âæ™ÁéØ

$LN1@strlen_:
    ; ËÆ°ÁÆó‰∏§‰∏™ÊåáÈíà‰πãÈó¥ÁöÑÂ∑ÆÂÄº

    mov    eax, DWORD PTR _eos$[ebp]  ; Â∞ÜeosÁöÑÂÄºÂä†ËΩΩÂà∞eax‰∏≠
    sub    eax, DWORD PTR _str$[ebp]  ; Áî®eosÂáèÂéªÂéüÂßãÂ≠óÁ¨¶‰∏≤ÊåáÈíà
    sub    eax, 1                     ; ÂáèÂéª1ÔºåÂæóÂà∞Â≠óÁ¨¶‰∏≤ÈïøÂ∫¶Ôºà‰∏çÂåÖÊã¨ÁªìÂ∞æÁöÑÁ©∫Â≠óÁ¨¶Ôºâ
    mov    esp, ebp                   ; ÊÅ¢Â§çÊ†àÊåáÈíà
    pop    ebp                        ; ÊÅ¢Â§çÂü∫ÂùÄÊåáÈíà
    ret    0                          ; ËøîÂõûÁªìÊûúÔºàeax‰∏≠‰øùÂ≠òÁùÄÂ≠óÁ¨¶‰∏≤ÈïøÂ∫¶Ôºâ
_strlen ENDP<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>
<p><code>MOVSX</code>,Âç≥<code>MOV with Sign Extend</code>,‰ªéÂÜÖÂ≠ò‰∏≠ËØªÂèñ8‰ΩçÊï∞ÊçÆÔºåÂπ∂Â≠òÂÇ®Âà∞32‰ΩçÂØÑÂ≠òÂô®Èáå</p>
<p>Êú¨‰æã‰∏≠ÔºåMOVSXÂ∞ÜÁî®ÂéüÂßãÊï∞ÊçÆÁöÑ8‰ΩçÊï∞ÊçÆÂ°´ÂÖÖEDXÂØÑÂ≠òÂô®ÁöÑ‰Ωé8‰ΩçÔºõ<mark>Â¶ÇÊûúÂéüÂßãÊï∞ÊçÆÊòØË¥üÊï∞ÔºåËØ•Êåá‰ª§Â∞Ü‰ΩøÁî®1Â°´ÂÖÖÁ¨¨8Âà∞Á¨¨31‰ΩçÔºàÈ´ò24‰ΩçÔºâÔºåÂê¶Âàô‰ΩøÁî®0Â°´ÂÖÖÈ´ò24‰Ωç</mark>„ÄÇ</p>
<p>ËøôÊòØ‰∏∫‰∫Ü‰øùËØÅÊúâÁ¨¶Âè∑ÂûãÊï∞ÊçÆÂú®Á±ªÂûãËΩ¨Êç¢ÂêéÁöÑÊï∞ÂÄº‰øùÊåÅ‰∏çÂèò„ÄÇ</p>
<p>‰∏æ‰∫Ü‰∏™‰æãÂ≠ê</p>
<p>ÂÅáÂ¶ÇcharÂûãÊï∞ÊçÆÁöÑÂéüÂßãÂÄºÊòØ‚àí2Ôºà0xFEÔºâÔºåÁõ¥Êé•ÊääÊï¥‰∏™Â≠óËäÇÂ§çÂà∂Âà∞intÂûãÊï∞ÊçÆÁöÑÊúÄ‰Ωé8‰Ωç‰∏äÊó∂ÔºåintÂûãÊï∞ÊçÆÁöÑÂÄºÂ∞±ÂèòÊàê0x000000FEÔºå‰ª•ÊúâÁ¨¶Âè∑ÂûãÊï∞ÊçÆÁöÑËßíÂ∫¶ÁúãÂÆÉË¢´ËΩ¨Êç¢‰∏∫254‰∫ÜÔºåËÄåÊ≤°Êúâ‰øùÊåÅÂéüÂßãÂÄº‚àí2„ÄÇ‚àí2ÂØπÂ∫îÁöÑintÂûãÊï∞ÊçÆÊòØ0xFFFFFFFE„ÄÇÊâÄ‰ª•ÔºåÂú®ÊääÂéüÂßãÊï∞ÊçÆÂ§çÂà∂Âà∞ÁõÆÊ†áÂèòÈáè‰πãÂêéÔºåËøòË¶Å‰ΩøÁî®Á¨¶Âè∑Ê†áÂøó‰ΩçÂ°´ÂÖÖÂâ©‰ΩôÁöÑÊï∞ÊçÆÔºåËÄåËøôÂ∞±ÊòØMOVSXÁöÑÂäüËÉΩ„ÄÇ</p>
</li>
</ul>
<hr />
<p><code>Non-optimizing GCC</code></p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">				public strlen               ; ÂÖ¨ÂÖ±Ê†áÂøóÔºå‰ΩøÂæóÂÖ∂‰ªñÊ®°ÂùóÂèØ‰ª•Ë∞ÉÁî®ËØ•ÂáΩÊï∞
strlen           proc near                   ; Â£∞Êòé‰∏Ä‰∏™nearËøáÁ®ãÔºåÂëΩÂêç‰∏∫strlen

eos              &#x3D; dword ptr -4               ; ÂÆö‰πâÂ±ÄÈÉ®ÂèòÈáèeosÁöÑÊ†àÂÅèÁßªÈáè‰∏∫-4
arg_0            &#x3D; dword ptr  8               ; ÂÆö‰πâÂèÇÊï∞arg_0ÔºàÂ≠óÁ¨¶‰∏≤ÊåáÈíàÔºâÁöÑÊ†àÂÅèÁßªÈáè‰∏∫8

                 push    ebp                  ; ‰øùÂ≠òÂü∫ÂùÄÊåáÈíà
                 mov     ebp, esp             ; ËÆæÁΩÆÊñ∞ÁöÑÂü∫ÂùÄÊåáÈíà
                 sub     esp, 10h             ; ‰∏∫Â±ÄÈÉ®ÂèòÈáèÂàÜÈÖç16Â≠óËäÇÁöÑÊ†àÁ©∫Èó¥
                 mov     eax, [ebp+arg_0]     ; Â∞Ü‰º†ÂÖ•ÁöÑÂ≠óÁ¨¶‰∏≤ÊåáÈíàÂä†ËΩΩÂà∞eax‰∏≠
                 mov     [ebp+eos], eax       ; Â∞ÜeaxÁöÑÂÄºÔºàÂç≥Â≠óÁ¨¶‰∏≤ÊåáÈíàÔºâ‰øùÂ≠òÂà∞Â±ÄÈÉ®ÂèòÈáèeos‰∏≠
loc_80483F0:
                 mov     eax, [ebp+eos]       ; Â∞ÜeosÁöÑÂÄºÂä†ËΩΩÂà∞eax‰∏≠
                 movzx   eax, byte ptr [eax]  ; ‰ªéeaxÊåáÂêëÁöÑÂú∞ÂùÄÂ§ÑÂä†ËΩΩ‰∏Ä‰∏™Â≠óËäÇÔºåÂπ∂Èõ∂Êâ©Â±ï‰∏∫32‰Ωç
                 test    al, al               ; ÊµãËØïalÂØÑÂ≠òÂô®ÁöÑÂÄºÔºàÂç≥ÂΩìÂâçÂ≠óÁ¨¶ÊòØÂê¶‰∏∫0Ôºâ
                 setnz   al                   ; Â¶ÇÊûúal‰∏ç‰∏∫Èõ∂Ôºåal &#x3D; 1ÔºõÂê¶ÂàôÔºåal &#x3D; 0
                 add     [ebp+eos], 1         ; Â∞ÜeosËá™Â¢û1ÔºåÊåáÂêë‰∏ã‰∏Ä‰∏™Â≠óÁ¨¶
                 test    al, al               ; ÊµãËØïalÂØÑÂ≠òÂô®ÁöÑÂÄºÔºàÂç≥ÂΩìÂâçÂ≠óÁ¨¶ÊòØÂê¶‰∏∫Èõ∂Ôºâ
                 jnz     short loc_80483F0    ; Â¶ÇÊûúal‰∏ç‰∏∫Èõ∂ÔºåË∑≥ËΩ¨Âà∞loc_80483F0ÔºåÁªßÁª≠Âæ™ÁéØ

                 ; Âæ™ÁéØÁªìÊùüÔºàÂΩìÂâçÂ≠óÁ¨¶‰∏∫0ÔºâÔºåËÆ°ÁÆóÂ≠óÁ¨¶‰∏≤ÁöÑÈïøÂ∫¶
                 mov     edx, [ebp+eos]       ; Â∞ÜeosÁöÑÂÄºÂä†ËΩΩÂà∞edx‰∏≠
                 mov     eax, [ebp+arg_0]     ; Â∞Ü‰º†ÂÖ•ÁöÑÂ≠óÁ¨¶‰∏≤ÊåáÈíàÂä†ËΩΩÂà∞eax‰∏≠
                 mov     ecx, edx             ; Â∞ÜedxÁöÑÂÄºÂä†ËΩΩÂà∞ecx‰∏≠
                 sub     ecx, eax             ; ecx &#x3D; edx - eaxÔºåËÆ°ÁÆóeos‰∏éÂ≠óÁ¨¶‰∏≤Ëµ∑ÂßãÂú∞ÂùÄÁöÑÂ∑ÆÂÄº
                 mov     eax, ecx             ; Â∞ÜecxÁöÑÂÄºÂä†ËΩΩÂà∞eax‰∏≠
                 sub     eax, 1               ; eaxÂáèÂéª1ÔºåÂæóÂà∞Â≠óÁ¨¶‰∏≤ÁöÑÂÆûÈôÖÈïøÂ∫¶Ôºà‰∏çÂåÖÊã¨ÁªìÂ∞æÁöÑÁ©∫Â≠óÁ¨¶Ôºâ
                 leave                        ; ÊÅ¢Â§çÊ†àÊåáÈíàÂíåÂü∫ÂùÄÊåáÈíà
                 retn                         ; ËøîÂõûÁªìÊûúÔºàeax‰∏≠‰øùÂ≠òÁùÄÂ≠óÁ¨¶‰∏≤ÈïøÂ∫¶Ôºâ
strlen           endp                        ; ËøáÁ®ãÁªìÊùü<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>
<p>ËøôÈáå<code>sub esp,10h</code>,<code>eos</code>Âè™ÈúÄË¶Å4‰∏™Â≠óËäÇÔºå‰ΩÜÊòØ‰∏∫‰∫ÜÊª°Ë∂≥ÂØπÈΩêË¶ÅÊ±ÇÂàÜÈÖç‰∫ÜÈ¢ùÂ§ñÁöÑ12‰∏™Â≠óËäÇ</p>
</li>
<li>
<p><code>MOVZX</code>ÊòØ<code>MOV with Zero-Extent</code>ÁöÑÁº©ÂÜô,Â∞Ü8‰ΩçÊàñ16‰ΩçÊï∞ÊçÆËΩ¨Êç¢‰∏∫32‰ΩçÊï∞ÊçÆÁöÑÊó∂ÂÄôÔºåÂÆÉÁõ¥Êé•Â§çÂà∂ÂéüÂßãÊï∞ÊçÆÂà∞ÁõÆÊ†áÂØÑÂ≠òÂô®ÁöÑÁõ∏Â∫î‰Ωé‰ΩçÔºåÂπ∂‰∏î‰ΩøÁî®0Â°´ÂÖÖÂâ©‰ΩôÁöÑÈ´ò‰Ωç„ÄÇ</p>
<p>==Áõ∏ÂΩì‰∫é‰∏ÄÊ≠•ÂÆåÊàê‰∫Ü‚Äúxor eax, eax‚ÄùÂíå‚Äúmov alÔºå[Ê∫ê8/16‰ΩçÊï∞ÊçÆ]‚Äù2Êù°Êåá‰ª§</p>
</li>
<li>
<p><code>SETNZ</code>Êåá‰ª§:Â¶ÇÊûúALÁöÑÂÄº‰∏çÊòØ0ÔºåÂàô‚Äútest al, al‚ÄùÊåá‰ª§‰ºöËÆæÁΩÆÊ†áÂøóÂØÑÂ≠òÂô®ZF=0ÔºõËÄåSETNZÔºàNot ZeroÔºâÊåá‰ª§‰ºöÂú®ZFÔºù0ÁöÑÊó∂ÂÄôÔºåËÆæÁΩÆALÔºù1„ÄÇÁî®ÁôΩËØùËß£ËØ¥ÔºåÂ∞±ÊòØÔºö<mark>Â¶ÇÊûúAL‰∏çÁ≠â‰∫é0ÔºåÂàôË∑≥Âà∞loc_80483F0Â§Ñ</mark>„ÄÇÁºñËØëÂô®ËΩ¨ËØëÂá∫Êù•ÁöÑ‰ª£Á†Å‰∏≠ÔºåÊúâ‰∫õ‰ª£Á†ÅÁ°ÆÂÆûÊ≤°ÊúâÂÆûÈôÖÊÑè‰πâ</p>
</li>
</ul>
<hr />
<p><code>Optimizing MSVS</code></p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">_str$ &#x3D; 8                                     ; size &#x3D; 4
_strlen PROC
        mov     edx, DWORD PTR _str$[esp-4]   ;Áî®EDX‰ΩúÂ≠óÁ¨¶‰∏≤ÊåáÈíà
        mov     eax, edx                      ;  Â§çÂà∂Âà∞ EAX

$LL2@strlen:
        mov     cl, BYTE PTR [eax]            ; CL &#x3D; *EAX
        inc     eax                           ; EAX++
        test    cl, cl                        ; CL&#x3D;&#x3D;0?
        jne     SHORT $LL2@strlen             ; no, continue loop
        sub     eax, edx                      ; ËÆ°ÁÆóÊåáÈíàÁöÑÂèòÂåñÈáè
        dec     eax                           ; decrement EAX
        ret     0
_strlen ENDP<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<hr />
<p><code>Optimizing GCC</code> <code>-O3</code></p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">                public strlen
strlen          proc near

arg_0           &#x3D; dword ptr  8

                push    ebp
                mov     ebp, esp
                mov     ecx, [ebp+arg_0];ecx&#x3D;arg_0;
                mov     eax, ecx;eax&#x3D;arg_0

loc_8048418:
                movzx   edx, byte ptr [eax];edx&#x3D;*eop
                add     eax, 1;eop++
                test    dl, dl;if dl &#x3D;&#x3D;0?
                jnz     short loc_8048418;dl !&#x3D;0,loop
                not     ecx
                add     eax, ecx
                pop     ebp
                retn
strlen          endp<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>
<p><code>movzx</code>ÊõøÊç¢‰∏∫<code>mov dl byte ptr[eax]</code>‰πüÂèØÔºå‰ΩøÁî®<code>movzx</code>ÊàñËÆ∏ÊòØ‰∏∫‰∫Ü‰øùËØÅÂØÑÂ≠òÂô®ÁöÑÈ´òÂú∞ÂùÄ‰Ωç‰∏çÂê´ÊúâÂô™Èü≥Êï∞ÊçÆ</p>
</li>
<li>
<p><mark><code>NOT</code>ÔºåNOTÊåá‰ª§ÂØπÊìç‰ΩúÊï∞ÁöÑÊâÄÊúâbitÈÉΩËøõË°åÈùûËøêÁÆóÔºåÁ≠â‰ª∑‰∫é<code>XOR ECX,0xfffffffh</code>,<code>not ecx</code>ÁöÑÁªìÊûú‰∏éÊüêÊï∞Áõ∏Âä†,Áõ∏ÂΩì‰∫éÊüêÊï∞ÂáèÂéª<code>ECX</code>ÁÑ∂ÂêéÂÜçÂáè<code>1</code></mark></p>
<p>‰ªéËÄåÂæóÂà∞Ê≠£Á°ÆÁöÑÂ≠óÁ¨¶‰∏≤ÈïøÂ∫¶</p>
<p><code>not ecx</code>Áõ∏ÂΩì‰∫é<code>ecx=(-ecx)-1</code>ÔºåÁî±‰ΩçËøêÁÆóÂèØ‰ª•Êé®ÂØº</p>
</li>
</ul>
<hr />
<p>Problems:</p>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">_s$   &#x3D;  8
_f    PROC
           mov  edx, DWORD PTR _s$[esp-4];edx&#x3D;_s
           mov  cl, BYTE PTR [edx];cl&#x3D;*_s&#x3D;8
           xor  eax, eax
           test cl, cl
           je   SHORT $LN2@f;if cl&#x3D;&#x3D;0,exit
           npad 4    ; align next label
$LL4@f:
           cmp  cl, 32;
           jne  SHORT $LN3@f;if cl!&#x3D;32,jmp LN3
           inc  eax;eax++
$LN3@f:
           mov  cl, BYTE PTR [edx+1];cl&#x3D;*(_s+1)
           inc  edx;eax++
           test cl, cl
           jne  SHORT $LL4@f;if cl!&#x3D;0;jmp LL4
$LN2@f:
           ret  0
_f         ENDP
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>_s<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> count<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">*</span>_s<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">*</span>_s<span class="token operator">==</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//' 'Áõ∏ÂΩì‰∫éÁªüËÆ°Â≠óÁ¨¶‰∏≤ÁöÑÁ©∫Ê†ºÊï∞</span>
        <span class="token punctuation">&#123;</span>
            count<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> count<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ol start="2">
<li></li>
</ol>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">.LFB24:
        push      ebx                    ; ‰øùÂ≠ò ebx ÂØÑÂ≠òÂô®ÁöÑÂÄº
        mov       ecx, DWORD PTR [esp+8] ; Â∞ÜÂèÇÊï∞(ÂÅáËÆæÊòØÂ≠óÁ¨¶‰∏≤ÊåáÈíà)‰º†ÈÄíÁªô ecx
        xor       eax, eax               ; Â∞Ü eax ÂØÑÂ≠òÂô®Ê∏ÖÈõ∂ (ËÆ°Êï∞Âô®)
        movzx     edx, BYTE PTR [ecx]    ; Â∞ÜÂ≠óÁ¨¶‰∏≤ÁöÑÁ¨¨‰∏Ä‰∏™Â≠óÁ¨¶Âä†ËΩΩÂà∞ edx
        test      dl, dl                 ; ÊµãËØïËØ•Â≠óÁ¨¶ÊòØÂê¶‰∏∫ null (Â≠óÁ¨¶‰∏≤ÁªìÂ∞æ)
        je        .L2                    ; Â¶ÇÊûúÊòØ null, Ë∑≥ËΩ¨Âà∞ .L2 ÁªìÊùü
.L3:
        cmp       dl, 32                 ; ÊØîËæÉËØ•Â≠óÁ¨¶‰∏éÁ©∫Ê†º (ASCII 32)
        lea       ebx, [eax+1]           ; ËÆ°ÁÆóÂΩìÂâçËÆ°Êï∞Âô®ÂÄºÂä†1ÁöÑÂú∞ÂùÄ
        cmove     eax, ebx               ; Â¶ÇÊûúÂ≠óÁ¨¶ÊòØÁ©∫Ê†ºÔºåeax &#x3D; ebx (Âç≥eaxÂä†1)
        add       ecx, 1                 ; Â∞Ü ecx ÊåáÈíàÂâçÁßª‰∏Ä‰∏™Â≠óÁ¨¶
        movzx     edx, BYTE PTR [ecx]    ; Â∞Ü‰∏ã‰∏Ä‰∏™Â≠óÁ¨¶Âä†ËΩΩÂà∞ edx
        test      dl, dl                 ; ÊµãËØïËØ•Â≠óÁ¨¶ÊòØÂê¶‰∏∫ null
        jne       .L3                    ; Â¶ÇÊûú‰∏çÊòØ null, Ë∑≥ËΩ¨Âà∞ .L3 ÁªßÁª≠Â§ÑÁêÜ
.L2:
        pop       ebx                    ; ÊÅ¢Â§ç ebx ÂØÑÂ≠òÂô®ÁöÑÂÄº
        ret                              ; ËøîÂõû
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li><code>cmove</code> Êåá‰ª§ÊòØ x86 Ê±áÁºñ‰∏≠ÁöÑÊù°‰ª∂ÁßªÂä®Êåá‰ª§‰πã‰∏ÄÔºåÂÆÉÁöÑÂÖ®ÂêçÊòØ<code>conditional move if equal</code>„ÄÇËøôÊÑèÂë≥ÁùÄÂΩìÊª°Ë∂≥ÁªôÂÆöÊù°‰ª∂Êó∂Ôºå‰ªéÊ∫êÊìç‰ΩúÊï∞ÁßªÂä®Âà∞ÁõÆÊ†áÊìç‰ΩúÊï∞ÔºåËÄåÂ¶ÇÊûúÊù°‰ª∂‰∏çÊàêÁ´ãÔºåÂàô‰∏çËøõË°åÁßªÂä®.Â¶ÇÊûúÊØîËæÉÁªìÊûúÊòØÁõ∏Á≠âÔºàÂç≥ÂΩìÂâçÂ≠óÁ¨¶ÊòØÁ©∫Ê†ºÔºâ<code>eax=ebx=eax+1</code></li>
</ul>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>str<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> count<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">*</span>str<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">int</span> temp<span class="token operator">=</span>count<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">*</span>str<span class="token operator">==</span><span class="token number">32</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            count<span class="token operator">=</span>temp<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> count<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Ëøõ‰∏ÄÊ≠•ÁÆÄÂåñ‰ª£Á†ÅÂ∞±ÊòØËÆ°Êï∞ÊâÄÊúâÁ©∫Ê†ºÂ≠óÁ¨¶</p>
<h2 id="chap16-Êï∞Â≠¶ËÆ°ÁÆóÊåá‰ª§ÁöÑÊõøÊç¢"><a class="markdownIt-Anchor" href="#chap16-Êï∞Â≠¶ËÆ°ÁÆóÊåá‰ª§ÁöÑÊõøÊç¢"></a> Chap16 Êï∞Â≠¶ËÆ°ÁÆóÊåá‰ª§ÁöÑÊõøÊç¢</h2>
<p><code>Âá∫‰∫éÊÄßËÉΩ‰ºòÂåñÁöÑËÄÉËôëÔºåÁºñËØëÂô®ÂèØËÉΩ‰ºöÂ∞Ü1Êù°Êï∞Â≠¶ËøêÁÆóÊåá‰ª§ÊõøÊç¢‰∏∫ÂÖ∂‰ªñÁöÑ1Êù°„ÄÅÁîöËá≥ÊòØ‰∏ÄÁªÑÁ≠âÊïàÊåá‰ª§„ÄÇ</code>‰æãÂ¶Ç<code>LEA</code>Êåá‰ª§ÈÄöÂ∏∏Êõø‰ª£ÂÖ∂‰ªñÁÆÄÂçïËÆ°ÁÆóÊåá‰ª§Ôºå<code>ADD</code>‰∏é<code>SUB</code>ÂêåÊ†∑ÂèØ‰ª•Áõ∏‰∫íÊõøÊç¢</p>
<h3 id="‰πòÊ≥ï"><a class="markdownIt-Anchor" href="#‰πòÊ≥ï"></a> ‰πòÊ≥ï</h3>
<h4 id="ÊõøÊç¢‰∏∫Âä†Ê≥ïËøêÁÆó"><a class="markdownIt-Anchor" href="#ÊõøÊç¢‰∏∫Âä†Ê≥ïËøêÁÆó"></a> ÊõøÊç¢‰∏∫Âä†Ê≥ïËøêÁÆó</h4>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> a<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
         <span class="token keyword">return</span> a<span class="token operator">*</span><span class="token number">8</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>‰ΩøÁî®MSVC 2010ÔºàÂêØÁî®/OxÔºâËøõË°åÁºñËØëÔºåÁºñËØëÂô®‰ºöÊää‚Äú‰πò‰ª•8‚ÄùÁöÑËøêÁÆóÊåá‰ª§ÊãÜËß£‰∏∫3Êù°Âä†Ê≥ïÊåá‰ª§„ÄÇ</p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">mov     eax, DWORD PTR _a$[esp-4]
add     eax, eax
add     eax, eax
add     eax, eax
ret     0 <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="ÊõøÊç¢‰∏∫Áßª‰ΩçËøêÁÆó"><a class="markdownIt-Anchor" href="#ÊõøÊç¢‰∏∫Áßª‰ΩçËøêÁÆó"></a> ÊõøÊç¢‰∏∫Áßª‰ΩçËøêÁÆó</h4>
<p>ÁºñËØëÂô®ÈÄöÂ∏∏‰ºöÊää‚Äú‰πò‰ª•2‚Äù‚ÄúÈô§‰ª•2‚ÄùÁöÑËøêÁÆóÊåá‰ª§Â§ÑÁêÜ‰∏∫‰ΩçÁßªËøêÁÆóÊåá‰ª§</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> a<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> a<span class="token operator">*</span><span class="token number">4</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">_a$ &#x3D; 8          ; size &#x3D; 4
_f       PROC
         push    ebp
         mov     ebp, esp
         mov     eax, DWORD PTR _a$[ebp]
         shl     eax, 2;shift left
         pop     ebp
         ret     0
_f       ENDP<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="ÊõøÊç¢‰∏∫Áßª‰ΩçÂä†ÂáèÊ≥ïÁöÑÊ∑∑ÂêàËøêÁÆó"><a class="markdownIt-Anchor" href="#ÊõøÊç¢‰∏∫Áßª‰ΩçÂä†ÂáèÊ≥ïÁöÑÊ∑∑ÂêàËøêÁÆó"></a> ÊõøÊç¢‰∏∫Áßª‰Ωç,Âä†ÂáèÊ≥ïÁöÑÊ∑∑ÂêàËøêÁÆó</h4>
<p>Âç≥‰Ωø‰πòÊï∞ÊòØ7Êàñ17Ôºå‰πòÊ≥ïËøêÁÆó‰ªçÁÑ∂ÂèØ‰ª•Áî®Èùû‰πòÊ≥ïËøêÁÆóÊåá‰ª§ÈÖçÂêà‰ΩçÁßªÊåá‰ª§ÂÆûÁé∞„ÄÇ</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdint.h></span></span>

<span class="token keyword">int</span> <span class="token function">f1</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
         <span class="token keyword">return</span> a<span class="token operator">*</span><span class="token number">7</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">f2</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
         <span class="token keyword">return</span> a<span class="token operator">*</span><span class="token number">28</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">f3</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
         <span class="token keyword">return</span> a<span class="token operator">*</span><span class="token number">17</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">; a*7
_a$ &#x3D; 8
_f1      PROC
         mov     ecx, DWORD PTR _a$[esp-4]
; ECX&#x3D;a
         lea     eax, DWORD PTR [ecx*8]
; EAX&#x3D;ECX*8
         sub     eax, ecx
; EAX&#x3D;EAX-ECX&#x3D;ECX*8-ECX&#x3D;ECX*7&#x3D;a*7
         ret     0 
_f1     ENDP

; a*28
_a$ &#x3D; 8
_f2     PROC
         mov     ecx, DWORD PTR _a$[esp-4]
; ECX&#x3D;a
         lea     eax, DWORD PTR [ecx*8]
; EAX&#x3D;ECX*8
         sub     eax, ecx
; EAX&#x3D;EAX-ECX&#x3D;ECX*8-ECX&#x3D;ECX*7&#x3D;a*7
         shl     eax, 2
; EAX&#x3D;EAX&lt;&lt;2&#x3D;(a*7)*4&#x3D;a*28
         ret     0 
_f2     ENDP

; a*17
_a$ &#x3D; 8
_f3     PROC
         mov     eax, DWORD PTR _a$[esp-4]
; EAX&#x3D;a
         shl     eax, 4
; EAX&#x3D;EAX&lt;&lt;4&#x3D;EAX*16&#x3D;a*16
         add     eax, DWORD PTR _a$[esp-4]
; EAX&#x3D;EAX+a&#x3D;a*16+a&#x3D;a*17
         ret     0
_f3     ENDP<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="Èô§Ê≥ïËøêÁÆó"><a class="markdownIt-Anchor" href="#Èô§Ê≥ïËøêÁÆó"></a> Èô§Ê≥ïËøêÁÆó</h3>
<h4 id="ÊõøÊç¢‰∏∫‰ΩçÁßªËøêÁÆó"><a class="markdownIt-Anchor" href="#ÊõøÊç¢‰∏∫‰ΩçÁßªËøêÁÆó"></a> ÊõøÊç¢‰∏∫‰ΩçÁßªËøêÁÆó</h4>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> a<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
       <span class="token keyword">return</span> a<span class="token operator">/</span><span class="token number">4</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>shr eax,2</code></p>
<h3 id="problem-3"><a class="markdownIt-Anchor" href="#problem-3"></a> Problem</h3>
<ol>
<li></li>
</ol>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">_a$ &#x3D; 8
_f      PROC
        mov     ecx, DWORD PTR _a$[esp-4];ecx&#x3D;a
        lea     eax, DWORD PTR [ecx*8];eax&#x3D;a*8
        sub     eax, ecx;eax&#x3D;eax-a&#x3D;7a
        ret     0
_f      ENDP<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="chap17-fpu"><a class="markdownIt-Anchor" href="#chap17-fpu"></a> Chap17 FPU</h2>
<ul>
<li>
<p><code>FPUÊòØ‰∏ìÈó®Â§ÑÁêÜÊµÆÁÇπÊï∞ÁöÑËøêÁÆóÂçïÂÖÉÔºåÊòØCPUÁöÑ‰∏Ä‰∏™ÁªÑ‰ª∂„ÄÇ</code></p>
</li>
<li>
<p><code>IEEE 754 </code>Ê†áÂáÜËßÑÂÆö‰∫ÜËÆ°ÁÆóÊú∫Á®ãÂ∫èËÆæËÆ°ÁéØÂ¢É‰∏≠ÁöÑ‰∫åËøõÂà∂ÂíåÂçÅËøõÂà∂ÁöÑÊµÆÁÇπÊï∞ÁöÑ‰∫§Êç¢„ÄÅÁÆóÊúØÊ†ºÂºè‰ª•ÂèäÊñπÊ≥ï„ÄÇÁ¨¶ÂêàËøôÁßçÊ†áÂáÜÁöÑÊµÆÁÇπÊï∞Áî±Á¨¶Âè∑‰Ωç„ÄÅÂ∞æÊï∞ÔºàÂèàÁß∞‰∏∫ÊúâÊïàÊï∞Â≠ó„ÄÅÂ∞èÊï∞‰ΩçÔºâÂíåÊåáÊï∞‰ΩçÊûÑÊàê„ÄÇ</p>
</li>
<li>
<p>Âú®80486Â§ÑÁêÜÂô®ÈóÆ‰∏ñ‰πãÂâçÔºåFPUÔºà‰∏éCPU‰Ωç‰∫é‰∏çÂêåÁöÑËäØÁâáÔºâÂè´‰ΩúÂçè‰ΩúÔºàËæÖÂä©ÔºâÂ§ÑÁêÜÂô®„ÄÇËÄå‰∏îÈÇ£‰∏™Êó∂ÂÄôÁöÑFPUËøò‰∏çÂ±û‰∫é‰∏ªÊùøÁöÑÊ†áÂáÜÈÖçÁΩÆÔºõÂ¶ÇÊûúÊÉ≥Ë¶ÅÂú®‰∏ªÊùø‰∏äÂÆâË£ÖFPUÔºå‰∫∫‰ª¨ËøòÂæóÂçïÁã¨Ë¥≠‰π∞ÂÆÉ„ÄÇ</p>
<p>80486 DX‰πãÂêéÁöÑCPUÂ§ÑÁêÜÂô®ÈõÜÊàê‰∫ÜFPUÁöÑÂäüËÉΩ„ÄÇ</p>
<p>Ëã•Ê≤°ÊúâFWAITÊåá‰ª§Âíåopcode‰ª•D8ÔΩûDFÂºÄÂ§¥ÁöÑÊâÄË∞ìÁöÑ‚ÄúESC‚ÄùÂ≠óÁ¨¶Êåá‰ª§Ôºàopcode‰ª•D8ÔΩûDFÂºÄÂ§¥ÔºâÔºåÊÅêÊÄïÂæàÂ∞ëÊúâ‰∫∫Ëøò‰ºöÊÉ≥Ëµ∑FPUÂ±û‰∫éÁã¨Á´ãËøêÁÆóÂçïÂÖÉÁöÑËøôÊÆµÂéÜÂè≤„ÄÇFWAITÊåá‰ª§ÁöÑ‰ΩúÁî®ÊòØËÆ©CPUÁ≠âÂæÖFPUËøêÁÆóÁªìÊùüÔºåËÄåESCÂ≠óÁ¨¶Êåá‰ª§ÈÉΩÂú®FPU‰∏äÊâßË°å„ÄÇ</p>
<p>FPUËá™Â∏¶‰∏Ä‰∏™Áî±<code>8‰∏™80‰ΩçÂØÑÂ≠òÂô®ÊûÑÊàêÁöÑÂæ™ÁéØÊ†à</code>„ÄÇËøô‰∫õ80‰ΩçÂØÑÂ≠òÂô®Áî®‰ª•Â≠òÂÇ®IEEE 754Ê†ºÂºèÁöÑÊµÆÁÇπÊï∞ÊçÆÔºåÈÄöÂ∏∏Âè´‰Ωú<code>ST(0)ÔΩûST(7)ÂØÑÂ≠òÂô®</code>„ÄÇIDAÂíåOllyDbgÈÉΩÊääST(0)ÊòæÁ§∫‰∏∫ST„ÄÇ‰πüÊúâ‰∏çÂ∞ëÊïôÁßë‰π¶ÊääST(0)Âè´‰Ωú‚ÄúÊ†àÈ°∂/Stack Top‚ÄùÂØÑÂ≠òÂô®„ÄÇ</p>
</li>
</ul>
<hr />
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>

<span class="token keyword">double</span> <span class="token function">f</span> <span class="token punctuation">(</span><span class="token keyword">double</span> a<span class="token punctuation">,</span> <span class="token keyword">double</span> b<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
          <span class="token keyword">return</span> a<span class="token operator">/</span><span class="token number">3.14</span> <span class="token operator">+</span> b<span class="token operator">*</span><span class="token number">4.1</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
<span class="token punctuation">&#123;</span>
          <span class="token function">printf</span> <span class="token punctuation">(</span><span class="token string">"%f\n"</span><span class="token punctuation">,</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token number">1.2</span><span class="token punctuation">,</span> <span class="token number">3.4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">CONST    SEGMENT
__real@4010666666666666 DQ 04010666666666666r ; 4.1    ; ÂÆö‰πâÂ∏∏Èáè4.1ÔºåÂ≠òÂÇ®Âú®ÊÆµ&#96;CONST&#96;‰∏≠
CONST    ENDS
CONST    SEGMENT
__real@40091eb851eb851f DQ 040091eb851eb851fr ; 3.14   ; ÂÆö‰πâÂ∏∏Èáè3.14ÔºåÂ≠òÂÇ®Âú®ÊÆµ&#96;CONST&#96;‰∏≠
CONST    ENDS
_TEXT    SEGMENT
_a$ &#x3D; 8             ; ÂèòÈáè&#96;_a&#96;ÁöÑÂÅèÁßªÈáèÔºåÁõ∏ÂØπ‰∫éÂü∫ÊåáÈíà(&#96;ebp&#96;)ÁöÑ8Â≠óËäÇ‰ΩçÁΩÆ
_b$ &#x3D; 16            ; ÂèòÈáè&#96;_b&#96;ÁöÑÂÅèÁßªÈáèÔºåÁõ∏ÂØπ‰∫éÂü∫ÊåáÈíà(&#96;ebp&#96;)ÁöÑ16Â≠óËäÇ‰ΩçÁΩÆ

_f PROC                ; &#96;_f&#96; ÊòØ‰∏Ä‰∏™ËøáÁ®ãÔºàÂáΩÊï∞Ôºâ
   push    ebp         ; ‰øùÂ≠òË∞ÉÁî®ËÄÖÁöÑÊ†àÂ∏ßÂü∫ÊåáÈíàÔºåÊääÂΩìÂâç&#96;ebp&#96;ÂÄºÊé®ÂÖ•Ê†à
   mov     ebp, esp    ; Â∞ÜÊ†àÊåáÈíà&#96;esp&#96;ÁöÑÂÄº‰øùÂ≠òÂú®Ê†àÂ∏ßÂü∫ÊåáÈíà&#96;ebp&#96;‰∏≠ÔºåÂª∫Á´ãÂáΩÊï∞Ê†àÂ∏ß
   fld     QWORD PTR _a$[ebp]
                        ; Â∞ÜebpÂÅèÁßª_aÁöÑÂÄºÔºàÂç≥ÂèòÈáè_aÁöÑÂÄºÔºâÂä†ËΩΩÂà∞FPUÔºàÊµÆÁÇπËøêÁÆóÂçïÂÖÉÔºâÂ†ÜÊ†à‰∏≠

; ÂΩìÂâçFPUÂ†ÜÊ†àÁä∂ÊÄÅ: ST(0) &#x3D; _a

   fdiv   QWORD PTR __real@40091eb851eb851f
                        ; Â∞ÜST(0)‰∏≠ÁöÑÂÄºÈô§‰ª•Â∏∏Èáè3.14ÔºåÂπ∂Â∞ÜÁªìÊûúÂ≠òÂÇ®Âú®ST(0)‰∏≠

; ÂΩìÂâçFPUÂ†ÜÊ†àÁä∂ÊÄÅ: ST(0) &#x3D; _a &#x2F; 3.14

   fld    QWORD PTR _b$[ebp]
                        ; Â∞ÜebpÂÅèÁßª_bÁöÑÂÄºÔºàÂç≥ÂèòÈáè_bÁöÑÂÄºÔºâÂä†ËΩΩÂà∞FPUÂ†ÜÊ†à‰∏≠

; ÂΩìÂâçFPUÂ†ÜÊ†àÁä∂ÊÄÅ: ST(0) &#x3D; _b; ST(1) &#x3D; _a &#x2F; 3.14

   fmul   QWORD PTR __real@4010666666666666
                        ; Â∞ÜST(0)‰∏≠ÁöÑÂÄº‰πò‰ª•Â∏∏Èáè4.1ÔºåÂπ∂Â∞ÜÁªìÊûúÂ≠òÂÇ®Âú®ST(0)‰∏≠

; ÂΩìÂâçFPUÂ†ÜÊ†àÁä∂ÊÄÅ: ST(0) &#x3D; _b * 4.1; ST(1) &#x3D; _a &#x2F; 3.14

   faddp ST(1), ST(0)
                        ; Â∞ÜST(0)ÂíåST(1)‰∏≠ÁöÑÂÄºÁõ∏Âä†ÔºåÂπ∂Â∞ÜÁªìÊûúÂ≠òÂÇ®Âú®ST(1)‰∏≠Ôºå
                        ; ÁÑ∂ÂêéÂºπÂá∫Â†ÜÊ†àÈ°∂ÔºàÂç≥ST(0)ÔºâÔºåÂ†ÜÊ†àÂπ≥Ë°°

; ÂΩìÂâçFPUÂ†ÜÊ†àÁä∂ÊÄÅ: ST(0) &#x3D; (_a &#x2F; 3.14) + (_b * 4.1)

   pop   ebp            ; ÊÅ¢Â§çË∞ÉÁî®ËÄÖÁöÑÂü∫ÊåáÈíàÔºåÂ∞ÜÊ†àÈ°∂ÁöÑÂÄºÂºπÂá∫Âà∞&#96;ebp&#96;‰∏≠
   ret   0              ; ‰ªéÂáΩÊï∞ËøîÂõûÔºå‰º†ÈÄí0‰∏™ÂèÇÊï∞ÁªôË∞ÉÁî®ËÄÖ
_f  ENDP                ; ÁªìÊùüËøáÁ®ãÂÆö‰πâ<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Ê±áÁºñËß£ËØª</p>
<ul>
<li><code>FLD</code>Êåá‰ª§‰ªéÊ†à‰∏≠ËØªÂèñ8‰∏™Â≠óËäÇÔºåÊääËøô‰∏™ÂÄºËΩ¨Êç¢Êàê<code>FPU</code>ÂØÑÂ≠òÂô®ÊâÄÈúÄÁöÑ80‰ΩçÊï∞ÊçÆÊ†ºÂºèÔºåÂπ∂Â≠òÂÖ•<code>ST(0)</code>ÂØÑÂ≠òÂô®</li>
<li><code>FDIV</code>Êåá‰ª§Êää<code>ST(0)</code>ÂØÑÂ≠òÂô®ÁöÑÂÄºÁî®‰ΩúË¢´Èô§Êï∞,ÊääÂèÇÊï∞<code>__real@40091eb851eb851f</code>ÔºàÂç≥3.14ÔºâÁöÑÂÄºÂΩì‰ΩúÈô§Êï∞.Âõ†‰∏∫Ê±áÁºñËØ≠Ê≥ï‰∏çÊîØÊåÅÂê´ÊúâÂ∞èÊï∞ÁÇπÁöÑÊµÆÁÇπÁ´ãÂç≥Êï∞ÔºåÊâÄ‰ª•Á®ãÂ∫è‰ΩøÁî®64‰ΩçIEEE 754Ê†ºÂºèÁöÑ16ËøõÂà∂Êï∞</li>
<li>ËøõË°å<code>FDIV</code>ËøêÁÆó‰πãÂêéÔºå<code>ST(0)</code>ÂØÑÂ≠òÂô®Â∞Ü‰øùÂ≠òÂïÜ</li>
<li>Ê≠§Â§ñÔºå<code>FDIVP</code>‰πüÊòØFPUÁöÑÈô§Ê≥ïËøêÁÆóÊåá‰ª§„ÄÇFDIVPÂú®ËøõË°åST(1)/ST(0)ËøêÁÆóÊó∂ÔºåÂÖàÊää‰∏§‰∏™ÂØÑÂ≠òÂô®ÁöÑÂÄºPOPÂá∫Êù•ËøõË°åËøêÁÆóÔºåÂÜçÊääÂïÜÊé®ÈÄÅÂÖ•(PUSH)FPUÁöÑÊ†àÔºàÂç≥ST(0)ÂØÑÂ≠òÂô®Ôºâ„ÄÇ</li>
<li>‰∏ã‰∏ÄÊù°<code>FLD</code>Êåá‰ª§Êää<code>b</code>ÈÄÅÂÖ•<code>FPU</code>ÁöÑÊ†à‰∏≠</li>
<li>Ê≠§Êó∂<code>ST(1)</code>ÂØÑÂ≠òÂô®ÈáåÊòØ‰∏äÊ¨°Èô§Ê≥ïËøêÁÆóÁöÑÂïÜÔºå<code>ST(0)</code>ÂØÑÂ≠òÂô®ÈáåÊòØÂèòÈáè<code>b</code>ÁöÑÂÄº</li>
<li>Êé•‰∏ãÊù•ÁöÑ<code>FMUL</code>Êåá‰ª§ÂÅö‰πòÊ≥ïËøêÁÆóÔºåÂÆÉÁî®ST(0)ÂØÑÂ≠òÂô®ÈáåÁöÑÂÄºÔºàÂç≥ÂèòÈáè<em>b</em>ÔºâÔºå‰πò‰ª•ÂèÇÊï∞__real @4010666666666666ÔºàÂç≥4.1ÔºâÔºåÂπ∂Â∞ÜËøêÁÆóÁªìÊûúÔºàÁßØÔºâÂ≠òÂÇ®Âà∞ST(0)ÂØÑÂ≠òÂô®„ÄÇ</li>
<li>ÊúÄÂêé‰∏ÄÊù°ËøêÁÆóÊåá‰ª§FADDPËÆ°ÁÆóÊ†àÂÜÖÈ°∂ÈÉ®‰∏§‰∏™ÂÄºÁöÑÂíå„ÄÇÂÆÉ<code>ÂÖàÊääËøêÁÆóÁªìÊûúÂ≠òÂÇ®Âú®ST(1)ÂØÑÂ≠òÂô®ÔºåÂÜçPOP ST(0)</code>„ÄÇÊâÄ‰ª•Ôºå<mark>ËøêÁÆóË°®ËææÂºèÁöÑËøêÁÆóÁªìÊûúÂ≠òÂÇ®Âú®Ê†àÈ°∂ÁöÑST(0)ÂØÑÂ≠òÂô®Èáå„ÄÇ</mark></li>
<li>Ê†πÊçÆÊúâÂÖ≥ËßÑËåÉÔºå<mark>ÂáΩÊï∞ÂøÖÈ°ª‰ΩøÁî®ST(0)ÂØÑÂ≠òÂô®Â≠òÂÇ®ÊµÆÁÇπËøêÁÆóÁöÑËøîÂõûÁªìÊûú</mark>„ÄÇÊâÄ‰ª•Âú®FADDPÊåá‰ª§‰πãÂêéÔºåÈô§‰∫ÜÂáΩÊï∞Â∞æÂ£∞ÁöÑÊåá‰ª§‰πãÂ§ñÂÜçÊó†ÂÖ∂‰ªñÊåá‰ª§„ÄÇ</li>
</ul>
<hr />
<p><code>GCC -O3</code></p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">; ÂÆö‰πâËøáÁ®ã fÔºå‰Ωú‰∏∫‰∏Ä‰∏™ËøëËøáÁ®ã
public f
f proc near

; ÂÆö‰πâËøáÁ®ãÁöÑÂèÇÊï∞
arg_0 &#x3D; qword ptr 8      ; Á¨¨‰∏Ä‰∏™ÂèÇÊï∞ÁöÑÂÅèÁßªÈáèÔºåÁõ∏ÂØπ‰∫é&#96;ebp&#96;ÁöÑ8Â≠óËäÇ‰ΩçÁΩÆ
arg_8 &#x3D; qword ptr 10h    ; Á¨¨‰∫å‰∏™ÂèÇÊï∞ÁöÑÂÅèÁßªÈáèÔºåÁõ∏ÂØπ‰∫é&#96;ebp&#96;ÁöÑ16Â≠óËäÇ‰ΩçÁΩÆ

                push    ebp      ; ÊääË∞ÉÁî®ËÄÖÁöÑÊ†àÂ∏ßÂü∫ÊåáÈíà&#96;ebp&#96;Êé®ÂÖ•Ê†à‰∏≠Ôºå‰øùÁïôË∞ÉÁî®ËÄÖÁöÑÊ†àÂ∏ß
                fld     ds:dbl_8048608 ; Âä†ËΩΩÂÖ®Â±ÄÊï∞ÊçÆÊÆµ‰∏≠ÁöÑÂ∏∏Èáè3.14Âà∞FPUÔºàÊµÆÁÇπËøêÁÆóÂçïÂÖÉÔºâÂ†ÜÊ†à

; ÂΩìÂâçÊ†àÁä∂ÊÄÅ: ST(0) &#x3D; 3.14
                mov     ebp, esp ; ÂàõÂª∫Êñ∞ÁöÑÊ†àÂ∏ßÔºåebpÊåáÂêëÂΩìÂâçÊ†àÈ°∂
                fdivr   [ebp+arg_0] ; ÂèçÈô§Ê≥ïÊåá‰ª§ÔºåÂ∞ÜST(0)‰∏≠ÁöÑÂ∏∏Èáè3.14Èô§‰ª•Á¨¨‰∏Ä‰∏™ÂèÇÊï∞Ôºàarg_0Ôºâ

; ÂΩìÂâçÊ†àÁä∂ÊÄÅ: ST(0) &#x3D; Èô§Ê≥ïÁªìÊûú (3.14 &#x2F; arg_0)
                fld     ds:dbl_8048610 ; Âä†ËΩΩÂÖ®Â±ÄÊï∞ÊçÆÊÆµ‰∏≠ÁöÑÂ∏∏Èáè4.1Âà∞FPUÂ†ÜÊ†à

; ÂΩìÂâçÊ†àÁä∂ÊÄÅ: ST(0) &#x3D; 4.1, ST(1) &#x3D; Èô§Ê≥ïÁªìÊûú
                fmul    [ebp+arg_8] ; Â∞ÜST(0)‰∏≠ÁöÑ4.1‰πò‰ª•Á¨¨‰∫å‰∏™ÂèÇÊï∞Ôºàarg_8Ôºâ

; ÂΩìÂâçÊ†àÁä∂ÊÄÅ: ST(0) &#x3D; ‰πòÊ≥ïÁªìÊûú (4.1 * arg_8), ST(1) &#x3D; Èô§Ê≥ïÁªìÊûú
                pop     ebp      ; ÊÅ¢Â§çË∞ÉÁî®ËÄÖÁöÑÊ†àÂ∏ßÔºåÂ∞ÜÊ†àÈ°∂ÁöÑÂÄºÂºπÂá∫Âà∞ebp‰∏≠
                faddp   st(1), st ; Â∞ÜST(0)ÂíåST(1)Áõ∏Âä†ÔºåÂπ∂Â∞ÜÁªìÊûúÂ≠òÂÇ®Âú®ST(1)‰∏≠Ôºå
                                  ; ÁÑ∂ÂêéÂºπÂá∫Â†ÜÊ†àÈ°∂ÔºàÂç≥ST(0)ÔºâÔºåÊ†àÂπ≥Ë°°

; ÂΩìÂâçÊ†àÁä∂ÊÄÅ: ST(0) &#x3D; Âä†Ê≥ïÁªìÊûú ((3.14 &#x2F; arg_0) + (4.1 * arg_8))
                ret               ; ‰ªéËøáÁ®ãËøîÂõûÔºåËøîÂõûÂú∞ÂùÄ‰ªéÊ†àÈ°∂ÂºπÂá∫
f endp           ; ÁªìÊùüËøáÁ®ãÂÆö‰πâ<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>
<p><code>gcc</code>Êää3.14ÈÄÅÂÖ•FPUÁöÑÊ†à‰∏≠(ST(0)ÂØÑÂ≠òÂô®),Áî®‰Ωú<code>arg_0</code>ÁöÑÈô§Êï∞</p>
</li>
<li>
<p><code>FDIVR</code>ÊòØ<code>Reverse Divide</code>ÁöÑÁº©ÂÜô„ÄÇ<code>FDIVR</code>Êåá‰ª§ÁöÑÈô§Êï∞ÂíåË¢´Èô§Êï∞ÔºåÂØπÂ∫î<code>FDIV</code>Êåá‰ª§ÁöÑË¢´Èô§Êï∞ÂíåÈô§Êï∞ÔºåÂç≥‰ΩçÁΩÆÁõ∏ÂèçÔºå<code>FDIV</code>ÊòØ<code>ST[0]</code>‰Ωú‰∏∫Ë¢´Èô§Êï∞Ôºå<code>FDIVR</code>ÊòØ<code>ST[0]</code>‰ΩúÈô§Êï∞</p>
<p>ÂÖ∂‰ªñÁõ∏Âêå</p>
</li>
</ul>
<h4 id="Âà©Áî®ÂèÇÊï∞‰º†ÈÄíÊµÆÁÇπÂûã"><a class="markdownIt-Anchor" href="#Âà©Áî®ÂèÇÊï∞‰º†ÈÄíÊµÆÁÇπÂûã"></a> Âà©Áî®ÂèÇÊï∞‰º†ÈÄíÊµÆÁÇπÂûã</h4>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;math.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>

<span class="token keyword">int</span> <span class="token function">main</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> 
<span class="token punctuation">&#123;</span>
        <span class="token function">printf</span> <span class="token punctuation">(</span><span class="token string">"32.01 ^ 1.54 = %lf\n"</span><span class="token punctuation">,</span> <span class="token function">pow</span> <span class="token punctuation">(</span><span class="token number">32.01</span><span class="token punctuation">,</span><span class="token number">1.54</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>msvs x86</code></p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">CONST    SEGMENT
__real@40400147ae147ae1 DQ 040400147ae147ae1r    ; 32.01  ; ÂÆö‰πâÂ∏∏Èáè32.01ÔºåÂ≠òÂÇ®Âú®ÊÆµ&#96;CONST&#96;‰∏≠
__real@3ff8a3d70a3d70a4 DQ 03ff8a3d70a3d70a4r    ; 1.54   ; ÂÆö‰πâÂ∏∏Èáè1.54ÔºåÂ≠òÂÇ®Âú®ÊÆµ&#96;CONST&#96;‰∏≠
CONST    ENDS

_main    PROC                          ; ‰∏ªËøáÁ®ã _main ÁöÑÂºÄÂßã
    push   ebp                         ; Â∞ÜË∞ÉÁî®ËÄÖÁöÑÊ†àÂ∏ßÂü∫ÊåáÈíà&#96;ebp&#96;Êé®ÂÖ•Ê†àÔºå‰øùÁïôË∞ÉÁî®ËÄÖÁöÑÊ†àÂ∏ß
    mov    ebp, esp                    ; Â∞ÜÂΩìÂâçÊ†àÈ°∂ÊåáÈíà&#96;esp&#96;ÁöÑÂÄºËµãÁªô&#96;ebp&#96;ÔºåÂª∫Á´ãÊñ∞ÁöÑÊ†àÂ∏ß
    sub    esp, 8                      ; ‰∏∫Á¨¨1‰∏™ÂèòÈáèÂàÜÈÖç8‰∏™Â≠óËäÇÁöÑÊ†àÁ©∫Èó¥
    fld    QWORD PTR __real@3ff8a3d70a3d70a4   ; Âä†ËΩΩÂ∏∏Èáè1.54Âà∞FPUÔºàÊµÆÁÇπËøêÁÆóÂçïÂÖÉÔºâÂ†ÜÊ†à
    fstp   QWORD PTR [esp]             ; Â∞ÜFPUÂ†ÜÊ†àÈ°∂ÈÉ®ÔºàST(0)ÔºâÁöÑÂÄºÂ≠òÂÇ®Âà∞Ê†àÈ°∂ÔºàÂØπÂ∫îÁ¨¨1‰∏™ÂèòÈáèÁöÑÁ©∫Èó¥Ôºâ
    sub    esp, 8                      ; ‰∏∫Á¨¨2‰∏™ÂèòÈáèÂàÜÈÖç8‰∏™Â≠óËäÇÁöÑÊ†àÁ©∫Èó¥
    fld    QWORD PTR __real@40400147ae147ae1   ; Âä†ËΩΩÂ∏∏Èáè32.01Âà∞FPUÂ†ÜÊ†à
    fstp   QWORD PTR [esp]             ; Â∞ÜFPUÂ†ÜÊ†àÈ°∂ÈÉ®ÁöÑÂÄºÂ≠òÂÇ®Âà∞Ê†àÈ°∂ÔºàÂØπÂ∫îÁ¨¨2‰∏™ÂèòÈáèÁöÑÁ©∫Èó¥Ôºâ
    call   _pow                        ; Ë∞ÉÁî®&#96;_pow&#96;ÂáΩÊï∞ËÆ°ÁÆóÂπÇÔºàÈªòËÆ§Â∫ïÊï∞Âú® [esp + 8]ÔºåÊåáÊï∞Âú® [esp]Ôºâ

    add    esp, 8                      ; Ë∞ÉÊï¥Ê†àÊåáÈíàÔºåÈáäÊîæÁ¨¨2‰∏™ÂèòÈáèÁöÑÁ©∫Èó¥
                                       
; Ê†àÂàÜÈÖç‰∫Ü8‰∏™Â≠óËäÇÁöÑÁ©∫Èó¥Áî®‰∫éÂ≠òÂÇ®ÂáΩÊï∞ &#96;_pow&#96; ÁöÑÁªìÊûú
; ËøêÁÆóÁªìÊûúÂ≠òÂÇ®‰∫éFPUÂ†ÜÊ†àÁöÑST(0)ÂØÑÂ≠òÂô®

    fstp   QWORD PTR [esp]             ; Â∞ÜFPUÂ†ÜÊ†àÈ°∂ÈÉ®ÁöÑÂÄºÔºà&#96;_pow&#96;ÁªìÊûúÔºâÂ≠òÂÇ®Âà∞Ê†àÈ°∂Ôºå‰æõ&#96;printf()&#96;‰ΩøÁî®
    push   OFFSET $SG2651              ; Êé®ÈÄÅÊ†ºÂºèÂ≠óÁ¨¶‰∏≤ÁöÑÂú∞ÂùÄÂà∞Ê†àÔºåÁî®‰∫é&#96;printf()&#96;Ë∞ÉÁî®
    call   _printf                     ; Ë∞ÉÁî®&#96;printf()&#96;ÂáΩÊï∞ÊâìÂç∞ÁªìÊûú
    add    esp, 12                     ; Ë∞ÉÊï¥Ê†àÊåáÈíàÔºåÈáäÊîæÁî®‰∫é&#96;printf&#96;Ë∞ÉÁî®ÁöÑÊ†àÁ©∫Èó¥Ôºà8Â≠óËäÇÁªìÊûú + 4Â≠óËäÇÂú∞ÂùÄÔºâ
    xor    eax, eax                    ; Â∞Ü&#96;eax&#96;ÂØÑÂ≠òÂô®ÁΩÆÈõ∂ÔºåË°®Á§∫Á®ãÂ∫èËøîÂõûÂÄº‰∏∫0
    pop    ebp                         ; ÊÅ¢Â§çË∞ÉÁî®ËÄÖÁöÑÊ†àÂ∏ßÔºåÂ∞ÜÊ†àÈ°∂ÁöÑÂÄºÂºπÂá∫Âà∞&#96;ebp&#96;‰∏≠
    ret    0                           ; ‰ªéËøáÁ®ãËøîÂõûÔºå‰º†ÈÄí0‰∏™ÂèÇÊï∞ÁªôË∞ÉÁî®ËÄÖ
_main    ENDP                          ; ÁªìÊùüËøáÁ®ãÂÆö‰πâ<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Ê±áÁºñËß£ËØª</p>
<ul>
<li>FLDÂíåFSTPÊåá‰ª§ÊòØÂú®Êï∞ÊçÆÊÆµÔºàSEGMENTÔºâÂíåFPUÁöÑÊ†àÈó¥‰∫§Êç¢Êï∞ÊçÆÁöÑÊåá‰ª§„ÄÇ<mark>FLDÊääÂÜÖÂ≠òÈáåÁöÑÊï∞ÊçÆÊé®ÈÄÅÂÖ•FPUÁöÑÊ†à</mark>ÔºåËÄå<mark>FSTPÂàôÊääFPUÊ†àÈ°∂ÁöÑÊï∞ÊçÆ<code>Â§çÂà∂</code>Âà∞ÂÜÖÂ≠ò‰∏≠</mark>„ÄÇËøô‰∏§‰∏™ËøûÁî®Áõ∏ÂΩì‰∫é‰ΩøÊµÆÁÇπÊï∞ÁªôÂÖ•Ê†à‰∫Ü,Áªôpow‰º†ÈÄíÂèÇÊï∞</li>
<li>pow()ÂáΩÊï∞ÊòØÊåáÊï∞ËøêÁÆóÂáΩÊï∞ÔºåÂÆÉ‰ªé<mark>FPUÁöÑÊ†àÂÜÖËØªÂèñ‰∏§‰∏™ÂèÇÊï∞ËøõË°åËÆ°ÁÆóÔºåÂπ∂ÊääËøêÁÆóÁªìÊûúÔºà<em>x</em>ÁöÑ<em>y</em>Ê¨°ÂπÇÔºâÂ≠òÂÇ®Âú®ST(0)ÂØÑÂ≠òÂô®Èáå</mark>„ÄÇ‰πãÂêéÔºåprintf()ÂáΩÊï∞ÂÖà‰ªéÂÜÖÂ≠òÊ†à‰∏≠ËØªÂèñ8‰∏™Â≠óËäÇÁöÑÊï∞ÊçÆÔºåÂÜç‰ª•ÂèåÁ≤æÂ∫¶ÊµÆÁÇπÁöÑÂΩ¢ÂºèËøõË°åËæìÂá∫„ÄÇ</li>
<li>Ê≠§Â§ñÔºåËøô‰∏™‰æãÂ≠êÈáåËøòÂèØ‰ª•<mark>Áõ¥Êé•ÊàêÂØπ‰ΩøÁî®MOVÊåá‰ª§ÊääÊµÆÁÇπÊï∞ÊçÆ‰ªéÂÜÖÂ≠òÂ§çÂà∂Âà∞FPUÁöÑÊ†àÈáå„ÄÇÂÜÖÂ≠òÊú¨Ë∫´Â∞±ÊääÊµÆÁÇπÊï∞ÊçÆÂ≠òÂÇ®‰∏∫IEEE 754ÁöÑÊï∞ÊçÆÊ†ºÂºèÔºåËÄåpow()ÂáΩÊï∞ÊâÄÈúÄÁöÑÂèÇÊï∞Â∞±ÊòØËøô‰∏™Ê†ºÂºèÁöÑÊï∞ÊçÆÔºåÊâÄ‰ª•Ê≠§Â§ÑÊ≤°ÊúâÊ†ºÂºèËΩ¨Êç¢ÁöÑÂøÖË¶Å</mark>„ÄÇ</li>
</ul>
<h4 id="ÊØîËæÉËØ¥Êòé"><a class="markdownIt-Anchor" href="#ÊØîËæÉËØ¥Êòé"></a> ÊØîËæÉËØ¥Êòé</h4>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>

<span class="token keyword">double</span> <span class="token function">d_max</span> <span class="token punctuation">(</span><span class="token keyword">double</span> a<span class="token punctuation">,</span> <span class="token keyword">double</span> b<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>a<span class="token operator">></span>b<span class="token punctuation">)</span>
                <span class="token keyword">return</span> a<span class="token punctuation">;</span>

        <span class="token keyword">return</span> b<span class="token punctuation">;</span> 
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
<span class="token punctuation">&#123;</span>
        <span class="token function">printf</span> <span class="token punctuation">(</span><span class="token string">"%f\n"</span><span class="token punctuation">,</span> <span class="token function">d_max</span> <span class="token punctuation">(</span><span class="token number">1.2</span><span class="token punctuation">,</span> <span class="token number">3.4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">printf</span> <span class="token punctuation">(</span><span class="token string">"%f\n"</span><span class="token punctuation">,</span> <span class="token function">d_max</span> <span class="token punctuation">(</span><span class="token number">5.6</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<hr />
<p><code>Non-Optimizing MSVS</code></p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">PUBLIC    _d_max
_TEXT    SEGMENT
_a$ &#x3D; 8              ; ÂèòÈáè_a$Âú®Ê†àÂ∏ß‰∏≠ÁöÑÂÅèÁßªÔºåÂ§ßÂ∞è‰∏∫8Â≠óËäÇ
_b$ &#x3D; 16             ; ÂèòÈáè_b$Âú®Ê†àÂ∏ß‰∏≠ÁöÑÂÅèÁßªÔºåÂ§ßÂ∞è‰∏∫8Â≠óËäÇ
_d_max     PROC
    push   ebp               ; ‰øùÂ≠òÊóßÁöÑÂü∫ÂùÄÊåáÈíà
    mov    ebp, esp          ; Â∞ÜÂΩìÂâçÊ†àÈ°∂ÊåáÈíàËµãÂÄºÁªôÂü∫ÂùÄÊåáÈíà
    fld    QWORD PTR _b$[ebp]; Âä†ËΩΩ_b$ÔºåÂ∞ÜÂÖ∂ÂéãÂÖ•FPUÂ†ÜÊ†àÁöÑST(0)ÂØÑÂ≠òÂô®

    ; ÂΩìÂâçÂ†ÜÊ†àÁä∂ÊÄÅÔºöST(0) &#x3D; _b
    ; ÊØîËæÉ_bÔºàST(0)ÔºâÂíå_a$ÔºåÁÑ∂ÂêéÂºπÂá∫ÂØÑÂ≠òÂô®

    fcomp  QWORD PTR _a$[ebp]; ÊØîËæÉST(0)Âíå_a$ÔºåÂπ∂ÂºπÂá∫ST(0)

    ; Ê≠§Êó∂FPUÂ†ÜÊ†à‰∏∫Á©∫

    fnstsw ax                ; Â∞ÜFPUÁä∂ÊÄÅÂ≠óÂ≠òÂÇ®Âà∞AXÂØÑÂ≠òÂô®
    test   ah, 5             ; Ê£ÄÊü•AXÂØÑÂ≠òÂô®ÁöÑÈ´ò8‰ΩçÁöÑÁ¨¨0ÂíåÁ¨¨2‰Ωç(ÂØπÂ∫îÁöÑÊòØC2,C0Ê†áÂøó‰Ωç)
    jp     SHORT $LN1@d_max  ; Â¶ÇÊûúÊ†áÂøó‰ΩçÊúâÊ≠£Êï∞Ê†áÂøó(a&lt;&#x3D;b)ÔºåÂàôË∑≥ËΩ¨Âà∞$LN1@d_max

    ; Â¶ÇÊûú_a &gt; _bÔºåÁªßÁª≠ÊâßË°å‰ª•‰∏ã‰ª£Á†Å

    fld    QWORD PTR _a$[ebp]; Âä†ËΩΩ_a$ÔºåÂ∞ÜÂÖ∂ÂéãÂÖ•FPUÂ†ÜÊ†àÁöÑST(0)
    jmp    SHORT $LN2@d_max  ; Ë∑≥ËΩ¨Âà∞$LN2@d_max
$LN1@d_max:
    fld    QWORD PTR _b$[ebp]; Âä†ËΩΩ_b$ÔºåÂ∞ÜÂÖ∂ÂéãÂÖ•FPUÂ†ÜÊ†àÁöÑST(0)
$LN2@d_max:
    pop    ebp               ; ÊÅ¢Â§çÂü∫ÂùÄÊåáÈíà
    ret    0                 ; ËøîÂõû
_d_max    ENDP<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>
<p><code>FCOMP</code>È¶ñÂÖàÊØîËæÉ<code>ST(0)</code>‰∏é<code>_a</code>ÁöÑÂÄºÔºåÁÑ∂ÂêéÊ†πÊçÆÊØîËæÉÁöÑÁªìÊûúËÆæÁΩÆ<code>FPU</code>Áä∂ÊÄÅÂ≠ó(ÂØÑÂ≠òÂô®)ÁöÑC3/C2/C0‰Ωç„ÄÇ<mark><code>FPU</code>ÁöÑÁä∂ÊÄÅÂ≠óÂØÑÂ≠òÂô®ÊòØ‰∏Ä‰∏™16‰ΩçÂØÑÂ≠òÂô®ÔºåÁî®‰∫éÊèèËø∞<code>FPU</code>ÁöÑÂΩìÂâçÁä∂ÊÄÅ</mark></p>
<ul>
<li>Â¶ÇÊûú<em>b</em>&gt;aÔºåÂàôC3„ÄÅC2„ÄÅC0ÂØÑÂ≠òÂô®ÁöÑÂÄº‰ºöÂàÜÂà´ÊòØ0„ÄÅ0„ÄÅ0„ÄÇ</li>
<li>Â¶ÇÊûú<em>a</em>&gt;<em>b</em>ÔºåÂàôÂØÑÂ≠òÂô®ÁöÑÂÄº‰ºöÂàÜÂà´ÊòØ0„ÄÅ0„ÄÅ1„ÄÇ</li>
<li>Â¶ÇÊûú<em>a</em>=<em>b</em>ÔºåÂàôÂØÑÂ≠òÂô®ÁöÑÂÄº‰ºöÂàÜÂà´ÊòØ1„ÄÅ0„ÄÅ0„ÄÇ</li>
<li>Â¶ÇÊûúÂá∫Áé∞‰∫ÜÈîôËØØÔºàNaNÊàñÊï∞ÊçÆ‰∏çÂÖºÂÆπÔºâÔºåÂàôÂØÑÂ≠òÂô®ÁöÑÂÄºÊòØ1„ÄÅ1„ÄÅ1„ÄÇ</li>
</ul>
<p>Âú®ËÆæÁΩÆÂ•ΩÁõ∏Â∫îÊØîÁâπ‰Ωç‰πãÂêéÔºå<code>FCOMPÊåá‰ª§Ëøò‰ºö‰ªéÊ†àÈáåÊäõÂá∫ÔºàPOPÔºâ‰∏Ä‰∏™ÂÄº</code>„ÄÇFCOM‰∏éFCOMPÁöÑÂäüËÉΩÂçÅÂàÜÁõ∏‰ºº„ÄÇ<code>FCOMÊåá‰ª§Âè™Ê†πÊçÆÊï∞ÂÄºÊØîËæÉÁöÑÁªìÊûúËÆæÁΩÆÁä∂ÊÄÅÂ≠óÔºåËÄå‰∏ç‰ºöÂÜçÊìç‰ΩúFPUÁöÑÊ†à</code>„ÄÇ</p>
</li>
<li>
<p><code>FNSTSW</code> Êåá‰ª§Âú® x86 Ê±áÁºñ‰∏≠Áî®‰∫éÂ∞ÜÊµÆÁÇπÁä∂ÊÄÅÂ≠óÔºà<code>Floating Point Status Word</code>ÔºâÂ≠òÂÇ®Âà∞ÊåáÂÆö‰ΩçÁΩÆÊàñ AX ÂØÑÂ≠òÂô®‰∏≠</p>
<p><code>F</code>:Êìç‰ΩúÂâç‰∏çÁ≠âÂæÖFPUÂèØÁî®</p>
<p><code>NST</code>:No SToreÂà∞ÂÜÖÂ≠òÊìç‰Ωú</p>
<p><code>SW</code>:Status Word(Áä∂ÊÄÅÂ≠ó)</p>
<p>C3/C2/C0Ê†áÂøó‰ΩçÂØπÂ∫îAXÁöÑÁ¨¨14/10/8‰Ωç„ÄÇ<code>Â§çÂà∂Êï∞ÂÄºÂπ∂‰∏ç‰ºöÊîπÂèòÊ†áÂøó‰ΩçÔºàbitÔºâÁöÑÊï∞ÊùÉÔºà‰ΩçÁΩÆÔºâ</code>„ÄÇÊ†áÂøó‰Ωç‰ºöÈõÜ‰∏≠Âú®AXÂØÑÂ≠òÂô®ÁöÑÈ´òÂú∞ÂùÄ‰ΩçÂå∫Âüü‚Äî‚ÄîÂç≥AHÂØÑÂ≠òÂô®Èáå„ÄÇ</p>
<p>‰ª•AHÊù•Áúã:0:C0   1:C1   2:C2   6:C3</p>
<p><code>test ah, 5</code>Êåá‰ª§ÊääahÁöÑÂÄºÔºàFPUÊ†áÂøó‰ΩçÁöÑÂä†ÊùÉÊ±ÇÂíåÂÄºÔºâÂíå0101Ôºà‰∫åËøõÂà∂ÁöÑ5ÔºâÂÅö‰∏éÔºàANDÔºâËøêÁÆóÔºåÂπ∂ËÆæÁΩÆÊ†áÂøó‰Ωç„ÄÇÂΩ±ÂìçtestÁªìÊûúÁöÑÂè™ÊúâÁ¨¨0ÊØîÁâπ‰ΩçÁöÑC0Ê†áÂøó‰ΩçÂíåÁ¨¨2ÊØîÁâπ‰ΩçÁöÑC2Ê†áÂøó‰ΩçÔºåÂõ†‰∏∫ÂÖ∂‰ªñÁöÑ‰ΩçÈÉΩ‰ºöË¢´ÁΩÆÈõ∂„ÄÇ</p>
</li>
<li>
<p>Â•áÂÅ∂Ê†°È™å‰ΩçPFÔºàparity flagÔºâÁöÑ‰ªãÁªç</p>
<p><mark>PFÊ†áÂøó‰ΩçÁöÑ‰ΩúÁî®ÊòØÂà§ÂÆöËøêÁÆóÁªìÊûú‰∏≠ÁöÑ‚Äú1‚ÄùÁöÑ‰∏™Êï∞ÔºåÂ¶ÇÊûú‚Äú1‚ÄùÁöÑ‰∏™Êï∞‰∏∫ÂÅ∂Êï∞ÔºåÂàôPFÁöÑÂÄº‰∏∫1ÔºåÂê¶ÂàôÂÖ∂ÂÄº‰∏∫0„ÄÇ</mark></p>
<p>Ê£ÄÈ™åÂ•áÂÅ∂‰ΩçÈÄöÂ∏∏Áî®‰∫éÂà§Êñ≠Â§ÑÁêÜËøáÁ®ãÊòØÂê¶Âá∫Áé∞ÊïÖÈöúÔºåÂπ∂<mark>‰∏çËÉΩÂà§Êñ≠Ëøô‰∏™Êï∞ÂÄºÊòØÂ•áÊï∞ËøòÊòØÂÅ∂Êï∞</mark>„ÄÇFPUÊúâÂõõ‰∏™Êù°‰ª∂Ê†áÂøó‰ΩçÔºàC0Âà∞C3Ôºâ„ÄÇ‰ΩÜÊòØÔºåÂøÖÈ°ªÊääÊ†áÂøó‰ΩçÁöÑÂÄºÁªÑÁªáËµ∑Êù•„ÄÅÂ≠òÊîæÂú®Ê†áÂøó‰ΩçÂØÑÂ≠òÂô®‰∏≠ÔºåÊâçËÉΩËøõË°åÂ•áÂÅ∂Ê†°È™å‰ΩçÁöÑÊ≠£Á°ÆÊÄßÈ™åËØÅ„ÄÇFPUÊ†áÂøó‰ΩçÁöÑÁî®ÈÄîÂêÑÊúâ‰∏çÂêåÔºö<mark>C0‰ΩçÊòØËøõ‰ΩçÊ†áÂøó‰ΩçCFÔºåC2ÊòØÂ•áÂÅ∂Ê†°È™å‰ΩçPFÔºåC3ÊòØÈõ∂Ê†áÂøó‰ΩçZF</mark></p>
<p>Âú®‰ΩøÁî®FUCOMÊåá‰ª§ÔºàFPUÊØîËæÉÊåá‰ª§ÁöÑÈÄöÁß∞ÔºâÊó∂Ôºå<mark>Â¶ÇÊûúÊìç‰ΩúÊï∞ÈáåÂá∫Áé∞‰∫Ü‰∏çÂèØÊØîËæÉÁöÑÊµÆÁÇπÂÄºÔºàÈùûÊï∞ÂÄºÂûãÂÜÖÂÆπNaNÊàñÂÖ∂‰ªñÊó†Ê≥ïË¢´Êåá‰ª§ÊîØÊåÅÁöÑÊ†ºÂºèÔºâÔºåÂàôC2‰ºöË¢´ËÆæ‰∏∫1„ÄÇ</mark></p>
<p><mark>Â¶ÇÊûúC0ÂíåC2ÈÉΩÊòØ0ÊàñÈÉΩÊòØ1ÔºåÂàôËÆæPFÊ†áÂøó‰∏∫1Âπ∂Ëß¶ÂèëJPË∑≥ËΩ¨ÔºàJump on Parity</mark>Ôºâ„ÄÇÂâçÈù¢ÂØπC3/C2/C0ÁöÑÂèñÂÄºËøõË°å‰∫ÜÂàÜÁ±ªËÆ®ËÆ∫Ôºå<mark>C2ÂíåC0ÁöÑÊï∞ÂÄºÁõ∏ÂêåÁöÑÊÉÖÂÜµÂàÜ‰∏∫<em>b</em>&gt;<em>a</em>Âíå <em>a</em>=<em>b</em>Ëøô‰∏§ÁßçÊÉÖÂÜµ„ÄÇÂõ†‰∏∫testÊåá‰ª§ÊääahÁöÑÂÄº‰∏é5ËøõË°å‚Äú‰∏é‚ÄùËøêÁÆóÔºåÊâÄ‰ª•C3ÁöÑÂÄºÊó†ÂÖ≥Á¥ßË¶Å</mark>„ÄÇ</p>
<p>Âú®Ê≠§‰πãÂêéÁöÑÊåá‰ª§Â∞±ÂæàÁÆÄÂçï‰∫Ü„ÄÇÂ¶ÇÊûúËß¶Âèë‰∫ÜJPË∑≥ËΩ¨ÔºåÂàôFLDÊåá‰ª§ÊääÂèòÈáè_bÁöÑÂÄºÂ§çÂà∂Âà∞ST(0)ÂØÑÂ≠òÂô®ÔºåÂê¶ÂàôÂèòÈáè_aÁöÑÂÄºÂ∞Ü‰ºö‰º†ÈÄíÁªôSTÔºà0ÔºâÂØÑÂ≠òÂô®„ÄÇ</p>
<p>Â¶ÇÊûúÈúÄË¶ÅÊ£ÄÊµãC2ÁöÑÁä∂ÊÄÅ</p>
<p>Â¶ÇÊûúTESTÊåá‰ª§ÈÅáÂà∞ÈîôËØØÔºàNaNÁ≠âÊÉÖÂΩ¢ÔºâÔºåÂàôC2Ê†áÂøó‰ΩçÁöÑÂÄº‰ºöË¢´ËÆæÁΩÆ‰∏∫1„ÄÇ‰∏çËøáÊàë‰ª¨ÁöÑÁ®ãÂ∫è‰∏çÊ£ÄÊµãËøôÁ±ªÈîôËØØ„ÄÇ<code>Â¶ÇÊûúÁºñÁ®ã‰∫∫ÂëòÈúÄË¶ÅÂ§ÑÁêÜFPUÁöÑÈîôËØØÔºå‰ªñÂ∞±‰∏çÂæó‰∏çÊ∑ªÂä†È¢ùÂ§ñÁöÑÈîôËØØÊ£ÄÊü•Êåá‰ª§</code>„ÄÇ</p>
</li>
</ul>
<hr />
<p><code>Optimizing MSVS 2010</code></p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">_a$ &#x3D; 8                  ; size &#x3D; 8
_b$ &#x3D; 16                 ; size &#x3D; 8
_d_max     PROC
    fld     QWORD PTR _b$[esp-4]
    fld     QWORD PTR _a$[esp-4]

; current stack state: ST(0) &#x3D; _a, ST(1) &#x3D; _b

    fcom    ST(1) ; compare _a and ST(1) &#x3D; (_b)
    fnstsw  ax
    test    ah, 65 ; 00000041H
    jne     SHORT $LN5@d_max
; copy ST(0) to ST(1) and pop register,
; leave (_a) on top
    fstp    ST(1)

; current stack state: ST(0) &#x3D; _a

    ret     0
$LN5@d_max:
; copy ST(0) to ST(0) and pop register,
; leave (_b) on top
    fstp    ST(0)

; current stack state: ST(0) &#x3D; _b
    ret 0
_d_max ENDP<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>
<p>FCOMÊåá‰ª§ÂíåÂâçÈù¢Áî®ËøáÁöÑFCOMPÊåá‰ª§Áï•Êúâ‰∏çÂêåÔºåÂÆÉ‰∏çÊìç‰ΩúFPUÊ†à„ÄÇËÄå‰∏îÊú¨‰æãÁöÑÊìç‰ΩúÊï∞‰πüÂíåÂâçÊñáÊúâÂå∫Âà´ÔºåËøôÈáåÂÆÉÊòØÈÄÜÂ∫èÁöÑ„ÄÇÊâÄ‰ª•ÔºåFCOMÁîüÊàêÁöÑÊù°‰ª∂Ê†áÂøó‰ΩçÁöÑÊ∂µ‰πâ‰πü‰∏éÂâç‰æã‰∏çÂêå„ÄÇ</p>
<ul>
<li>Â¶ÇÊûú<em>a</em>&gt;<em>b</em>ÔºåÂàôC3„ÄÅC2„ÄÅC0‰ΩçÁöÑÂÄºÂàÜÂà´‰∏∫0„ÄÅ0„ÄÅ0„ÄÇ</li>
<li>Â¶ÇÊûú<em>b</em>&gt;<em>a</em>ÔºåÂàôÂØπÂ∫îÊï∞ÂÄº‰∏∫0„ÄÅ0„ÄÅ1„ÄÇ</li>
<li>Â¶ÇÊûú<em>a</em>=<em>b</em>ÔºåÂàôÂØπÂ∫îÊï∞ÂÄº‰∏∫1„ÄÅ0„ÄÅ0„ÄÇ</li>
</ul>
</li>
<li>
<p>ÊòØËØ¥Ôºå‚Äútest ah, 65‚ÄùËøôÊù°Êåá‰ª§‰ªÖ‰ªÖÊØîËæÉ‰∏§‰∏™Ê†áÂøó‰Ωç‚Äî‚ÄîC3ÔºàÁ¨¨6‰Ωç/bitÔºâÂíåC0ÔºàÁ¨¨0‰Ωç/bitÔºâ„ÄÇÂú®<em>a</em>&gt;<em>b</em>ÁöÑÊÉÖÂÜµ‰∏ãÔºå‰∏§ËÄÖÈÉΩÂ∫î‰∏∫0ÔºöËøôÁßçÊÉÖÂÜµ‰∏ãÔºåÁ®ãÂ∫è‰∏ç‰ºöË¢´Ëß¶ÂèëJNEË∑≥ËΩ¨ÔºåÂπ∂‰ºöÊâßË°åÂêéÈù¢ÁöÑFSTP ST(1)Êåá‰ª§ÔºåÊääSTÔºà0ÔºâÁöÑÂÄºÂ§çÂà∂Âà∞Êìç‰ΩúÊï∞‰∏≠ÔºåÁÑ∂Âêé‰ªéFPUÊ†àÈáåÊäõÂá∫‰∏Ä‰∏™ÂÄº„ÄÇÊç¢Âè•ËØùËØ¥ÔºåËøôÊù°Êåá‰ª§ÊääSTÔºà0ÔºâÁöÑÂÄºÔºàÂç≥ÂèòÈáè_aÁöÑÂÄºÔºâÂ§çÂà∂Âà∞STÔºà1ÔºâÂØÑÂ≠òÂô®ÔºõÊ≠§ÂêéÊ†àÈ°∂ÁöÑ2‰∏™ÂÄºÈÉΩÊòØ_a„ÄÇÁÑ∂ÂêéÔºåÁõ∏ÂΩì‰∫éPOPÂá∫‰∏Ä‰∏™ÂÄºÊù•Ôºå‰ΩøST(0)ÂØÑÂ≠òÂô®ÁöÑÂÄº‰∏∫_aÔºåÂáΩÊï∞ÈöèÂç≥ÁªìÊùü„ÄÇ</p>
<p>Âú®<em>b</em>&gt;<em>a</em>Êàñ<em>a</em>==<em>b</em>ÁöÑÊÉÖÂÜµ‰∏ãÔºåÁ®ãÂ∫èÂ∞ÜËß¶ÂèëÊù°‰ª∂ËΩ¨ÁßªÊåá‰ª§JNE„ÄÇ‰ªéST(0)ÂèñÂÄº„ÄÅÂÜçËµãÂÄºÁªôST(0)ÂØÑÂ≠òÂô®ÔºåÁõ∏ÂΩì‰∫éNOPÊìç‰ΩúÊ≤°ÊúâÂÆûÈôÖÊÑè‰πâ„ÄÇÊé•ÁùÄÂÆÉ‰ªéÊ†àÈáåPOPÂá∫‰∏Ä‰∏™ÂÄºÔºå‰ΩøST(0)ÁöÑÂÄº‰∏∫ÂÖàÂâçST(1)ÁöÑÂÄºÔºå‰πüÂ∞±ÊòØÂèòÈáè_b„ÄÇÁÑ∂ÂêéÁªìÊùüÊú¨ÂáΩÊï∞„ÄÇÂ§ßÊ¶ÇÊòØÂõ†‰∏∫FPUÁöÑÊåá‰ª§ÈõÜÈáåÊ≤°ÊúâPOPÂπ∂ËàçÂºÉÊ†àÈ°∂ÂÄºÁöÑÊåá‰ª§ÔºåÊâÄ‰ª•Êâç‰ºöÂá∫Áé∞ËøôÊ†∑ÁöÑÊ±áÊä•Êåá‰ª§„ÄÇ</p>
</li>
</ul>
<h2 id="chap18-Êï∞ÁªÑ"><a class="markdownIt-Anchor" href="#chap18-Êï∞ÁªÑ"></a> Chap18 Êï∞ÁªÑ</h2>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> i<span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">20</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>i<span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">20</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token function">printf</span> <span class="token punctuation">(</span><span class="token string">"a[%d]=%d\n"</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span> 
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Áî®msvs 2008 ËøõË°åÁºñËØë</p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">_TEXT     SEGMENT
_i$ &#x3D; -84              ; size &#x3D; 4
_a$ &#x3D; -80              ; size &#x3D; 80
_main      PROC
    push   ebp
    mov    ebp, esp
    sub    esp, 84    ; 00000054H
    mov    DWORD PTR _i$[ebp], 0;i&#x3D;0
    jmp    SHORT $LN6@main
$LN5@main:;i+&#x3D;1 
    mov    eax, DWORD PTR _i$[ebp]
    add    eax,  1
    mov    DWORD PTR _i$[ebp], eax
$LN6@main:
    cmp    DWORD PTR _i$[ebp], 20; 00000014H
    jge    SHORT $LN4@main
    mov    ecx, DWORD PTR _i$[ebp];i&lt;20
    shl    ecx, 1;ecx*2&#x3D;2i
    mov    edx, DWORD PTR _i$[ebp]
    mov    DWORD PTR _a$[ebp+edx*4], ecx;a[i]&#x3D;2i
    jmp    SHORT $LN5@main
$LN4@main:;i&#x3D;0
    mov    DWORD PTR _i$[ebp], 0
    jmp    SHORT $LN3@main
$LN2@main:
    mov    eax, DWORD PTR _i$[ebp]
    add    eax, 1
    mov    DWORD PTR _i$[ebp], eax
$LN3@main:;for i in range(20) printf(a[i])
    cmp    DWORD PTR _i$[ebp], 20    ; 00000014H
    jge    SHORT $LN1@main;ret
    mov    ecx, DWORD PTR _i$[ebp]
    mov    edx, DWORD PTR _a$[ebp+ecx*4]
    push   edx
    mov    eax, DWORD PTR _i$[ebp]
    push   eax
    push   OFFSET $SG2463
    call   _printf
    add    esp, 12        ; 0000000cH
    jmp    SHORT $LN2@main
$LN1@main:
    xor    eax, eax
    mov    esp, ebp
    pop    ebp
    ret    0
_main      ENDP<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>Á®ãÂ∫è‰∏∫Êï∞ÁªÑÁî≥ËØ∑‰∫Ü80Â≠óËäÇÁöÑÊ†àÁ©∫Èó¥Ôºå‰ª•Â≠òÂÇ®20‰∏™4Â≠óËäÇÂÖÉÁ¥†„ÄÇ</li>
<li>Âõ†‰∏∫ÂÖ®ÈÉ®Êï∞ÁªÑÈÉΩÂ≠òÂÇ®‰∫éÊ†à‰∏≠ÔºåÊâÄ‰ª•Êàë‰ª¨ÂèØ‰ª•Âú®ÂÜÖÂ≠òÊï∞ÊçÆÁ™óÂè£ÈáåÁúãÂà∞Êï¥‰∏™Êï∞ÁªÑ„ÄÇ</li>
</ul>
<hr />
<p>gcc</p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">                public main
main            proc near                   ; DATA XREF: _start+17

var_70          &#x3D; dword ptr -70h
var_6C          &#x3D; dword ptr -6Ch
var_68          &#x3D; dword ptr -68h
i_2             &#x3D; dword ptr -54h
i               &#x3D; dword ptr -4

                push     ebp
                mov      ebp, esp
                and      esp, 0FFFFFFF0h;ÂØπÈΩê
                sub      esp, 70h
                mov      [esp+70h+i], 0     ; i&#x3D;0
                jmp      short loc_804840A

loc_80483F7:
                mov      eax, [esp+70h+i]
                mov      edx, [esp+70h+i]
                add      edx, edx           ; edx&#x3D;i*2
                mov      [esp+eax*4+70h+i_2], edx
                add      [esp+70h+i], 1     ;  i++

loc_804840A:
                cmp      [esp+70h+i], 13h;19
                jle      short loc_80483F7;i&lt;&#x3D;19
                mov      [esp+70h+i], 0;i&#x3D;0
                jmp      short loc_8048441

loc_804841B:
                mov      eax, [esp+70h+i]
                mov      edx, [esp+eax*4+70h+i_2]
                mov      eax, offset aADD ; &quot;a[%d]&#x3D;%d\n&quot;
                mov      [esp+70h+var_68], edx
                mov      edx, [esp+70h+i]
                mov      [esp+70h+var_6C], edx
                mov      [esp+70h+var_70], eax
                call     _printf
                add      [esp+70h+i], 1

loc_8048441:
                cmp      [esp+70h+i], 13h
                jle      short loc_804841B;i&lt;&#x3D;19
                mov      eax, 0
                leave
                retn
main            endp<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>
<p>ÂÆûÈôÖ‰∏äÂèòÈáè==<em>a</em>ÁöÑÊï∞ÊçÆÁ±ªÂûãÊòØÊï¥ÂûãÊåáÈíà„ÄÇ‰∏•Ê†ºÂú∞ËØ¥ÔºåÂú®ÊääÊï∞ÁªÑ‰º†ÈÄíÁªôÂáΩÊï∞ÁöÑÊó∂ÂÄôÔºå‰º†ÈÄíÁöÑÊï∞ÊçÆÂ∞±ÊòØÊåáÂêëÁ¨¨‰∏Ä‰∏™ÂÖÉÁ¥†ÁöÑÊåáÈíàÔºåÊàë‰ª¨ÂÜçÊ†πÊçÆËøô‰∏™ÊåáÈíàÂ∞±ÂèØ‰ª•ËΩªÊùæÂú∞ËÆ°ÁÆóÂá∫Êï∞ÁªÑÊØè‰∏™ÂÖÉÁ¥†ÁöÑÂú∞ÂùÄÔºàÂç≥ÊåáÈíàÔºâ„ÄÇ==Â¶ÇÊûú‰ΩøÁî®a[idx]ÁöÑÂΩ¢ÂºèË°®Á§∫Êï∞ÁªÑÂÖÉÁ¥†ÔºåÂÖ∂‰∏≠idxÊòØÊï∞ÁªÑÂÖÉÁ¥†Âú®Êï∞ÁªÑÈáåÁöÑÊéíÂàóÂ∫èÂè∑ÔºàÂç≥Á¥¢ÂºïÂè∑ÔºâÔºåÈÇ£‰πàÂ∞±ÂèØ‰ª•ÈÄöËøáÊï∞ÁªÑÁ¨¨‰∏Ä‰∏™ÂÖÉÁ¥†ÁöÑÂú∞ÂùÄ„ÄÅÁ¥¢ÂºïÂè∑ÂíåÊï∞ÊçÆÂÆπÈáèÊ±ÇÂæóÂêÑ‰∏™ÂÖÉÁ¥†ÁöÑÂú∞ÂùÄ„ÄÇ</p>
<p>‰∏æ‰∏™ÂÖ∏ÂûãÁöÑ‰æãÂ≠êÔºöÂ≠óÁ¨¶‰∏≤Â∏∏Èáè‚Äústring‚ÄùÊòØÂ≠óÁ¨¶ÂûãÊï∞ÁªÑÔºåÂÆÉÁöÑÊØè‰∏™Â≠óÁ¨¶ÂÖÉÁ¥†ÈÉΩÊòØconst char*ÂûãÊï∞ÊçÆ„ÄÇ‰ΩøÁî®Á¥¢ÂºïÂè∑‰πãÂêéÔºåÊàë‰ª¨Â∞±ÂèØ‰ª•‰ΩøÁî®‚Äústring‚Äù[i]ÁöÑÂΩ¢ÂºèÊèèËø∞Â≠óÁ¨¶‰∏≤‰∏≠ÁöÑÁ¨¨<em>i</em>‰∏™Â≠óÁ¨¶‚Äî‚ÄîËøôÊ≠£ÊòØC/CÔºãÔºãË°®ËææÂºèÁöÑË°®Á§∫ÊñπÊ≥ïÔºÅ</p>
</li>
</ul>
<h3 id="ÁºìÂÜ≤Âå∫Ê∫¢Âá∫"><a class="markdownIt-Anchor" href="#ÁºìÂÜ≤Âå∫Ê∫¢Âá∫"></a> ÁºìÂÜ≤Âå∫Ê∫¢Âá∫</h3>
<p>‰ªéÊ±áÁºñ‰ª£Á†ÅÂèØ‰ª•ÁúãÂá∫:ÁºñËØëÂô®Ê≤°ÊúâÂØπÁ¥¢ÂºïËøõË°åÂà§Êñ≠Ôºå</p>
<p>ÂèØ‰ª•ËÆøÈóÆa[20]</p>
<hr />
<p>ÂêëÊï∞ÁªÑËæπÁïå‰πãÂ§ñÁöÑÂú∞ÂùÄËµãÂÄº</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
<span class="token punctuation">&#123;</span>
        <span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> i<span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">30</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
                 a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>i<span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Á®ãÂ∫èÂèëÁîü‰∫ÜÂ¥©Ê∫É</p>
<p>‰ΩøÁî®onlydbgÂä†ËΩΩÔºåË∑üË∏™Á®ãÂ∫èÂ¥©Ê∫ÉÂéüÂõ†</p>
<ul>
<li>
<p>ÂΩì30‰∏™Âæ™ÁéØÁªìÊùüÂêéÔºå<code>EIP</code>ÁöÑÂÄºÊòØ0x15ÔºåÊòæÁÑ∂‰∏çÂêàÊ≥ïÔºåÊ≠§Êó∂<code>EBP</code>‰∏∫0x14Ôºå<code>ECX</code>Âíå<code>EDX</code>ÂÄº‰∏∫0x1D</p>
<p>Why?</p>
</li>
<li>
<p>È¶ñÂÖàÂõûÈ°æÊ†àÁöÑÁªìÊûÑ</p>
<p>Ôºåmain()ÂáΩÊï∞ÁöÑÊ†àÁªìÊûÑÂ¶Ç‰∏ãÔºö</p>
<table>
<thead>
<tr>
<th>ESP</th>
<th><em>i</em>ÊâÄÂç†Áî®ÁöÑ4Â≠óËäÇ</th>
</tr>
</thead>
<tbody>
<tr>
<td>ESP+4</td>
<td><em>a</em>[20]Âç†Áî®ÁöÑ80Â≠óËäÇ</td>
</tr>
<tr>
<td>ESP+84</td>
<td>‰øùÂ≠òËøáÁöÑEBP</td>
</tr>
<tr>
<td>ESP+88</td>
<td>ËøîÂõûÂú∞ÂùÄ</td>
</tr>
</tbody>
</table>
<p>ËµãÂÄºÁªô<em>a</em>[19]ÁöÑÊó∂ÂÄôÔºåÊï∞ÁªÑ<em>a</em>[]Â∑≤ÁªèË¢´ÂÖ®ÈÉ®ËµãÂÄº„ÄÇ</p>
<p>ËµãÂÄºÁªôa[20]ÂÆûÈôÖ‰∏ä‰øÆÊîπÁöÑÊòØÊ†àÈáå‰øùÂ≠òÁöÑ<code>EBP</code>ÔºåÊú¨‰æã‰∏≠Â∞Ü20ËµãÂÄº‰∫ÜÁªôa[10],ÂáΩÊï∞ÈÄÄÂá∫‰πãÂâç‰ºöÂ∞ÜebpËÆæÁΩÆ‰∏∫Ëøô‰∏™ÂÄºÔºåÂõ†Ê≠§ebp‰∏∫0x14</p>
<p>ÊúÄÂêéËøêË°å<code>RET</code>Êåá‰ª§ÔºåÁõ∏ÂΩì‰∫é<code>POP EIP</code>Ôºå<code>RET</code>Êåá‰ª§Â∞ÜÁ®ãÂ∫èÁöÑÊéßÂà∂ÊùÉ‰º†ÈÄíÁªôÊ†àÈáåÁöÑËøîÂõûÂú∞ÂùÄÔºå‰∏çËøáÊ≠§Êó∂Ëøô‰∏™ÂÄº‰∏∫0x15ÔºåËøôÈáåÊ≤°ÊúâÂèØÊâßË°å‰ª£Á†ÅÔºåÂõ†Ê≠§Â¥©Ê∫É</p>
</li>
<li>
<p>‰∫ãÂÆû‰∏äÔºåËøôÂ∞±ÊòØÁºìÂÜ≤Âå∫Ê∫¢Âá∫ÊîªÂáªÁöÑÂéüÁêÜÔºåÊàë‰ª¨ÂèØ‰ª•Âä´ÊåÅËøîÂõûÂú∞ÂùÄÊù•ÊéßÂà∂eipÊù•Ë∑≥ËΩ¨Âà∞ÂÖ∂‰ªñÁ®ãÂ∫èÁöÑÂú∞ÂùÄ</p>
<p>ÁõÆÂâçÂ∑≤ÁªèÊúâ‰∫ÜÂæàÂ§öÊâãÊÆµÊù•Èò≤Âæ°ËøôÁßçÊîªÂáªÔºåÂ≠¶pwnÁöÑÊó∂ÂÄôÂÜçÊ∑±ÂÖ•‰∫ÜËß£</p>
<ul>
<li>
<p>canaryÔºåÈöèÊú∫ÂÜôÂÖ•ÈöèÊú∫Êï∞ÔºåÂú®ÂáΩÊï∞ÁªìÊùü‰πãÂâçÊ£ÄÊü•Ëøô‰∫õÂÄºÊòØÂê¶ÂèëÁîüÂèòÂåñ</p>
</li>
<li>
<p>Â¶ÇÊûúÂêØÁî®MSVCÁöÑRTC1ÂíåRTCsÈÄâÈ°πÁºñËØëÊú¨Á´†ÂºÄÂ§¥ÁöÑÈÇ£ÊÆµÁ®ãÂ∫èÔºåÂ∞±‰ºöÂú®Ê±áÁºñÊåá‰ª§ÈáåÁúãÂà∞ÂáΩÊï∞Âú®ÈÄÄÂá∫‰πãÂâçË∞ÉÁî®@_RTC_CheckStackVars@8ÔºåÁî®‰ª•Ê£ÄÊµã‚ÄúÁôæÁÅµÈ∏ü‚ÄùÊòØÂê¶‰ºöÊä•Ë≠¶„ÄÇ</p>
</li>
<li>
<p>Áî®gccÁºñËØë</p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">		mov     eax, DWORD PTR [ebp-12]
        xor     eax, DWORD PTR gs:20Ôºõ 
        jne     .L5
        mov     ebx, DWORD PTR [ebp-4]
.L5:
        call    __stack_chk_fail<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ÊòæÁÑ∂ÈöèÊú∫ÂÄº‰Ωç‰∫égsÔºö20,</p>
</li>
</ul>
</li>
<li>
<p>gsÂºÄÂ§¥ÁöÑÂØÑÂ≠òÂô®Â∞±ÊòØÂ∏∏ËØ¥ÁöÑÊÆµÂØÑÂ≠òÂô®„ÄÇÂú®MS-DOSÂíåÂü∫‰∫éDOSÁöÑÁ≥ªÁªüÈáåÔºåÊÆµÂØÑÂ≠òÂô®ÁöÑ‰ΩúÁî®ÂæàÂπøÊ≥õ„ÄÇ‰ΩÜÊòØÔºå‰ªäÂ§©ÂÆÉÁöÑ‰ΩúÁî®ÂèëÁîü‰∫ÜÂèòÂåñ„ÄÇÁÆÄÂçïÂú∞ËØ¥ÔºåLinux‰∏ãÁöÑgs ÂØÑÂ≠òÂô®ÊÄªÊòØÊåáÂêëTLSÔºàÂèÇËßÅÁ¨¨65Á´†Ôºâ‚Äî‚ÄîÂ≠òÂÇ®Á∫øÁ®ãÁöÑÂ§öÁßçÁâπÂÆö‰ø°ÊÅØ„ÄÇÔºàWin32ÁéØÂ¢É‰∏ãÁöÑfsÂØÑÂ≠òÂô®Ëµ∑Âà∞Linux‰∏ãgsÂØÑÂ≠òÂô®ÁöÑ‰ΩúÁî®„ÄÇWin32ÁöÑfsÂØÑÂ≠òÂô®ÊåáÂêëTIBÔºâ</p>
</li>
</ul>
<h3 id="ÂÖ∂‰ªñ"><a class="markdownIt-Anchor" href="#ÂÖ∂‰ªñ"></a> ÂÖ∂‰ªñ</h3>
<p>Áé∞Âú®Êàë‰ª¨Â∫îËØ•ÂèØ‰ª•ÁêÜËß£‰∏∫‰ªÄ‰πàC/C++ÁºñËØë‰∏ç‰∫Ü‰∏ãÈù¢ÁöÑÁ®ãÂ∫è‰∫Ü„ÄÇ</p>
<pre class="line-numbers language-none"><code class="language-none">void f(int size)
&#123;
    int a[size];
...
&#125;;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><mark>Âú®ÁºñËØëÈò∂ÊÆµÔºåÁºñËØëÂô®ÂøÖÈ°ªÁ°ÆÂàáÂú∞Áü•ÈÅìÈúÄË¶ÅÁªôÊï∞ÁªÑÂàÜÈÖçÂ§öÂ§ßÁöÑÂ≠òÂÇ®Á©∫Èó¥ÔºåÂÆÉÈúÄË¶Å‰∫ãÂÖàÊòéÁ°ÆÂàÜÈÖçÂ±ÄÈÉ®Ê†àÊàñÊï∞ÊçÆÊÆµÔºàÂÖ®Â±ÄÂèòÈáèÔºâÁöÑÊ†ºÂ±ÄÔºåÊâÄ‰ª•ÁºñËØëÂô®Êó†Ê≥ïÂ§ÑÁêÜ‰∏äËø∞ËøôÁßçÈïøÂ∫¶ÂèØÂèòÁöÑÊï∞ÁªÑ„ÄÇ</mark></p>
<p>Â¶ÇÊûúÊó†Ê≥ï‰∫ãÂÖàÁ°ÆÂÆöÊï∞ÁªÑÁöÑÈïøÂ∫¶ÔºåÈÇ£‰πàÊàë‰ª¨Â∞±Â∫îÂΩì‰ΩøÁî®malloc()ÂáΩÊï∞ÂàÜÈÖçÂá∫‰∏ÄÂùóÂÜÖÂ≠òÔºåÁÑ∂ÂêéÁõ¥Êé•ÊåâÁÖßÂ∏∏ËßÑÂèòÈáèÊï∞ÁªÑÁöÑÊñπÂºèËÆøÈóÆËøôÂùóÂÜÖÂ≠òÔºõÊàñËÄÖÈÅµÂæ™C99Ê†áÂáÜÔºàÂèÇËßÅISO07Ôºå6.7.5/2ÔºâËøõË°åÂ§ÑÁêÜÔºå‰ΩÜÊòØÈÅµÂæ™C99Ê†áÂáÜËÄåËÆæËÆ°Âá∫Êù•ÁöÑÁ®ãÂ∫èÔºåÂÜÖÈÉ®ÂÆûÁé∞ÁöÑÊñπÊ≥ïÊõ¥Êé•Ëøëalloca()ÂáΩÊï∞ÔºàËØ¶ÊÉÖËØ∑ÂèÇÈòÖ5.2.4ËäÇÔºâ„ÄÇ</p>
<h3 id="Â≠óÁ¨¶‰∏≤ÊåáÈíà"><a class="markdownIt-Anchor" href="#Â≠óÁ¨¶‰∏≤ÊåáÈíà"></a> Â≠óÁ¨¶‰∏≤ÊåáÈíà</h3>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>

<span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> month1<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span>
<span class="token punctuation">&#123;</span>
        <span class="token string">"January"</span><span class="token punctuation">,</span>
        <span class="token string">"February"</span><span class="token punctuation">,</span>
        <span class="token string">"March"</span><span class="token punctuation">,</span>
        <span class="token string">"April"</span><span class="token punctuation">,</span>
        <span class="token string">"May"</span><span class="token punctuation">,</span>
        <span class="token string">"June"</span><span class="token punctuation">,</span>
        <span class="token string">"July"</span><span class="token punctuation">,</span>
        <span class="token string">"August"</span><span class="token punctuation">,</span>
        <span class="token string">"September"</span><span class="token punctuation">,</span>
        <span class="token string">"October"</span><span class="token punctuation">,</span>
        <span class="token string">"November"</span><span class="token punctuation">,</span>
        <span class="token string">"December"</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">// in 0..11 range</span>
<span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> <span class="token function">get_month1</span> <span class="token punctuation">(</span><span class="token keyword">int</span> month<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> month1<span class="token punctuation">[</span>month<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<hr />
<p>msvs x64</p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">_DATA   SEGMENT
month1  DQ      FLAT:$SG3122
        DQ      FLAT:$SG3123
        DQ      FLAT:$SG3124
        DQ      FLAT:$SG3125
        DQ      FLAT:$SG3126
        DQ      FLAT:$SG3127
        DQ      FLAT:$SG3128
        DQ      FLAT:$SG3129
        DQ      FLAT:$SG3130
        DQ      FLAT:$SG3131
        DQ      FLAT:$SG3132
        DQ      FLAT:$SG3133
$SG3122 DB     &#39;January&#39;, 00H
$SG3123 DB     &#39;February&#39;, 00H
$SG3124 DB     &#39;March&#39;, 00H
$SG3125 DB     &#39;April&#39;, 00H
$SG3126 DB     &#39;May&#39;, 00H
$SG3127 DB     &#39;June&#39;, 00H
$SG3128 DB     &#39;July&#39;, 00H
$SG3129 DB     &#39;August&#39;, 00H
$SG3130 DB     &#39;September&#39;, 00H
$SG3156 DB     &#39;%s&#39;, 0aH, 00H
$SG3131 DB     &#39;October&#39;, 00H
$SG3132 DB     &#39;November&#39;, 00H
$SG3133 DB     &#39;December&#39;, 00H
_DATA   ENDS

month$ &#x3D; 8
get_month1 PROC
         movsxd  rax, ecx
         lea     rcx, OFFSET FLAT:month1
         mov     rax, QWORD PTR [rcx+rax*8]
         ret     0
get_month1 ENDP<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li><mark>MOVSXD</mark>ÊääECXÁöÑ32‰ΩçÊï¥ÂûãÊï∞ÂÄº„ÄÅËøûÂêåÂÖ∂Á¨¶Âè∑Êâ©Â±ï‰Ωç(sign-extension)Êâ©Â±ï‰∏∫64‰ΩçÊï¥ÂûãÊï∞ÊçÆÔºåÂÜçÂ≠òÂÇ®‰∫éRAXÂØÑÂ≠òÂô®‰∏≠„ÄÇECXÂ≠òÂÇ®ÁöÑ‚ÄúÊúà‰ªΩ‚Äù‰ø°ÊÅØÊòØ32‰ΩçÊï¥ÂΩ¢Êï∞ÊçÆ„ÄÇÂõ†‰∏∫Á®ãÂ∫èÈöèÂêéËøòË¶ÅËøõË°å64‰ΩçËøêÁÆóÔºåÊâÄ‰ª•ÈúÄË¶ÅÊääËæìÂÖ•ÂèòÈáèËΩ¨Êç¢‰∏∫64‰ΩçÂÄº„ÄÇ</li>
<li>ÁÑ∂ÂêéÂáΩÊï∞Êää<code>ÊåáÈíàË°®ÁöÑÂú∞ÂùÄÂ≠òÂÇ®‰∫éRCXÂØÑÂ≠òÂô®„ÄÇ</code></li>
<li>ÊúÄÂêéÔºåÂáΩÊï∞ÁöÑËæì<code>ÂÖ•ÂèòÈáè(month)ÁöÑÂÄº‰πò‰ª•8„ÄÅÂÜç‰∏éÊåáÈíàË°®ÁöÑÂú∞ÂùÄÁõ∏Âä†</code>„ÄÇÂõ†‰∏∫ÊòØ64‰ΩçÁ≥ªÁªüÁöÑÁºòÊïÖÔºåÊØè‰∏™Âú∞ÂùÄÔºàÂç≥ÊåáÈíàÔºâÁöÑÊï∞ÊçÆÈúÄË¶ÅÂç†Áî®64‰ΩçÔºàÂç≥8Â≠óËäÇÔºâ„ÄÇÊâÄ‰ª•ÊåáÈíàË°®‰∏≠ÁöÑÊØè‰∏™ÂÖÉÁ¥†ÈÉΩÂç†Áî®8Â≠óËäÇÁ©∫Èó¥„ÄÇÂõ†Ê≠§ÔºåÊúÄÁªàÂ≠óÁ¨¶‰∏≤ÁöÑÂú∞ÂùÄË¶ÅÂä†‰∏ämonth*8„ÄÇMOVÊåá‰ª§‰∏ç‰ªÖÂÆåÊàê‰∫ÜÂ≠óÁ¨¶‰∏≤Âú∞ÂùÄÁöÑËÆ°ÁÆóÔºåËÄå‰∏îËøòÂÆåÊàê‰∫ÜÊåáÈíàË°®ÁöÑÊü•ËØ¢„ÄÇÂú®ËæìÂÖ•ÂÄº‰∏∫1Êó∂ÔºåÂáΩÊï∞Â∞ÜËøîÂõûÂ≠óÁ¨¶‰∏≤‚ÄúFebruary‚ÄùÁöÑÊåáÈíàÂú∞ÂùÄ„ÄÇ</li>
</ul>
<hr />
<p><code>Optimizing gcc</code></p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">movsx   rdi, edi
     mov     rax, QWORD PTR month1[0+rdi*8]
     ret<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<hr />
<p><code>Optimizing MSVS</code></p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">_month$ &#x3D; 8
_get_month1 PROC
        mov     eax, DWORD PTR _month$[esp-4]
        mov     eax, DWORD PTR _month1[eax*4]
        ret     0
_get_month1 ENDP<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>32‰ΩçÁ®ãÂ∫èÂ∞±‰∏çÁî®ÊääËæìÂÖ•ÂÄºËΩ¨Âåñ‰∏∫64‰ΩçÊï∞ÊçÆ‰∫Ü„ÄÇÊ≠§Â§ñÔºå32‰ΩçÁ≥ªÁªüÁöÑÊåáÈíàÂ±û‰∫é4Â≠óËäÇÊï∞ÊçÆÔºåÊâÄ‰ª•Áõ∏ÂÖ≥ÁöÑËÆ°ÁÆóÂõ†Â≠êÂèò‰∏∫‰∫Ü4„ÄÇ</p>
<h3 id="Â§öÁª¥Êï∞ÁªÑ"><a class="markdownIt-Anchor" href="#Â§öÁª¥Êï∞ÁªÑ"></a> Â§öÁª¥Êï∞ÁªÑ</h3>
<p>ËÆ°ÁÆóÊú∫ÂÜÖÂ≠òÊòØËøûÁª≠ÁöÑÁ∫øÊÄßÁ©∫Èó¥ÔºåÂÆÉÂèØ‰ª•‰∏é‰∏ÄÁª¥Êï∞ÁªÑÁõ¥Êé•ÂØπÂ∫î„ÄÇÂú®Ë¢´ÊãÜÂàÜÊàêÂ§ö‰∏™‰∏ÄÁª¥Êï∞ÁªÑ‰πãÂêéÔºåÂ§öÁª¥Êï∞ÁªÑ‰∏éÂÜÖÊ†àÁ∫øÊÄßÁ©∫Èó¥ÂêåÊ†∑Â≠òÂú®Áõ¥Êé•ÂØπÂ∫îÁöÑÂ≠òÂÇ®ÂÖ≥Á≥ª„ÄÇ</p>
<table>
<thead>
<tr>
<th>Â≠òÂÇ®Âú∞ÂùÄ</th>
<th>Êï∞ÁªÑÂÖÉÁ¥†</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>[0] [0]</td>
</tr>
<tr>
<td>1</td>
<td>[0] [1]</td>
</tr>
<tr>
<td>2</td>
<td>[0] [2]</td>
</tr>
<tr>
<td>3</td>
<td>[0] [3]</td>
</tr>
<tr>
<td>4</td>
<td>[1] [0]</td>
</tr>
<tr>
<td>5</td>
<td>[1] [1]</td>
</tr>
<tr>
<td>6</td>
<td>[1] [2]</td>
</tr>
<tr>
<td>7</td>
<td>[1] [3]</td>
</tr>
<tr>
<td>8</td>
<td>[2] [0]</td>
</tr>
<tr>
<td>9</td>
<td>[2] [1]</td>
</tr>
<tr>
<td>10</td>
<td>[2] [2]</td>
</tr>
<tr>
<td>11</td>
<td>[2] [3]</td>
</tr>
</tbody>
</table>
<p>Âú®ÂÜÖÂ≠ò‰πã‰∏≠Ôºå3√ó4ÁöÑ‰∫åÁª¥Êï∞ÁªÑÂ∞Ü‰æùÊ¨°Â≠òÂÇ®‰∏∫ËøûÁª≠ÁöÑ12‰∏™ÂÖÉÁ¥†ÔºåÂ¶ÇË°®18.2ÊâÄÁ§∫„ÄÇ</p>
<p>Âú®<code>ËÆ°ÁÆó‰∏äËø∞Êï∞ÁªÑ‰∏≠Êüê‰∏™ÁâπÂÆöÂÖÉÁ¥†ÁöÑÂÜÖÂ≠òÂ≠òÂÇ®ÁºñÂè∑Êó∂ÔºåÂèØ‰ª•ÂÖàÂ∞Ü‰∫åÁª¥Á¥¢ÂºïÂè∑ÁöÑÁ¨¨‰∏Ä‰∏™Á¥¢ÂºïÂè∑‰πò‰ª•4ÔºàÁü©ÈòµÂÆΩÂ∫¶ÔºâÔºåËÄåÂêéÂä†‰∏äÁ¨¨‰∫å‰∏™Á¥¢ÂºïÂè∑„ÄÇ</code>ËøôÁßçÊñπÂºèÂ∞±ÊòØC/C++„ÄÅPythonÊâÄÁî®ÁöÑ‚ÄúË°å‰ºòÂÖàÁöÑÈ°∫Â∫è‚ÄùÔºàrow-majororderÔºâ„ÄÇ<mark>ÊâÄË∞ìË°å‰ºòÂÖàÔºåÂ∞±ÊòØÂÖàÁî®Á¨¨‰∏ÄË°åÊéíÊª°Á¨¨‰∏Ä‰∏™Á¥¢ÂºïÂè∑‰∏ãÁöÑÊâÄÊúâÂÖÉÁ¥†ÔºåÁÑ∂ÂêéÂÜç‰æùÊ¨°ÁºñÊéíÂÖ∂‰ªñÂêÑË°å„ÄÇ</mark></p>
<p><code>‰ªéÊÄßËÉΩÂèäÁºìÂ≠òÁöÑËßíÂ∫¶Êù•ÁúãÔºå‰∏éÊï∞ÊçÆÁöÑÂ≠òÂÇ®ÊñπÊ°àÔºàscheme)ÂíåÁªÑÁªáÊñπÂºèÔºàdata organizationÔºâÂåπÈÖçÁöÑ‰ºòÂÖàÈ°∫Â∫èÊúÄ‰ºò</code>„ÄÇÂè™Ë¶ÅÁõ∏‰∫íÂåπÈÖçÔºåÈÇ£‰πàÁ®ãÂ∫èÂ∞±ÂèØ‰ª•ËøûÁª≠ËÆøÈóÆÊï∞ÊçÆÔºåÊï¥‰ΩìÊÄßËÉΩÂ∞±‰ºöÊèêÈ´ò„ÄÇÊâÄ‰ª•ÔºåÂ¶ÇÊûúÁ®ãÂ∫è‰ª•‚ÄúÈÄêË°å‚ÄùÁöÑÊñπÂºèËÆøÈóÆÊï∞ÊçÆÔºåÈÇ£‰πàÂ∞±Â∫îÂΩì‰ª•Ë°å‰ºòÂÖàÁöÑÈ°∫Â∫èÁªÑÁªáÊï∞ÁªÑÔºõÂèç‰πã‰∫¶ÁÑ∂„ÄÇ</p>
<hr />
<p>ÊòæÁÑ∂Ê†πÊçÆËøôÁßçËßÑÂàôÊàë‰ª¨ÂèØ‰ª•Âà©Áî®‰∏ÄÁª¥Êï∞ÁªÑÁöÑÊñπÂºèËÆøÈóÆ‰∫åÁª¥Êï∞ÁªÑ</p>
<p>‰æãÂ¶Ç</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>

<span class="token keyword">char</span> a<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">char</span> <span class="token function">get_by_coordinates1</span> <span class="token punctuation">(</span><span class="token keyword">char</span> array<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> array<span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">[</span>b<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">char</span> <span class="token function">get_by_coordinates2</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>array<span class="token punctuation">,</span> <span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
        <span class="token comment">// treat input array as one-dimensional</span>
        <span class="token comment">// 4 is array width here</span>
        <span class="token keyword">return</span> array<span class="token punctuation">[</span>a<span class="token operator">*</span><span class="token number">4</span><span class="token operator">+</span>b<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">char</span> <span class="token function">get_by_coordinates3</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>array<span class="token punctuation">,</span> <span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
        <span class="token comment">// treat input array as pointer,</span>
        <span class="token comment">// calculate address, get value at it</span>
        <span class="token comment">// 4 is array width here</span>
        <span class="token keyword">return</span> <span class="token operator">*</span><span class="token punctuation">(</span>array<span class="token operator">+</span>a<span class="token operator">*</span><span class="token number">4</span><span class="token operator">+</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        a<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token function">printf</span> <span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token function">get_by_coordinates1</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">printf</span> <span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token function">get_by_coordinates2</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">printf</span> <span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token function">get_by_coordinates3</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<hr />
<p><code>Optimizing gcc</code></p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">; RDI&#x3D;address of array
; RSI&#x3D;a
; RDX&#x3D;b

get_by_coordinates1:
; sign-extend input 32-bit int values &quot;a&quot; and &quot;b&quot; to 64-bit ones
        movsx   rsi, esi
        movsx   rdx, edx
        lea     rax, [rdi+rsi*4]
; RAX&#x3D;RDI+RSI*4&#x3D;address of array+a*4
        movzx   eax, BYTE PTR [rax+rdx]
; AL&#x3D;load byte at address RAX+RDX&#x3D;address of array+a*4+b
        ret

get_by_coordinates2:
        lea     eax, [rdx+rsi*4]
; RAX&#x3D;RDX+RSI*4&#x3D;b+a*4
        cdqe
        movzx   eax, BYTE PTR [rdi+rax]
; AL&#x3D;load byte at address RDI+RAX&#x3D;address of array+b+a*4
        ret

get_by_coordinates3:
        sal     esi, 2
; ESI&#x3D;a&lt;&lt;2&#x3D;a*4
; sign-extend input 32-bit int values &quot;a*4&quot; and &quot;b&quot; to 64-bit ones
        movsx   rdx, edx
        movsx   rsi, esi
        add     rdi, rsi
; RDI&#x3D;RDI+RSI&#x3D;address of array+a*4
        movzx   eax, BYTE PTR [rdi+rdx]
; AL&#x3D;load byte at address RDI+RDX&#x3D;address of array+a*4+b
        ret<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>‰∏âËÄÖÊ±áÁºñÂæàÊé•ËøëÂπ∂‰∏îËÆ°ÁÆóÁöÑ‰∏ãÊ†áÊòØ‰∏ÄÊ†∑ÁöÑ</p>
<hr />
<p>Â§öÁª¥Êï∞ÁªÑÁöÑÊÉÖÂÜµ‰πüÂ∑Æ‰∏çÂ§öÔºå‰æãÂ¶Ç‰∏âÁª¥</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>

<span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token punctuation">,</span> <span class="token keyword">int</span> z<span class="token punctuation">,</span> <span class="token keyword">int</span> value<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
        a<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token punctuation">[</span>z<span class="token punctuation">]</span><span class="token operator">=</span>value<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>msvs x86</code></p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">_DATA      SEGMENT
COMM       _a:DWORD:01770H
_DATA      ENDS
PUBLIC     _insert
_TEXT      SEGMENT
_x$ &#x3D; 8               ; size &#x3D; 4
_y$&#x3D;12                ; size &#x3D; 4
_z$&#x3D;16                ; size &#x3D; 4
_value$ &#x3D; 20          ; size &#x3D; 4
_insert     PROC
    push    ebp
    mov     ebp, esp
    mov     eax, DWORD PTR _x$[ebp]
    imul    eax, 2400                ; eax&#x3D;600*4*x
    mov     ecx, DWORD PTR _y$[ebp]
    imul    ecx, 120                 ; ecx&#x3D;30*4*y
    lea     edx, DWORD PTR _a[eax+ecx]; edx&#x3D;a + 600*4*x + 30*4*y
    mov     eax, DWORD PTR _z$[ebp]
    mov     ecx, DWORD PTR _value$[ebp]
    mov     DWORD PTR [edx+eax*4], ecx; *(edx+z*4)&#x3D;value
    pop     ebp
    ret     0
_insert     ENDP
_TEXT       ENDS<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Êï∞ÁªÑÂÖÉÁ¥†Âú∞ÂùÄ=600√ó4<em>x</em> + 30√ó4<em>y</em> + 4<em>z</em>„ÄÇ32‰ΩçÁ≥ªÁªüÈáåintÁ±ªÂûãÊòØ32‰ΩçÔºà4Â≠óËäÇÔºâÊï∞ÊçÆÔºåÊâÄ‰ª•Ë¶ÅÊØèÈ°πÈÉΩË¶Å‰πò‰ª•4„ÄÇ</p>
<hr />
<p><code>gcc</code></p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">           public  insert
insert     proc near

x          &#x3D; dword ptr 8
y          &#x3D; dword ptr  0Ch
z          &#x3D; dword ptr  10h
value      &#x3D; dword ptr  14h

           push    ebp
           mov     ebp, esp
           push    ebx
           mov     ebx, [ebp+x];ebx&#x3D;x
           mov     eax, [ebp+y];eax&#x3D;y
           mov     ecx, [ebp+z];ecx&#x3D;z
           lea     edx, [eax+eax]              ; edx&#x3D;y*2
           mov     eax, edx                    ; eax&#x3D;y*2
           shl     eax, 4                      ; eax&#x3D;(y*2)&lt;&lt;4 &#x3D; y*2*16 &#x3D; y*32
           sub     eax, edx                    ; eax&#x3D;y*32 - y*2&#x3D;y*30
           imul    edx, ebx, 600               ; edx&#x3D;x*600
           add     eax, edx                    ; eax&#x3D;eax+edx&#x3D;y*30 + x*600
           lea     edx, [eax+ecx]              ; edx&#x3D;y*30 + x*600 + z
           mov     eax, [ebp+value]
           mov     dword ptr ds:a[edx*4], eax  ; *(a+edx*4)&#x3D;value
           pop     ebx
           pop     ebp
           retn
insert     endp<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>gccÂú®ËÆ°ÁÆó30yËøõË°å‰∫Ü‰ºòÂåñ;(<em>y</em> + <em>y</em>) &lt;&lt; 4 ‚àí (<em>y</em> + <em>y</em>) = (2 <em>y</em>)&lt;&lt; 4 ‚àí 2 <em>y</em> = 2√ó16<em>y</em> ‚àí 2 <em>y</em> = 32 <em>y</em> ‚àí 2 <em>y</em> = 30 <em>y</em></li>
</ul>
<hr />
<p>ËÆ°ÁÆóÊú∫ÁöÑÊòæÁ§∫Â±èÂπïÊòØ‰∏Ä‰∏™2DÊòæÁ§∫Á©∫Èó¥Ôºå‰ΩÜÊòØÊòæÂ≠òÂç¥ÊòØ‰∏Ä‰∏™‰∏ÄÁª¥Á∫øÊÄßÊï∞ÁªÑ„ÄÇ</p>
<h3 id="‰∫åÁª¥Â≠óÁ¨¶‰∏≤Êï∞ÁªÑÁöÑÂ∞ÅË£ÖÊ†ºÂºè"><a class="markdownIt-Anchor" href="#‰∫åÁª¥Â≠óÁ¨¶‰∏≤Êï∞ÁªÑÁöÑÂ∞ÅË£ÖÊ†ºÂºè"></a> ‰∫åÁª¥Â≠óÁ¨¶‰∏≤Êï∞ÁªÑÁöÑÂ∞ÅË£ÖÊ†ºÂºè</h3>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;assert.h></span></span>

<span class="token keyword">const</span> <span class="token keyword">char</span> month2<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">=</span>
<span class="token punctuation">&#123;</span>
        <span class="token punctuation">&#123;</span> <span class="token char">'J'</span><span class="token punctuation">,</span><span class="token char">'a'</span><span class="token punctuation">,</span><span class="token char">'n'</span><span class="token punctuation">,</span><span class="token char">'u'</span><span class="token punctuation">,</span><span class="token char">'a'</span><span class="token punctuation">,</span><span class="token char">'r'</span><span class="token punctuation">,</span><span class="token char">'y'</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">0</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#123;</span> <span class="token char">'F'</span><span class="token punctuation">,</span><span class="token char">'e'</span><span class="token punctuation">,</span><span class="token char">'b'</span><span class="token punctuation">,</span><span class="token char">'r'</span><span class="token punctuation">,</span><span class="token char">'u'</span><span class="token punctuation">,</span><span class="token char">'a'</span><span class="token punctuation">,</span><span class="token char">'r'</span><span class="token punctuation">,</span><span class="token char">'y'</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">0</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#123;</span> <span class="token char">'M'</span><span class="token punctuation">,</span><span class="token char">'a'</span><span class="token punctuation">,</span><span class="token char">'r'</span><span class="token punctuation">,</span><span class="token char">'c'</span><span class="token punctuation">,</span><span class="token char">'h'</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">0</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#123;</span> <span class="token char">'A'</span><span class="token punctuation">,</span><span class="token char">'p'</span><span class="token punctuation">,</span><span class="token char">'r'</span><span class="token punctuation">,</span><span class="token char">'i'</span><span class="token punctuation">,</span><span class="token char">'l'</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">0</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#123;</span> <span class="token char">'M'</span><span class="token punctuation">,</span><span class="token char">'a'</span><span class="token punctuation">,</span><span class="token char">'y'</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">0</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#123;</span> <span class="token char">'J'</span><span class="token punctuation">,</span><span class="token char">'u'</span><span class="token punctuation">,</span><span class="token char">'n'</span><span class="token punctuation">,</span><span class="token char">'e'</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">0</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#123;</span> <span class="token char">'J'</span><span class="token punctuation">,</span><span class="token char">'u'</span><span class="token punctuation">,</span><span class="token char">'l'</span><span class="token punctuation">,</span><span class="token char">'y'</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">0</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#123;</span> <span class="token char">'A'</span><span class="token punctuation">,</span><span class="token char">'u'</span><span class="token punctuation">,</span><span class="token char">'g'</span><span class="token punctuation">,</span><span class="token char">'u'</span><span class="token punctuation">,</span><span class="token char">'s'</span><span class="token punctuation">,</span><span class="token char">'t'</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">0</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#123;</span> <span class="token char">'S'</span><span class="token punctuation">,</span><span class="token char">'e'</span><span class="token punctuation">,</span><span class="token char">'p'</span><span class="token punctuation">,</span><span class="token char">'t'</span><span class="token punctuation">,</span><span class="token char">'e'</span><span class="token punctuation">,</span><span class="token char">'m'</span><span class="token punctuation">,</span><span class="token char">'b'</span><span class="token punctuation">,</span><span class="token char">'e'</span><span class="token punctuation">,</span><span class="token char">'r'</span><span class="token punctuation">,</span>  <span class="token number">0</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#123;</span> <span class="token char">'O'</span><span class="token punctuation">,</span><span class="token char">'c'</span><span class="token punctuation">,</span><span class="token char">'t'</span><span class="token punctuation">,</span><span class="token char">'o'</span><span class="token punctuation">,</span><span class="token char">'b'</span><span class="token punctuation">,</span><span class="token char">'e'</span><span class="token punctuation">,</span><span class="token char">'r'</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">0</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#123;</span> <span class="token char">'N'</span><span class="token punctuation">,</span><span class="token char">'o'</span><span class="token punctuation">,</span><span class="token char">'v'</span><span class="token punctuation">,</span><span class="token char">'e'</span><span class="token punctuation">,</span><span class="token char">'m'</span><span class="token punctuation">,</span><span class="token char">'b'</span><span class="token punctuation">,</span><span class="token char">'e'</span><span class="token punctuation">,</span><span class="token char">'r'</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">0</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#123;</span> <span class="token char">'D'</span><span class="token punctuation">,</span><span class="token char">'e'</span><span class="token punctuation">,</span><span class="token char">'c'</span><span class="token punctuation">,</span><span class="token char">'e'</span><span class="token punctuation">,</span><span class="token char">'m'</span><span class="token punctuation">,</span><span class="token char">'b'</span><span class="token punctuation">,</span><span class="token char">'e'</span><span class="token punctuation">,</span><span class="token char">'r'</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">0</span> <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">// in 0..11 range</span>
<span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> <span class="token function">get_month2</span> <span class="token punctuation">(</span><span class="token keyword">int</span> month<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token operator">&amp;</span>month2<span class="token punctuation">[</span>month<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>Optimizing msvs</code></p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">month2  DB      04aH
        DB      061H
        DB      06eH
        DB      075H
        DB      061H
        DB      072H
        DB      079H
        DB      00H
        DB      00H
        DB      00H
...
get_month2 PROC
; sign-extend input argument and promote to 64-bit value
        movsxd  rax, ecx
        lea     rcx, QWORD PTR [rax+rax*4]
; RCX&#x3D;month+month*4&#x3D;month*5
        lea     rax, OFFSET FLAT:month2
; RAX&#x3D;pointer to table
        lea     rax, QWORD PTR [rax+rcx*2]
; RAX&#x3D;pointer to table + RCX*2&#x3D;pointer to table + month*5*2&#x3D;pointer to table + month*10
        ret     0
get_month2  ENDP<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>
<p>‰∏äËø∞Á®ãÂ∫èÂÆåÂÖ®‰∏çËÆøÈóÆÂÜÖÂ≠ò„ÄÇÊï¥‰∏™ÂáΩÊï∞ÁöÑÂäüËÉΩÔºåÂè™ÊòØËÆ°ÁÆóÊúà‰ªΩÂêçÁß∞Â≠óÁ¨¶‰∏≤ÁöÑÈ¶ñÂ≠óÊØçÊåáÈíàpointer_to_the_table+month*10„ÄÇÂÆÉ‰ΩøÁî®ÂçïÊù°LEAÊåá‰ª§ÔºåÊõø‰ª£‰∫ÜÂ§öÊù°MULÂíåMOVÊåá‰ª§„ÄÇ</p>
</li>
<li>
<p>‰∏äËø∞Êï∞ÁªÑÁöÑÊØè‰∏™Â≠óÁ¨¶‰∏≤ÈÉΩÂç†Áî®10Â≠óËäÇÁ©∫Èó¥„ÄÇÊúÄÈïøÁöÑÂ≠óÁ¨¶‰∏≤Áî±‚ÄúSeptember‚ÄùÂíåÂÜÖÂÆπ‰∏∫Èõ∂ÁöÑÂ≠óËäÇÊûÑÊàêÔºåÂÖ∂‰ΩôÁöÑÂ≠óÁ¨¶‰∏≤‰ΩøÁî®Èõ∂Â≠óËäÇÂØπÈΩêÔºåÊâÄ‰ª•ÊØè‰∏™Â≠óÁ¨¶‰∏≤ÈÉΩÂç†Áî®10‰∏™Â≠óËäÇ„ÄÇÂ¶ÇÊ≠§‰∏ÄÊù•ÔºåËÆ°ÁÆóÂ≠óÁ¨¶‰∏≤È¶ñÂú∞ÂùÄÁöÑÊñπÂºèÂèòÂæóÁÆÄÂçïÔºåÊï¥‰∏™ÂáΩÊï∞ÁöÑÊïàÁéá‰πü‰ºöÊúâÊâÄÊèêÈ´ò„ÄÇ</p>
</li>
</ul>
<hr />
<p><code>Optimizing gcc</code></p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">movsx   rdi, edi
    lea     rax, [rdi+rdi*4]
    lea     rax, month2[rax+rax]
    ret<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>Áõ¥Êé•‰ΩøÁî®LEAÊåá‰ª§ËøõË°å‰πò‰ª•10ÁöÑËÆ°ÁÆó</p>
<hr />
<p><code>Not Optimizing GCC</code></p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">get_month2:
        push    rbp
        mov     rbp, rsp
        mov     DWORD PTR [rbp-4], edi
        mov     eax, DWORD PTR [rbp-4]
        movsx   rdx, eax
; RDX &#x3D; sign-extended input value
        mov     rax, rdx
; RAX &#x3D; month
        sal     rax, 2
; RAX &#x3D; month&lt;&lt;2 &#x3D; month*4
        add     rax, rdx
; RAX &#x3D; RAX+RDX &#x3D; month*4+month &#x3D; month*5
        add     rax, rax
; RAX &#x3D; RAX*2 &#x3D; month*5*2 &#x3D; month*10
        add     rax, OFFSET FLAT:month2
; RAX &#x3D; month*10 + pointer to the table
        pop     rbp
        ret<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>‰∏çÂºÄÂêØ‰ºòÂåñÁºñËØëÔºåGCCÁöÑ‰πòÊ≥ïËøêÁÆóÊñπÂºè‰∏çÂêå</p>
<hr />
<p><code>Not Optimizing MSVS</code></p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">month$ &#x3D; 8
get_month2 PROC
        mov      DWORD PTR [rsp+8], ecx
        movsxd   rax, DWORD PTR month$[rsp]
; RAX &#x3D; sign-extended input value into 64-bit one
        imul     rax, rax, 10
; RAX &#x3D; RAX*10
        lea      rcx, OFFSET FLAT:month2
; RCX &#x3D; pointer to the table
        add      rcx, rax
; RCX &#x3D; RCX+RAX &#x3D; pointer to the table+month*10
        mov      rax, rcx
; RAX &#x3D; pointer to the table+month*10
        mov      ecx, 1
; RCX &#x3D; 1
        imul     rcx, rcx, 0
; RCX &#x3D; 1*0 &#x3D; 0
        add      rax, rcx
; RAX &#x3D; pointer to the table+month*10 + 0 &#x3D; pointer to the table+month*10
        ret      0
get_month2 ENDP<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>msvs‰∏çÂºÄÂêØ‰ºòÂåñÔºå‰ºöÁõ¥Êé•‰ΩøÁî®imulÊåá‰ª§ÔºåÁÑ∂ËÄå‰∏∫‰ªÄ‰πàRCXË¶Å‰πò‰ª•0Ôºü‰ΩúËÄÖËØ¥ËøôÊòØMSVSÁöÑÊÄ™Áôñ‰ª£Á†ÅÔºåÂ∏åÊúõÊàë‰ª¨‰ªéÁºñÁ®ã‰∫∫ÂëòÁöÑËßíÂ∫¶Êù•ÁêÜËß£Á®ãÂ∫èÁöÑÊ∫ê‰ª£Á†Å</li>
</ul>
<h3 id="problem-4"><a class="markdownIt-Anchor" href="#problem-4"></a> Problem</h3>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">; ÂáΩÊï∞ÂºÄÂßã
?s@@YAXPAN00@Z PROC; s, COMDAT

; Â∞ÜÂèÇÊï∞Âä†ËΩΩÂà∞ÂØÑÂ≠òÂô®‰∏≠
    mov    eax, DWORD PTR _b$[esp-4]  ; eax &#x3D; ÁªìÊùüÂú∞ÂùÄ - 4 (ÂÆûÈôÖÊòØ_bÁöÑÂú∞ÂùÄ)
    mov    ecx, DWORD PTR _a$[esp-4]  ; ecx &#x3D; Ëµ∑ÂßãÂú∞ÂùÄ - 4(aÁöÑÂú∞ÂùÄ)
    mov    edx, DWORD PTR _c$[esp-4]  ; edx &#x3D; ÁªìÊûúÂ≠òÊîæÂú∞ÂùÄ - 4(cÁöÑÂú∞ÂùÄ)

; ‰øùÂ≠òÂØÑÂ≠òÂô®ediÂíåesiÔºåÁî®‰∫éÂæ™ÁéØ,Âõ†‰∏∫Ê≠§ÂêéediÂíåesi‰Ωú‰∏∫ËÆ°Êï∞Âô®,
    push   esi  
    push   edi
    
; ËÆ°ÁÆóÊï∞ÁªÑÈïøÂ∫¶Ôºå‰∏§Ê¨°ÂáèÊ≥ïÂÆûË¥®‰∏äÂæóÂà∞ÁöÑÊòØ_b - _aÁöÑÂÄºÔºåÂç≥ÂÖÉÁ¥†‰∏™Êï∞Ôºå‰ΩÜËøôÈáåÊòØÁî®Â≠óËäÇÊï∞Ë°®Á§∫ÁöÑ
    sub    ecx, eax                  ; ecx &#x3D; Ëµ∑ÂßãÂú∞ÂùÄ‰∏éÁªìÊùüÂú∞ÂùÄ‰πãÈó¥ÁöÑË∑ùÁ¶ªÔºàÂ≠óËäÇÊï∞Ôºâ
    sub    edx, eax                  ; edxÂêåÊ†∑Ë∞ÉÊï¥ÔºåÁ°Æ‰øùÁªìÊûúÂ≠òÂõûÂéüÂå∫Èó¥

; ËÆæÁΩÆÂ§ñÂ±ÇÂæ™ÁéØÊ¨°Êï∞‰∏∫200Ê¨°ÔºàÊØèÊ¨°Â§ÑÁêÜ‰∏§‰∏™ÊµÆÁÇπÊï∞ÔºåÂêàËÆ°Â§ÑÁêÜ400‰∏™ÊµÆÁÇπÊï∞Ôºâ
    mov    edi, 200     ; 000000c8H;edi&#x3D;i

$LL6@s:                              ; Â§ñÂ±ÇÂæ™ÁéØÂºÄÂßã
    push   100          ; 00000064H   ; ÂÜÖÂ±ÇÂæ™ÁéØËÆ°Êï∞Âô®ÔºåÊØèÊ¨°Â§ÑÁêÜ100ÂØπÊµÆÁÇπÊï∞
    pop	esi;esi&#x3D;100,‰Ωú‰∏∫ËÆ°Êï∞Âô®
$LL3@s:                              ; ÂÜÖÂ±ÇÂæ™ÁéØÂºÄÂßã
    fld    QWORD PTR [ecx+eax]      ; Â∞ÜÂΩìÂâçÂú∞ÂùÄÁöÑÊµÆÁÇπÊï∞Êé®ÂÖ•FPUÂ†ÜÊ†à
    fadd   QWORD PTR [eax]          ; Â∞ÜÊ∫êÂú∞ÂùÄÁöÑÊµÆÁÇπÊï∞‰∏éÊ†àÈ°∂ÁöÑÊµÆÁÇπÊï∞Áõ∏Âä†
    fstp   QWORD PTR [edx+eax]      ; Â∞ÜÁªìÊûú‰ªéÂ†ÜÊ†àÂºπÂá∫Âπ∂Â≠òÂõûÁõÆÁöÑÂú∞ÂùÄ
    add    eax, 8                   ; eaxÊåáÈíàÂêëÂâçÁßªÂä®8Â≠óËäÇÔºåÊåáÂêë‰∏ã‰∏Ä‰∏™ÊµÆÁÇπÊï∞
    dec    esi                      ; ÂÜÖÂ±ÇÂæ™ÁéØËÆ°Êï∞Âô®ÈÄíÂáè
    jne    SHORT $LL3@s              ; Â¶ÇÊûúÊú™ËææÂà∞ÂÜÖÂ±ÇÂæ™ÁéØÊ¨°Êï∞ÔºåÂàôË∑≥ËΩ¨ÁªßÁª≠ÂÜÖÂ±ÇÂæ™ÁéØ

    dec    edi                      ; Â§ñÂ±ÇÂæ™ÁéØËÆ°Êï∞Âô®ÈÄíÂáè
    jne    SHORT $LL6@s              ; Â¶ÇÊûúÊú™ËææÂà∞Â§ñÂ±ÇÂæ™ÁéØÊ¨°Êï∞ÔºåÂàôË∑≥ËΩ¨ÁªßÁª≠Â§ñÂ±ÇÂæ™ÁéØ

; ÊÅ¢Â§ç‰øùÂ≠òÁöÑÂØÑÂ≠òÂô®ÔºåÂπ∂Ê∏ÖÁêÜÊ†à
    pop    edi
    pop    esi
    ret    0                        ; ÂáΩÊï∞ËøîÂõûÔºå‰∏çÂ∏¶ËøîÂõûÂÄº
?s@@YAXPAN00@Z  ENDP   ; s ÂáΩÊï∞ÁªìÊùü<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">M</span>    <span class="token expression"><span class="token number">100</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">N</span>    <span class="token expression"><span class="token number">200</span></span></span>
<span class="token keyword">void</span> <span class="token function">s</span><span class="token punctuation">(</span><span class="token keyword">double</span> <span class="token operator">*</span>a<span class="token punctuation">,</span> <span class="token keyword">double</span> <span class="token operator">*</span>b<span class="token punctuation">,</span> <span class="token keyword">double</span> <span class="token operator">*</span>c<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>N<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>M<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span>
      <span class="token operator">*</span><span class="token punctuation">(</span>c<span class="token operator">+</span>i<span class="token operator">*</span>M<span class="token operator">+</span>j<span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">*</span><span class="token punctuation">(</span>a<span class="token operator">+</span>i<span class="token operator">*</span>M<span class="token operator">+</span>j<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token operator">*</span><span class="token punctuation">(</span>b<span class="token operator">+</span>i<span class="token operator">*</span>M<span class="token operator">+</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<hr />
<ol start="2">
<li></li>
</ol>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">; ÂáΩÊï∞ÂºÄÂßãÔºåÊ†áÂáÜÁöÑÂáΩÊï∞Ê°ÜÊû∂Âª∫Á´ã
?m@@YAXPAN00@Z PROC; m, COMDAT
    push   ebp
    mov    ebp, esp
    push   ecx                     ; ‰øùÂ≠òecx
    push   ecx                     ; ËøôÈáåÈáçÂ§çpush ecxÂèØËÉΩÊòØ‰∏∫‰∫ÜÂØπÈΩêÊ†àÊàñËÄÖ‰øùÁïôÁ©∫Èó¥(MSVSÁöÑÊÄ™Áôñ‰ª£Á†Å)
    mov    edx, DWORD PTR _a$[ebp] ; edx &#x3D; _a$ (Ëµ∑ÂßãÂú∞ÂùÄ)
    push   ebx                     ; ‰øùÂ≠òebx
    mov    ebx, DWORD PTR _c$[ebp] ; ebx &#x3D; _c$ (ÁõÆÊ†áÂú∞ÂùÄÊàñÂè¶‰∏Ä‰∏™Ëµ∑ÂßãÂú∞ÂùÄ)
    push   esi                     ; ‰øùÂ≠òesi
    mov    esi, DWORD PTR _b$[ebp] ; esi &#x3D; _b$ (ÂèØËÉΩÁöÑÁªìÊùüÂú∞ÂùÄÊàñÂÅèÁßªÈáè)

; ËÆ°ÁÆóÊï∞ÁªÑÈïøÂ∫¶ÊàñÂÅèÁßª
    sub    edx, esi                ; ËÆ°ÁÆóÈïøÂ∫¶ÊàñÂÅèÁßª1;edx&#x3D;edx-esi&#x3D;ptr(a-b)
    push   edi                     ; ‰øùÂ≠òedi
    sub    esi, ebx                ; ËÆ°ÁÆóÈïøÂ∫¶ÊàñÂÅèÁßª2ÔºåÊ≥®ÊÑèËøôÈáåÁöÑÊìç‰Ωú‰ºº‰πé‰∏éÈ¢ÑÊúüÈÄªËæë‰∏çÁ¨¶ÔºåÈúÄÁªìÂêàÂÖ∑‰ΩìÁÆóÊ≥ïÁêÜËß£
;esi&#x3D;esi-ebx&#x3D;ptr(b-c)
; ÂàùÂßãÂåñÂæ™ÁéØËÆ°Êï∞Âô®
    mov    DWORD PTR tv315[ebp], 100  ; Â§ñÂ±ÇÂæ™ÁéØËÆ°Êï∞Âô®ËÆæ‰∏∫100;tv315&#x3D;100
$LL9@m:                              ; Â§ñÂ±ÇÂæ™ÁéØÂºÄÂßã
    mov    eax, ebx                ; eax &#x3D; ebx&#x3D;cÔºåÂèØËÉΩÁî®‰∫éÂú∞ÂùÄËÆ°ÁÆó
    mov    DWORD PTR tv291[ebp], 300  ; ÂÜÖÂ±ÇÂæ™ÁéØËÆ°Êï∞Âô®ËÆæ‰∏∫300;tv291&#x3D;300
$LL6@m:                              ; ÂÜÖÂ±ÇÂæ™ÁéØÂºÄÂßã
    fldz                           ; Âä†ËΩΩ0.0Âà∞FPUÂ†ÜÊ†àÔºåÂáÜÂ§áÁ¥ØÂä†
    lea    ecx, DWORD PTR [esi+eax] ; ËÆ°ÁÆóÂΩìÂâçÂ§ÑÁêÜÂÖÉÁ¥†ÁöÑÂú∞ÂùÄ;ecx&#x3D;b
    fstp   QWORD PTR [eax]         ; Â∞Ü0.0Â≠òÂÖ•eaxÊåáÂêëÁöÑ‰ΩçÁΩÆÔºåÊ∏Ö0,Ê≠§Êó∂eaxÊåáÂêëc;*c&#x3D;0‰Ωç‰∫éÁ¨¨‰∫åÂ±ÇÂæ™ÁéØÔºåeax‰Ωú‰∏∫Âæ™ÁéØÁöÑÊåáÈíà

    mov    edi, 200                ; edi‰Ωú‰∏∫ËÆ°Êï∞Âô®;edi&#x3D;200
$LL3@m:                              ; Á¨¨‰∏âÂ±ÇÂæ™ÁéØÂºÄÂßã
    dec    edi                     ; Âæ™ÁéØËÆ°Êï∞Âô®ÈÄíÂáè
    fld    QWORD PTR [ecx+edx]     ; ‰ªéÂΩìÂâçÂú∞ÂùÄÂä†‰∏ä‰πãÂâçËÆ°ÁÆóÁöÑÂÅèÁßªÂ§ÑÂèñÂÖÉÁ¥†ÔºåÊé®ÂÖ•FPUÊ†à;ecx+edx&#x3D;b+a-b&#x3D;a
    fmul   QWORD PTR [ecx]         ; Â∞ÜÊ†àÈ°∂ÂÖÉÁ¥†‰∏éecxÂú∞ÂùÄÂ§ÑÁöÑÂÖÉÁ¥†Áõ∏‰πò *a&#x3D;*ax*b+c
    fadd   QWORD PTR [eax]         ; Â∞Ü‰πòÁßØ‰∏éeaxÂú∞ÂùÄÂ§ÑÁöÑÂÖÉÁ¥†Áõ∏Âä†ÔºåÂπ∂Â∞ÜÁªìÊûúÊîæÂõûeaxÂú∞ÂùÄ,c
    fstp   QWORD PTR [eax]         ; ÂºπÂá∫FPUÊ†àÈ°∂ÂÖÉÁ¥†ÔºàÂ∑≤Êó†Áî®Ôºâ;ËøôÈáåÁöÑËøêÁÆó‰∏éediÊó†ÂÖ≥
    jne    SHORT $LL3@m             ; Ëã•ediÈùûÈõ∂ÔºåÁªßÁª≠ÂÜÖÂ±ÇÂæ™ÁéØ

    add    eax, 8                  ; eaxÊåáÂêë‰∏ã‰∏Ä‰∏™ÂÖÉÁ¥†
    dec    DWORD PTR tv291[ebp]     ; ÂÜÖÂ±ÇÂæ™ÁéØËÆ°Êï∞Âô®ÈÄíÂáè
    jne    SHORT $LL6@m             ; Ëã•ÂÜÖÂ±ÇËÆ°Êï∞Âô®ÈùûÈõ∂ÔºåÁªßÁª≠ÂÜÖÂ±ÇÂæ™ÁéØ

    add    ebx, 800                ; ebxÂ¢ûÂä†800ÔºåÂèØËÉΩÁî®‰∫éÂ§ÑÁêÜ‰∏ã‰∏ÄÊâπÊï∞ÊçÆ
    dec    DWORD PTR tv315[ebp]     ; Â§ñÂ±ÇÂæ™ÁéØËÆ°Êï∞Âô®ÈÄíÂáè
    jne    SHORT $LL9@m             ; Ëã•Â§ñÂ±ÇËÆ°Êï∞Âô®ÈùûÈõ∂ÔºåÁªßÁª≠Â§ñÂ±ÇÂæ™ÁéØ

; Ê∏ÖÁêÜÂπ∂ËøîÂõû
    pop    edi
    pop    esi
    pop    ebx
    leave                          ; ÊÅ¢Â§çebpÂíåesp
    ret    0                       ; ÂáΩÊï∞ËøîÂõû
?m@@YAXPAN00@Z ENDP                   ; mÂáΩÊï∞ÁªìÊùü<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">for</span> tv315 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token keyword">for</span> tv291 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token operator">*</span><span class="token punctuation">(</span>c<span class="token operator">+</span>tv315<span class="token operator">*</span><span class="token number">100</span><span class="token operator">+</span>tv291<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">0</span>
        <span class="token keyword">for</span> edi <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token operator">*</span><span class="token punctuation">(</span>c<span class="token operator">+</span>tv315<span class="token operator">*</span><span class="token number">100</span><span class="token operator">+</span>tv291<span class="token punctuation">)</span><span class="token operator">+=</span><span class="token operator">*</span><span class="token punctuation">(</span>a<span class="token operator">+</span>tv315<span class="token operator">*</span><span class="token number">100</span><span class="token operator">+</span>tv291<span class="token punctuation">)</span><span class="token operator">*</span> <span class="token operator">*</span><span class="token punctuation">(</span>b<span class="token operator">+</span>tv315<span class="token operator">*</span><span class="token number">100</span><span class="token operator">+</span>tv291<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ol start="3">
<li></li>
</ol>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">_array$ &#x3D; 8
_x$ &#x3D; 12
_y$ &#x3D; 16
_f      PROC
        mov     eax, DWORD PTR _x$[esp-4];eax&#x3D;x;
        mov     edx, DWORD PTR _y$[esp-4];edx&#x3D;y;
        mov     ecx, eax;ecx&#x3D;x;
        shl     ecx, 4;x*2^4;
        sub     ecx, eax;ecx&#x3D;15x
        lea     eax, DWORD PTR [edx+ecx*8];eax&#x3D;y+120x
        mov     ecx, DWORD PTR _array$[esp-4];ecx&#x3D;8
        fld     QWORD PTR [ecx+eax*8]
        ret     0
_f      ENDP<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">double</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token keyword">double</span> array<span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">120</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
         <span class="token keyword">return</span> array<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
</div></section></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/2024/05/27/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0%E7%AC%94%E8%AE%B0/" rel="prev" title="Êï∞ÊçÆÁªìÊûÑÂ§ç‰π†Á¨îËÆ∞"><span class="icon iconify" data-icon="ri:arrow-left-s-line"></span><span class="post-nav-text">Êï∞ÊçÆÁªìÊûÑÂ§ç‰π†Á¨îËÆ∞</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/2024/05/09/PwnCollege2-ProgramInteraction/" rel="next" title="pwnCollege1-ProgramMiuse"><span class="post-nav-text">pwnCollege1-ProgramMiuse</span><span class="icon iconify" data-icon="ri:arrow-right-s-line"></span></a></div></div></div><div class="hty-card" id="comment"><div class="comment-tooltip text-center"><span>ÊÇ®ÈúÄË¶ÅÁßëÂ≠¶‰∏äÁΩëÔºåÊâçÂèØ‰ΩøÁî®ËØÑËÆ∫Âå∫ÂäüËÉΩ„ÄÇ</span><br></div><div id="waline"></div><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/@waline/client@v2/dist/waline.css"><script>window.CONFIG.waline.config.path = "/2024/05/23/re4b%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/"</script><div class="js-Pjax"><script src="/js/comments/waline.js" type="module" defer></script></div></div></main><footer class="sidebar-translate" id="footer"><div class="beian"><a rel="noopener" href="https://beian.miit.gov.cn/" target="_blank"></a></div><div class="copyright"><span>&copy; 2022 ‚Äì 2024 </span><span class="with-love" id="animate"><span class="icon iconify" data-icon="ri:cloud-line"></span></span><span class="author"> Npc</span></div><div class="footer-custom-text">=w=</div></footer></div><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><span class="icon iconify" data-icon="ri:arrow-up-s-line"></span><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" href="javascript:;" title="Search"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:search-line"></span></span></a><script>window.addEventListener("DOMContentLoaded", () => {
  // Handle and trigger popup window
  document.querySelector(".popup-trigger").addEventListener("click", () => {
    document.querySelector(".popup").classList.add("show");
    setTimeout(() => {
      document.querySelector(".search-input").focus();
    }, 100);
  });

  // Monitor main search box
  const onPopupClose = () => {
    document.querySelector(".popup").classList.remove("show");
  };

  document.querySelector(".popup-btn-close").addEventListener("click", () => {
    onPopupClose();
  });

  window.addEventListener("keyup", event => {
    if (event.key === "Escape") {
      onPopupClose();
    }
  });
});
</script><script src="https://fastly.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js"></script><script src="/js/search/local-search.js" defer type="module"></script><div class="popup search-popup"><div class="search-header"><span class="popup-btn-close close-icon hty-icon-button"><span class="icon iconify" data-icon="ri:close-line"></span></span></div><div class="search-input-container"><input class="search-input" id="local-search-input" type="text" placeholder="Searching..." value=""></div><div class="search-result-container"></div></div></body></html>